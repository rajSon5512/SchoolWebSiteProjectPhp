if (self.CavalryLogger) { CavalryLogger.start_js(["ToH3b"]); }

__d("EventPlanExperiment",["EventRemindersGating","QE2Logger"],(function a(b,c,d,e,f,g){"use strict";var h="event_plan_entry_point_nux",i={shouldShowEntryPointNuxWithExposure:function j(){c("QE2Logger").logExposureForUser(h);return c("EventRemindersGating").shouldShowEntryPointNux}};f.exports=i}),null);
__d("ChatAnimatedGifs",["URI"],(function a(b,c,d,e,f,g){__p&&__p();var h={shouldHideBody:function i(j){__p&&__p();if(!j.has_attachment)return false;for(var k=0;k<j.attachments.length;k++){var l=j.attachments[k];if(l.preview_url){var m=h.getRawUrlFromSafeUrl(l.preview_url);if(j.body==m)return true}}return false},getRawUrlFromSafeUrl:function i(j){return new(c("URI"))(j).getQueryData().url}};f.exports=h}),null);
__d("ChatBubble.react",["cx","DOMDimensions","EmojiOnlyMessage.react","MercuryMessageBody.react","MercuryMessageRenderLocations","MessagingGiftWrap.react","MessengerMathUtils","MessengerSupportedEmojiUtils","React","ReactDOM","joinClasses","messengerCustomColorUtils"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("React").PropTypes,j=2,k=c("React").createClass({displayName:"ChatBubble",_boxWidth:0,propTypes:{insideDecorators:i.arrayOf(i.object),attachments:i.node,body:i.string,className:i.string,customColor:i.string,customLike:i.object,isEmojiLike:i.bool,isFromViewer:i.bool,isGiftWrapped:i.bool,maxWidth:i.number.isRequired,message:i.object,metaRanges:i.array,onUnwrap:i.func,ranges:i.array,threadCustomColor:i.string,threadID:i.string},getInitialState:function l(){return{emojis:undefined,bubbleWidth:null}},componentDidMount:function l(){if(this.props.attachments&&!this.props.isEmojiLike)return;if(!this.props.emojis){var m=this.props.body||"",n=c("MessengerSupportedEmojiUtils").getEmojiOnlyContents(m);if(n&&n.length)this.setState({emojis:n})}this._restyleBubble(this.props)},componentDidUpdate:function l(m){if(m.maxWidth!==this.props.maxWidth||m.body!==this.props.body||!m.attachments&&this.props.attachments)this._restyleBubble(m)},render:function l(){__p&&__p();var m=this.props,n=m.attachments,o=m.body,p=o===undefined?"":o,q=m.className,r=m.insideDecorators,s=m.maxWidth,t=babelHelpers.objectWithoutProperties(m,["attachments","body","className","insideDecorators","maxWidth"]),u=Object.assign({},t);delete u.customColor;delete u.customLike;delete u.isEmojiLike;delete u.isFromViewer;delete u.message;delete u.metaRanges;delete u.ranges;delete u.threadCustomColor;delete u.threadID;return c("React").createElement("div",babelHelpers["extends"]({},u,{className:c("joinClasses")("_5w1r"+(!this.state.emojis?" _3_om":"")+(!!this.state.emojis?" _31xx":""),q),ref:"bubble",style:{maxWidth:s,width:this.state.emojis?null:this.state.bubbleWidth,wordWrap:p.length>=15?"break-word":"inherit"}}),c("React").createElement("div",{className:"_4gx_",ref:"inner"},this._renderContent(),n),r,this.props.isGiftWrapped?c("React").createElement(c("MessagingGiftWrap.react"),{onUnwrap:this.props.onUnwrap}):null)},_renderContent:function l(){__p&&__p();if(!this.props.body||this.props.isEmojiLike)return null;var m={},n=null;if(this.state.emojis)n=c("React").createElement(c("EmojiOnlyMessage.react"),{contents:this.state.emojis});else{n=c("React").createElement(c("MercuryMessageBody.react"),{body:this.props.body,ranges:this.props.ranges,metaRanges:this.props.metaRanges,threadID:this.props.threadID,customLike:this.props.customLike,threadCustomColor:this.props.threadCustomColor,isFromViewer:this.props.isFromViewer,renderLocation:c("MercuryMessageRenderLocations").CHAT});if(this.props.customColor)m=c("messengerCustomColorUtils").customBubbleStyle(this.props.customColor,m)}return c("React").createElement("div",{className:"_d97"+(!!this.state.emojis?" _31xy":""),ref:"contentWrapper",style:m},c("React").createElement("span",{className:"_5yl5",ref:"content"},n))},_restyleBubble:function l(m){__p&&__p();if(this.props.attachments||this.props.body!=null&&c("MessengerMathUtils").isMathBlock(this.props.body.trim())){this.setState({bubbleWidth:null});return}var n=c("ReactDOM").findDOMNode(this.refs.bubble);if(m.maxWidth!==this.props.maxWidth||c("DOMDimensions").getElementDimensions(n).width>this.props.maxWidth){var o=this.props.maxWidth;this.setState({bubbleWidth:o},this._shrinkBubble);return}this._shrinkBubble()},_shrinkBubble:function l(){var m=c("ReactDOM").findDOMNode(this.refs.bubble),n=c("DOMDimensions").getElementDimensions(m).width,o=c("ReactDOM").findDOMNode(this.refs.content),p=o?c("DOMDimensions").getElementDimensions(o).width+c("DOMDimensions").measureElementBox(c("ReactDOM").findDOMNode(this.refs.contentWrapper),"width",true,false,false):0,q=p+j;if(p>0&&q<this.props.maxWidth&&n-q-this.getBoxWidth()>0)this.setState({bubbleWidth:q})},contentWraps:function l(){var m=c("ReactDOM").findDOMNode(this.refs.content);if(!m)return false;var n=m.getClientRects(),o=c("DOMDimensions").getElementDimensions(m).height;return n&&n.length>1&&n[0].height<o},getBoxWidth:function l(){if(!this._boxWidth)this._boxWidth=c("DOMDimensions").measureElementBox(c("ReactDOM").findDOMNode(this.refs.bubble),"width",true,true,false);return this._boxWidth}});f.exports=k}),null);
__d("ChatCodePasteUtils",["cx","BanzaiODS","ChatBubble.react","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=/`{3,}/;function j(l){return!!(l&&i.test(l)&&l.split("\n").length>1)}function k(l,m,n,o,p){__p&&__p();var q=l.split(i),r=[];for(var s=0;s<q.length;s+=2){var t=q[s].trim();if(t)r.push(c("React").createElement("div",{key:s,className:"_5wde _n4o"},c("React").createElement(c("ChatBubble.react"),{body:t,customColor:p||undefined,className:"clearfix _5wdf",maxWidth:m,ranges:n||undefined,threadID:o||undefined})));if(s+1<q.length&&q[s+1]){var u=q[s+1].split("\n"),v=u[0].replace(/[^a-zA-Z]+/g,""),w=u.slice(1).join("\n");c("BanzaiODS").bumpEntityKey("chat_code_paste","render_bubble");r.push(c("React").createElement("div",{key:s+1,className:"_5wde _n4o"},c("React").createElement("div",{ref:"bubble",className:"_3_om _4yng _5wdf"},c("React").createElement("div",{ref:"syntaxTarget"+s,className:"language-"+v},w))))}}return r}f.exports={containsCodeBlock:j,getCodeAndMessageBubbles:k}}),null);
__d("ChatTabBlinking",["cx","CSS","clearInterval","setIntervalAcrossTransitions"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=600,j="highlightTitle",k={_blinkMap:{},_interval:null,_isHighlighting:false,blinkTab:function l(m,n){if(!this._blinkMap[m])this._blinkMap[m]={view:n,elem:n.getTabElem()};this.checkInterval()},unblinkTab:function l(m){if(this._blinkMap[m]){var n=this._blinkMap[m].elem;if(n)c("CSS").removeClass(n,j);delete this._blinkMap[m]}this.checkInterval()},checkInterval:function l(){var m=Object.keys(this._blinkMap).length;if(m>0){if(!this._interval)this._interval=c("setIntervalAcrossTransitions")(this._toggleBlinkHighlight.bind(this),i)}else if(this._interval){c("clearInterval")(this._interval);this._interval=null}},_toggleBlinkHighlight:function l(){this._isHighlighting=!this._isHighlighting;for(var m in this._blinkMap)if(Object.prototype.hasOwnProperty.call(this._blinkMap,m)){var n=this._blinkMap[m],o=n.elem,p=n.view;if(o&&o.parentNode&&!p.isFocused()&&!p.isHovered())c("CSS").conditionClass(o,j,this._isHighlighting);else this.unblinkTab(m)}}};f.exports=k}),null);
__d("ChatCloseButton.react",["cx","fbt","Link.react","React","TrackingNodes","joinClasses"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes;j=babelHelpers.inherits(m,c("React").PureComponent);k=j&&j.prototype;m.prototype.render=function(){var n=c("TrackingNodes").getTrackingInfo(c("TrackingNodes").types.CLOSE_BUTTON),o=i._("Press Esc to close"),p=i._("Close tab"),q="_4vu4";return c("React").createElement(c("Link.react"),{"aria-label":this.props.active?o:p,className:c("joinClasses")(this.props.className,"close","button",q),"data-ft":n,"data-hover":"tooltip","data-tooltip-content":this.props.active?o:p,"data-tooltip-position":"above",onClick:this.props.onClick,onKeyUp:this.props.onKeyUp,onMouseDown:this.props.onMouseDown})};function m(){j.apply(this,arguments)}m.propTypes={onClick:l.func,onKeyUp:l.func,onMouseDown:l.func,active:l.bool};m.defaultProps={active:false};f.exports=m}),null);
__d("ChatCollapsedLogMessageGroup.react",["cx","fbt","Link.react","React"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k;j=babelHelpers.inherits(l,c("React").PureComponent);k=j&&j.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=k.constructor).call.apply(m,[this].concat(p)),this.state={collapsed:true},n}l.prototype.render=function(){var m=i._("See latest activity"),n=i._("See less activity");return c("React").createElement("div",{className:"_5w0o"},c("React").createElement(c("Link.react"),{className:"_4ea1",onClick:function(){return this.setState({collapsed:!this.state.collapsed})}.bind(this)},this.state.collapsed?m:n),!this.state.collapsed?c("React").createElement("div",null,c("React").createElement("div",{className:"_2zsu"}),this.props.children,c("React").createElement("div",{className:"_2zsu"})):null)};f.exports=l}),null);
__d("ChatDateBreak.react",["cx","React","formatDate","joinClasses"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.shouldComponentUpdate=function(m){"use strict";return this.props.date.getTime()!==m.date.getTime()};l.prototype.render=function(){"use strict";var m=c("formatDate")(this.props.date,{today:"g:ia",withinWeek:"D g:ia",thisYear:"M jS, g:ia",older:"m/d/Y g:ia"});return c("React").createElement("time",{className:c("joinClasses")(this.props.className,"_5w-5")},c("React").createElement("span",{className:"_5w-6"},m))};function l(){"use strict";i.apply(this,arguments)}l.propTypes={date:k.instanceOf(Date).isRequired};f.exports=l}),null);
__d("ChatMessage.react",["cx","fbt","BootloadedComponent.react","ChatAnimatedGifs","ChatBubble.react","EmojiLikeUtils","FluxContainer","MercuryTimestamp","CSS","immutable","ImmutableObject","Locale","JSResource","MercuryAttachment","MercuryConfig","MercuryErrorInfo","MercuryIDs","MercuryMessageCustomizations","MercuryMessageError.react","MercuryMessageInfo","MessageBorderType","MessageCustomizationType","MessagingGiftWrapChecker","MessengerDecorator","MessengerInnerDecorators.react","MessengerVideoAutoplayStore","ChatCodePasteUtils","MNCommerceMessageType","MercuryDisplayTimeFilterMessageRenderer","React","ReactDOM","TooltipData","XUISpinner.react","convertMIGColorToFIGColor","isRTL","joinClasses","gkx"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes;j=babelHelpers.inherits(m,c("React").Component);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.state={isVisible:false},this.$ChatMessage1=function(){return this.setState({hovered:true})}.bind(this),this.$ChatMessage2=function(){return this.setState({hovered:false})}.bind(this),o}m.getStores=function(){return[c("MessengerVideoAutoplayStore")]};m.calculateState=function(n,o){return{isVisible:c("MessengerVideoAutoplayStore").isVisible(o.message.thread_id,o.message.message_id)}};m.prototype.componentDidMount=function(){c("CSS").conditionClass(c("ReactDOM").findDOMNode(this),"_2cnu",this.isOneLine())};m.prototype.isOneLine=function(){var n=this.props.message;return c("MercuryMessageInfo").isInbound(n)&&!this.refs.attachmentsInside&&this.refs.bubble&&!this.refs.bubble.contentWraps()};m.prototype.shouldComponentUpdate=function(n,o){var p=n.message!==this.props.message,q=false,r=false,s=this.props.thread;if(s){q=s.custom_like_icon!==n.thread.custom_like_icon;r=s.custom_color!==n.thread.custom_color}else if(n.thread)return true;return p||q||r||o.isVisible!==this.state.isVisible};m.prototype.render=function(){var n=this.props.message,o=c("MercuryAttachment").get(n).length>0,p=c("MercuryMessageInfo").isInbound(n),q=c("MercuryIDs").isGroupChat(n.thread_id),r=c("MercuryErrorInfo").hasErrorStatus(n),s="_5wd4"+(p?" _1nc7":"")+(!p?" _1nc6":"")+(o?" _2_-t":"")+(p&&q?" _5ysy":"")+(r?" _1zcs":""),t=this.props.isFromViewer,u=[],v=n;if(v)c("MessengerDecorator").getBeforeDecorators().forEach(function(w){if(w.check(v))u.push(w.render(v,t))});return c("React").createElement("div",{className:c("joinClasses")(this.props.className,s),onMouseEnter:this.$ChatMessage1,onMouseLeave:this.$ChatMessage2},c("React").createElement("div",{className:"_h8t"},u,this.$ChatMessage3()),c("React").createElement(c("MessengerInnerDecorators.react"),{message:n,isFromViewer:this.props.isFromViewer||false,hovered:this.state.hovered,messageProps:this.props}),this.$ChatMessage4(v,t),this.$ChatMessage5())};m.prototype.$ChatMessage3=function(){var n=this.props.message,o={};if(c("MercuryMessageInfo").isOutbound(n)){var p=i._("{time}",[i._param("time",c("MercuryTimestamp").getPreciseTimestamp(n.timestamp))]);Object.assign(o,c("TooltipData").propsFor(p,"right"))}if(n.is_filtered_content)return c("React").createElement("div",babelHelpers["extends"]({className:"_5wd9 _5wdc uiBoxYellow clearfix",ref:"inner"},o),c("MercuryDisplayTimeFilterMessageRenderer").renderFilteredContent(n));var q=this.$ChatMessage6("outside"),r=n.body&&n.body!==""?c("isRTL")(n.body):c("Locale").isRTL();return c("React").createElement("div",babelHelpers["extends"]({className:"_5wd9"+(r?" direction_rtl":"")+(!r?" direction_ltr":""),ref:"inner"},o),this.$ChatMessage7(!q),q)};m.prototype.$ChatMessage4=function(n,o){__p&&__p();var p,q=this;if(n){var p=function(){__p&&__p();var r=[],s=[];c("MessengerDecorator").getAfterExternalDecorators().forEach(function(u){if(n&&u.check(n)){r.push(u.render(n,o,this.props));s.push(u.getAdditionalClassNames())}}.bind(q));if(s.length===0&&r.length===0)return{v:null};var t=s.join(" ");return{v:c("React").createElement("div",{className:c("joinClasses")(t,"_5ijz"+(!o?" isFromOther":""))},r)}}();if(typeof p==="object")return p.v}return null};m.prototype.$ChatMessage5=function(){var n=this.props.message;if(n.is_filtered_content||!c("MercuryMessageInfo").hasError(n))return null;return c("React").createElement("div",{className:"_3ry4",ref:"undertext"},c("React").createElement(c("MercuryMessageError.react"),{className:"_5wda clearfix",message:n,ref:"status"}),this.$ChatMessage8())};m.prototype.$ChatMessage8=function(){return this.props.message.is_spoof_warning?c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("span",null),bootloadLoader:c("JSResource")("MercurySpoofWarning.react").__setRef("ChatMessage.react"),authorID:this.props.message.author,className:"_5wdb"}):null};m.prototype.$ChatMessage9=function(){return c("React").createElement("div",{style:{padding:"20px",text_align:"center"}},c("React").createElement(c("XUISpinner.react"),null))};m.prototype.$ChatMessage6=function(n){__p&&__p();if(this.props.message.commerce_message_type===c("MNCommerceMessageType").RIDE_INTENT)return null;var o=this.props.message,p=this.props.thread?this.props.thread.custom_like_icon:null,q=n=="inside"?"attachmentsInside":"attachmentsOutside",r=c("MercuryAttachment").get(o).filter(function(v){var w=c("MercuryAttachment").isBubblePreferred(v);return w&&n==="inside"||!w&&n==="outside"}),s=this.props.thread?c("convertMIGColorToFIGColor")(this.props.thread.custom_color):"",t=[],u=[];if(n==="outside"&&o)c("MessengerDecorator").getAfterDecorators().forEach(function(v){if(v.check(o,this.props.isFromViewer)){t.push(v.render(o,this.props.isFromViewer,this.props,this.state.hovered));u.push(v.getAdditionalClassNames())}}.bind(this));if(r.length>0)return c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:this.$ChatMessage9(),bootloadLoader:c("JSResource")("MercuryAttachments.react").__setRef("ChatMessage.react"),className:c("joinClasses")((n==="outside"?"_3e7u":"")+(!!o.body?" _16ys":"")+(!!s?" _3al":"")+" _n4o",u),attachments:r,customLike:p,customColor:s,hasFlowerBorder:c("gkx")("AT7rTubr3N_DsfglfGkvVFG3tMrhGme9-eELltAXoSOKkQuD-9JepjOeFPMl1e8XndLLgVmcw1EaaNThD3K6r4QJpohV9bITGr6_ur1k_X_RGQ")&&c("MercuryMessageCustomizations").getCustomizationValue(o,c("MessageCustomizationType").BORDER)===c("MessageBorderType").FLOWERS&&n==="outside",isChat:true,isGiftWrapped:c("MessagingGiftWrapChecker").shouldRenderWithGiftWrap(o)&&n==="outside",afterDecorators:t,isVisible:this.state.isVisible,maxWidth:this.props.maxBubbleWidth,message:o,onUnwrap:this.$ChatMessage10,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,ref:q});return null};m.prototype.$ChatMessage7=function(n){__p&&__p();var o=this.props,p=o.isFromViewer,q=o.message,r=o.thread,s=q.body,t=this.$ChatMessage6("inside"),u=[],v=[],w=[],x=q;if(x){if(n)c("MessengerDecorator").getAfterDecorators().forEach(function(B){if(B.check(x,p)){u.push(B.render(x,p,this.props));v.push(B.getAdditionalClassNames())}}.bind(this));c("MessengerDecorator").getInsideDecorators().forEach(function(B){if(B.check(x,p)){w.push(B.render(x,p,this.props));v.push(B.getAdditionalClassNames())}}.bind(this));c("MessengerDecorator").getBeforeDecorators().forEach(function(B){if(B.check(x,p))v.push(B.getAdditionalClassNames())})}var y=v.join(" ");if(c("ChatAnimatedGifs").shouldHideBody(q))s="";var z=q.ranges;if(q.profile_ranges&&q.profile_ranges.length)z=(z||[]).concat(q.profile_ranges.map(function(B){return babelHelpers["extends"]({},B,{url:"/"+B.id})}));var A=c("ChatCodePasteUtils").containsCodeBlock(s);if(s||t)return c("React").createElement("div",{className:c("joinClasses")(y,"_5wde _n4o")},!A?c("React").createElement(c("ChatBubble.react"),{attachments:t,body:s,className:"_5wdf",insideDecorators:w,isEmojiLike:c("EmojiLikeUtils").isEmojiLike(q),isFromViewer:this.props.isFromViewer,metaRanges:q.meta_ranges,message:q,maxWidth:this.props.maxBubbleWidth,ranges:z,ref:"bubble",threadID:q.thread_id,customLike:q.customLike,customColor:r&&p?c("convertMIGColorToFIGColor")(r.custom_color):"",threadCustomColor:r&&c("convertMIGColorToFIGColor")(r.custom_color)}):c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("div",{style:{height:22}}),bootloadLoader:c("JSResource")("ChatCodeBubble.react").__setRef("ChatMessage.react"),body:s,className:"_5wdf",maxWidth:this.props.maxBubbleWidth,ranges:z,threadID:q.thread_id,customColor:r&&p?c("convertMIGColorToFIGColor")(r.custom_color):""}),u);return null};m.propTypes={message:l.instanceOf(c("ImmutableObject")).isRequired,maxBubbleWidth:l.number.isRequired,onAttachmentLoad:l.func,onStickerClick:l.func,participants:l.instanceOf(c("immutable").Map).isRequired,readReceipts:l.instanceOf(c("immutable").OrderedMap).isRequired,thread:l.instanceOf(c("ImmutableObject"))};f.exports=c("FluxContainer").create(m,{withProps:true})}),null);
__d("ChatMessageGroup.react",["cx","fbt","ChatConfig","ChatDateBreak.react","ChatMessage.react","CurrentUser","Image.react","immutable","ImmutableObject","MercuryConfig","MercuryIDs","MercuryParticipants","MercuryTimestamp","MessengerTextWithEmoticons.react","QE2Logger","React","ReactDOM"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("immutable").OrderedMap,k=c("React").PropTypes,l=new(c("ImmutableObject"))({name:"",href:"#",image_src:""}),m=c("ChatConfig").get("chattab_rounded_profile",false),n=c("React").createClass({displayName:"ChatMessageGroup",propTypes:{activeMessageID:k.string,author:k.string,hasDateBreak:k.bool,isCanonical:k.bool,isFromViewer:k.bool,isPageMessage:k.bool,isOnline:k.bool,maxBubbleWidth:k.number,messages:k.instanceOf(c("immutable").List).isRequired,readReceipts:k.instanceOf(j).isRequired,onAttachmentLoad:k.func,onStickerClick:k.func,personaID:k.string,thread:k.instanceOf(c("ImmutableObject")),threadID:k.string},getInitialState:function p(){return{participants:{}}},componentDidMount:function p(){c("QE2Logger").logExposureForUser("messenger_growth_tombstone");this._subscription=this._computeParticipants()},shouldComponentUpdate:function p(q,r){return this.props.isOnline!==q.isOnline||this.props.activeMessageID!==q.activeMessageID||this.props.isFromViewer!==q.isFromViewer||!c("immutable").is(this.props.messages,q.messages)||this.state.participants!==r.participants||!c("immutable").is(this.props.thread,q.thread)},componentDidUpdate:function p(q){var r=o(this.props);if(!this._subscription&&!r.every(function(s){return this.state.participants[s]}.bind(this)))this._subscription=this._computeParticipants()},componentWillUnmount:function p(){this._subscription&&this._subscription.remove()},render:function p(){return c("React").createElement("div",{className:"_4tdt"+(this.props.isFromViewer?" _ua0":"")+(!this.props.isFromViewer?" _ua1":"")+(this._hasSeenHeadsAtBottom()?" _3lil":"")},this._renderProfileColumn(),c("React").createElement("div",{className:"_ua2"},this._renderName(),c("React").createElement("div",{className:"_4tdv"},this._renderMessages())))},_renderProfileColumn:function p(){if(this.props.isFromViewer)return null;var q=this.state.participants[this.props.author]||l;if(this.props.personaID)q=this.state.participants[this.props.personaID]||l;var r=i._("{name} {time}",[i._param("name",q.name),i._param("time",c("MercuryTimestamp").getPreciseTimestamp(this.props.messages.last().timestamp))]),s=q.image_src?c("React").createElement(c("Image.react"),{src:q.image_src}):null,t=c("MercuryConfig").GDWC&&this.props.isOnline,u=c("CurrentUser").isWorkUser()&&q.is_coworker===false;return c("React").createElement("div",{className:"_31o4"+(m?" _3njy":"")},c("React").createElement("a",{"aria-label":r,className:"_4tdw","data-hover":"tooltip","data-tooltip-content":r,"data-tooltip-position":"left",href:q.href,ref:"link"},s),u?c("React").createElement("div",{className:"_4rwx _4rwy"}):t?c("React").createElement("div",{className:"_sce"}):null)},_renderName:function p(){__p&&__p();if(this.props.isCanonical&&!this.props.personaID||this.props.isFromViewer)return null;var q=this.props.personaID?this.state.participants[this.props.personaID]:this.state.participants[this.props.messages.first().author];if(!q)return null;if(this.props.messages.first().replied_to_message)return null;var r=q.short_name;if(this.props.thread&&this.props.thread.custom_nickname){var s=c("MercuryIDs").getUserIDFromParticipantID(q.id);if(this.props.thread.custom_nickname[s])r=c("React").createElement(c("MessengerTextWithEmoticons.react"),{renderEmoticons:true,renderEmoji:true,text:this.props.thread.custom_nickname[s]})}if(this.props.personaID){var t=this.state.participants[this.props.messages.first().author];r=t?i._("{persona name} from {page name}",[i._param("persona name",q.name),i._param("page name",t.short_name)]):q.name}return c("React").createElement("div",{className:"_4tdx"},r)},_renderMessages:function p(){var q=this.props.messages.size,r=[];this.props.messages.forEach(function(s,t,u){var v=s.message_id===this.props.activeMessageID;if(v&&!(t===0&&this.props.hasDateBreak))r.push(c("React").createElement(c("ChatDateBreak.react"),{date:new Date(s.timestamp),key:"db:"+s.message_id}));r.push(c("React").createElement(c("ChatMessage.react"),{isFromViewer:this.props.isFromViewer,key:s.message_id,maxBubbleWidth:this.props.maxBubbleWidth,message:s,participants:c("immutable").Map(this.state.participants),readReceipts:this.props.readReceipts,ref:s.message_id,nextTimestamp:this._getNextTimestamp(u,q,t),onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,thread:this.props.thread}))}.bind(this));return r},_hasSeenHeadsAtBottom:function p(){var q=this.props,r=q.messages,s=q.nextTimestamp,t=q.readReceipts,u=r.last().timestamp,v=0;t.forEach(function(w){if(w>=u&&w<s)if(++v===2)return false;return null});return v===2},_getNextTimestamp:function p(q,r,s){return s<r-1?q.get(s+1).timestamp:this.props.nextTimestamp},getMessageElement:function p(q){return c("ReactDOM").findDOMNode(this.refs[q])},_computeParticipants:function p(){__p&&__p();var q=o(this.props),r={},s=[];q.forEach(function(t){var u=c("MercuryParticipants").getNow(t);r[t]=c("MercuryParticipants").getNow(t);if(!u)s.push(t)});this.setState({participants:r});if(s.length>0)return c("MercuryParticipants").getMulti(s,function(t){var r=this.state.participants;s.forEach(function(u){r[u]=t[u]});this._subscription=null;this.setState({participants:r})}.bind(this));return null}});function o(p){var q=p.personaID?p.personaID:p.author,r=[q];p.readReceipts.forEach(function(s,t){r.push(t)});return r}f.exports=n}),null);
__d("MercuryMessageRendererUtils",["cx","invariant","HovercardLink","MercuryViewer","MessengerTextWithEmoticons.react","React"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j={getLinkToParticipant:function k(l,m){var n=l.fbid,o=c("HovercardLink").constructEndpoint({id:n}),p=m&&m.custom_nickname&&m.custom_nickname[n];if(p)p=c("React").createElement(c("MessengerTextWithEmoticons.react"),{renderEmoticons:true,renderEmoji:true,text:p});var q=p?p:l.name;if(l.href)return c("React").createElement("a",{className:"_5wzt",href:l.href,"data-hovercard":o},q);return q},moveCurrentUserToFront:function k(){var l=arguments.length<=0||arguments[0]===undefined?[]:arguments[0];l||i(0);var m=l.indexOf(c("MercuryViewer").getID());if(m>0){var n=l.filter(function(o){return o!==c("MercuryViewer").getID()});return[c("MercuryViewer").getID()].concat(n)}return l}};f.exports=j}),null);
__d("MercuryLogMessageRenderer",["cx","fbt","invariant","ix","Bootloader","CSS","Image.react","MercuryAttachmentViewer","MercuryViewer","MercuryLogMessageType","MessagingSourceEnum","MessengerAdminGroupUtils","MessengerLightweightActionUtils","MessengerTextWithEmoticons.react","MercuryParticipants","React","ReactDOM","MercuryMessageRendererUtils","MercuryThreads","TooltipLink.react","UserAgent","convertMIGColorToFIGColor"],(function a(b,c,d,e,f,g,h,i,j,k){"use strict";__p&&__p();var l=c("MercuryThreads").get(),m={renderText:function G(H,I,J,K){__p&&__p();I=I||l.getThreadMetaNow(H.thread_id);if(c("MessengerLightweightActionUtils").isLWAMessage(H)){K(c("MessengerLightweightActionUtils").getCollapsedLWAText(H));return}switch(H.log_message_type){case c("MercuryLogMessageType").SUBSCRIBE:var L=H.author;H.log_message_data||j(0);var M=H.log_message_data.added_participants;M||j(0);var N=M.length===1&&L===M[0];if(N)c("Bootloader").loadModules(["MercuryJoinableMessageRenderer"],function(P){P.renderText(H,I,K)},"MercuryLogMessageRenderer");else p(H,K);break;case c("MercuryLogMessageType").UNSUBSCRIBE:if(c("MessengerAdminGroupUtils").isJoinableThread(I))c("MessengerAdminGroupUtils").isGroupChat(I)?D(H,K):v(H,K);else u(H,K);break;case c("MercuryLogMessageType").THREAD_NAME:if(I&&c("MessengerAdminGroupUtils").isWorkGroupSyncedChat(I)&&c("MessengerAdminGroupUtils").isWorkSyncedChatThreadCreationMessage(H))y(H,K);else if(I&&c("MessengerAdminGroupUtils").isJoinableThread(I))c("MessengerAdminGroupUtils").isGroupChat(I)?E(H,I,K):w(H,I,K);else z(H,I,K);break;case c("MercuryLogMessageType").THREAD_IMAGE:if(I&&c("MessengerAdminGroupUtils").isJoinableThread(I))c("MessengerAdminGroupUtils").isGroupChat(I)?F(H,I,K):A(H,I,K);else B(H,I,K);break;case c("MercuryLogMessageType").WALLPAPER:C(H,K);break;case c("MercuryLogMessageType").GENERIC_ADMIN_TEXT:var O=c("convertMIGColorToFIGColor")(I&&I.custom_color);c("Bootloader").loadModules(["MercuryXMATRenderer"],function(P){K(P.renderText(O,H,J))},"MercuryLogMessageRenderer");break;default:c("Bootloader").loadModules(["MercurySpecialLogMessageRenderer"],function(P){P.renderText(H,K)},"MercuryLogMessageRenderer");break}},renderIcon:function G(H){return c("React").createElement(c("Image.react"),{className:n(H.log_message_type,H.log_message_data),src:k("99239")})},renderLegacy:function G(H,I,J,K){n(K.log_message_type,K.log_message_data).split(" ").forEach(function(L){return L&&c("CSS").addClass(H,L)});this.renderText(K,null,false,function(L){c("ReactDOM").render(c("React").createElement("span",null,L),I)});this.renderAttachmentLegacy(J,K)},renderAttachmentLegacy:function G(H,I){__p&&__p();var J;if(I.log_message_type===c("MercuryLogMessageType").THREAD_IMAGE)(function(){I.log_message_data||j(0);var K=I.log_message_data.image;if(K&&K.preview_url){c("ReactDOM").render(c("React").createElement(c("Image.react"),{className:"_z6a",onClick:function L(){return o(K)},src:K.preview_url}),H);c("CSS").show(H)}})()}};f.exports=m;function n(G,H){var I=!!(H&&H.answered);return"_5wzu"+(G===c("MercuryLogMessageType").SUBSCRIBE?" _5wzj":"")+(G===c("MercuryLogMessageType").UNSUBSCRIBE?" _5wzk":"")+(G===c("MercuryLogMessageType").THREAD_NAME?" _5wzl":"")+(G===c("MercuryLogMessageType").THREAD_IMAGE?" _5wzm":"")+(G===c("MercuryLogMessageType").VIDEO_CALL&&I?" _5wzn":"")+(G===c("MercuryLogMessageType").VIDEO_CALL&&!I?" _5wzo":"")+(G===c("MercuryLogMessageType").PHONE_CALL&&I?" _5wzp":"")+(G===c("MercuryLogMessageType").PHONE_CALL&&!I?" _5wzq":"")+(G===c("MercuryLogMessageType").SERVER_ERROR?" _5wzr":"")+(!G?" _2r5l":"")}function o(G){c("MercuryAttachmentViewer").bootstrapWithConfig({src:G.preview_url,endpoint:G.url,fbid:G.metadata.fbid,dimensions:G.metadata.dimensions,disablePaging:true},null)}function p(G,H){__p&&__p();G.log_message_data||j(0);var I=c("MercuryMessageRendererUtils").moveCurrentUserToFront(G.log_message_data.added_participants);I||j(0);switch(I.length){case 1:q(G,H,I);break;case 2:r(G,H,I);break;case 3:s(G,H,I);break;default:t(G,H,I);break}}function q(G,H,I){var J=[G.author,I[0]];c("MercuryParticipants").getMulti(J,function(K){if(G.author===c("MercuryViewer").getID())H(i._("You added {subscriber1}.",[i._param("subscriber1",c("MercuryMessageRendererUtils").getLinkToParticipant(K[I[0]]))]));else if(I[0]===c("MercuryViewer").getID())H(i._("{actor} added you.",[i._param("actor",c("MercuryMessageRendererUtils").getLinkToParticipant(K[G.author]))]));else H(i._("{actor} added {subscriber1}.",[i._param("actor",c("MercuryMessageRendererUtils").getLinkToParticipant(K[G.author])),i._param("subscriber1",c("MercuryMessageRendererUtils").getLinkToParticipant(K[I[0]]))]))})}function r(G,H,I){var J=[G.author].concat(I);c("MercuryParticipants").getMulti(J,function(K){if(G.author===c("MercuryViewer").getID())H(i._("You added {subscriber1} and {subscriber2}.",[i._param("subscriber1",c("MercuryMessageRendererUtils").getLinkToParticipant(K[I[0]])),i._param("subscriber2",c("MercuryMessageRendererUtils").getLinkToParticipant(K[I[1]]))]));else if(I[0]===c("MercuryViewer").getID())H(i._("{actor} added you and {subscriber2}.",[i._param("actor",c("MercuryMessageRendererUtils").getLinkToParticipant(K[G.author])),i._param("subscriber2",c("MercuryMessageRendererUtils").getLinkToParticipant(K[I[1]]))]));else H(i._("{actor} added {subscriber1} and {subscriber2}.",[i._param("actor",c("MercuryMessageRendererUtils").getLinkToParticipant(K[G.author])),i._param("subscriber1",c("MercuryMessageRendererUtils").getLinkToParticipant(K[I[0]])),i._param("subscriber2",c("MercuryMessageRendererUtils").getLinkToParticipant(K[I[1]]))]))})}function s(G,H,I){var J=[G.author].concat(I);c("MercuryParticipants").getMulti(J,function(K){if(G.author===c("MercuryViewer").getID())H(i._("You added {subscriber1}, {subscriber2} and {subscriber3}.",[i._param("subscriber1",c("MercuryMessageRendererUtils").getLinkToParticipant(K[I[0]])),i._param("subscriber2",c("MercuryMessageRendererUtils").getLinkToParticipant(K[I[1]])),i._param("subscriber3",c("MercuryMessageRendererUtils").getLinkToParticipant(K[I[2]]))]));else if(I[0]===c("MercuryViewer").getID())H(i._("{actor} added you, {subscriber2} and {subscriber3}.",[i._param("actor",c("MercuryMessageRendererUtils").getLinkToParticipant(K[G.author])),i._param("subscriber2",c("MercuryMessageRendererUtils").getLinkToParticipant(K[I[1]])),i._param("subscriber3",c("MercuryMessageRendererUtils").getLinkToParticipant(K[I[2]]))]));else H(i._("{actor} added {subscriber1}, {subscriber2} and {subscriber3}.",[i._param("actor",c("MercuryMessageRendererUtils").getLinkToParticipant(K[G.author])),i._param("subscriber1",c("MercuryMessageRendererUtils").getLinkToParticipant(K[I[0]])),i._param("subscriber2",c("MercuryMessageRendererUtils").getLinkToParticipant(K[I[1]])),i._param("subscriber3",c("MercuryMessageRendererUtils").getLinkToParticipant(K[I[2]]))]))})}function t(G,H,I){__p&&__p();var J=[G.author].concat(I);c("MercuryParticipants").getMulti(J,function(K){__p&&__p();function L(N){var O=c("React").createElement("div",null,N.map(function(P){return c("React").createElement("div",null,P.name)}));return c("React").createElement(c("TooltipLink.react"),{alignH:"center",position:"above",tooltip:O},i._({"*":"{num} more"},[i._param("num",N.length,[0])]))}var M=I.map(function(N){return K[N]});if(G.author===c("MercuryViewer").getID())H(i._("You added {subscriber1}, {subscriber2} and {more_people}.",[i._param("subscriber1",c("MercuryMessageRendererUtils").getLinkToParticipant(M[0])),i._param("subscriber2",c("MercuryMessageRendererUtils").getLinkToParticipant(M[1])),i._param("more_people",L(M.slice(2)))]));else if(I[0]===c("MercuryViewer").getID())H(i._("{actor} added you, {subscriber2} and {more_people}.",[i._param("actor",c("MercuryMessageRendererUtils").getLinkToParticipant(K[G.author])),i._param("subscriber2",c("MercuryMessageRendererUtils").getLinkToParticipant(M[1])),i._param("more_people",L(M.slice(2)))]));else H(i._("{actor} added {subscriber1}, {subscriber2} and {more_people}.",[i._param("actor",c("MercuryMessageRendererUtils").getLinkToParticipant(K[G.author])),i._param("subscriber1",c("MercuryMessageRendererUtils").getLinkToParticipant(M[0])),i._param("subscriber2",c("MercuryMessageRendererUtils").getLinkToParticipant(M[1])),i._param("more_people",L(M.slice(2)))]))})}function u(G,H){__p&&__p();var I=[G.author];G.log_message_data||j(0);var J=G.log_message_data.removed_participants;J||j(0);var K=void 0;if(J.length===1){K=J[0];I.push(K)}c("MercuryParticipants").getMulti(I,function(L){__p&&__p();var M=L[G.author],N=L[K];if(G.author===c("MercuryViewer").getID())if(!K||K===G.author)H(i._("You left the conversation."));else H(i._("You removed {name} from the conversation.",[i._param("name",c("MercuryMessageRendererUtils").getLinkToParticipant(N))]));else if(!K||K===G.author)H(i._("{actor} left the conversation.",[i._param("actor",c("MercuryMessageRendererUtils").getLinkToParticipant(M))]));else if(K===c("MercuryViewer").getID())H(i._("{actor} removed you from the conversation.",[i._param("actor",c("MercuryMessageRendererUtils").getLinkToParticipant(M))]));else H(i._("{actor} removed {name} from the conversation.",[i._param("actor",c("MercuryMessageRendererUtils").getLinkToParticipant(M)),i._param("name",c("MercuryMessageRendererUtils").getLinkToParticipant(N))]))})}function v(G,H){__p&&__p();var I=[G.author];G.log_message_data||j(0);var J=G.log_message_data.removed_participants;J||j(0);var K=void 0;if(J.length===1){K=J[0];I.push(K)}c("MercuryParticipants").getMulti(I,function(L){__p&&__p();var M=L[G.author],N=L[K];if(G.author===c("MercuryViewer").getID())if(!K||K===G.author)H(i._("You left the room."));else H(i._("You removed {name} from the room.",[i._param("name",c("MercuryMessageRendererUtils").getLinkToParticipant(N))]));else if(!K||K===G.author)H(i._("{actor} left the room.",[i._param("actor",c("MercuryMessageRendererUtils").getLinkToParticipant(M))]));else if(K===c("MercuryViewer").getID())H(i._("{actor} removed you from the room.",[i._param("actor",c("MercuryMessageRendererUtils").getLinkToParticipant(M))]));else H(i._("{actor} removed {name} from the room.",[i._param("actor",c("MercuryMessageRendererUtils").getLinkToParticipant(M)),i._param("name",c("MercuryMessageRendererUtils").getLinkToParticipant(N))]))})}function w(G,H,I){__p&&__p();G.log_message_data||j(0);var J=G.log_message_data.name,K="_5wzs"+(c("UserAgent").isBrowser("Chrome")?" _4fbd":"");if(G.author===c("MercuryViewer").getID())if(J){var L=c("React").createElement(c("MessengerTextWithEmoticons.react"),{renderEmoticons:true,renderEmoji:true,text:J});I(i._("You named the room: {name}.",[i._param("name",c("React").createElement("span",{className:K},L))]))}else I(i._("You removed the room name."));else c("MercuryParticipants").get(G.author,function(M){var N=c("MercuryMessageRendererUtils").getLinkToParticipant(M,H);if(J){var O=c("React").createElement(c("MessengerTextWithEmoticons.react"),{renderEmoticons:true,renderEmoji:true,text:J});I(i._("{actor} named the room: {name}.",[i._param("actor",N),i._param("name",c("React").createElement("span",{className:K},O))]))}else I(i._("{actor} removed the room name.",[i._param("actor",N)]))})}function x(G,H,I,J,K){if(G.author===c("MercuryViewer").getID())K(i._("You named the group {thread_name}. Your group is also on Facebook.",[i._param("thread_name",c("React").createElement("span",{className:J},c("React").createElement(c("MessengerTextWithEmoticons.react"),{renderEmoticons:true,renderEmoji:true,text:I})))]));else c("MercuryParticipants").get(G.author,function(L){var M=c("MercuryMessageRendererUtils").getLinkToParticipant(L,H);K(i._("{actor} named the group {thread_name}. Your group is also on Facebook.",[i._param("actor",M),i._param("thread_name",c("React").createElement("span",{className:J},c("React").createElement(c("MessengerTextWithEmoticons.react"),{renderEmoticons:true,renderEmoji:true,text:I})))]))})}function y(G,H){G.log_message_data||j(0);var I=G.log_message_data.name,J="_5wzs"+(c("UserAgent").isBrowser("Chrome")?" _4fbd":"");if(I){H(i._("You can now chat to {name} on Workplace Chat.",[i._param("name",c("React").createElement("span",{className:J},c("React").createElement(c("MessengerTextWithEmoticons.react"),{renderEmoticons:true,renderEmoji:true,text:I})))]));return}}function z(G,H,I){__p&&__p();G.log_message_data||j(0);var J=G.log_message_data.name,K="_5wzs"+(c("UserAgent").isBrowser("Chrome")?" _4fbd":"");if(J&&G.tags&&G.tags.indexOf(c("MessagingSourceEnum").EVENT_UPCOMING_BUMP)!==-1)I(i._("The group has been named {name}.",[i._param("name",c("React").createElement("span",{className:K},c("React").createElement(c("MessengerTextWithEmoticons.react"),{renderEmoticons:true,renderEmoji:true,text:J})))]));else if(J&&G.tags&&G.tags.indexOf(c("MessagingSourceEnum").GROUPSYNC_NAMING)!==-1)x(G,H,J,K,I);else if(G.author===c("MercuryViewer").getID())if(J){var L=c("React").createElement(c("MessengerTextWithEmoticons.react"),{renderEmoticons:true,renderEmoji:true,text:J});I(i._("You named the conversation: {name}.",[i._param("name",c("React").createElement("span",{className:K},L))]))}else I(i._("You removed the conversation name."));else c("MercuryParticipants").get(G.author,function(M){var N=c("MercuryMessageRendererUtils").getLinkToParticipant(M,H);if(J){var O=c("React").createElement(c("MessengerTextWithEmoticons.react"),{renderEmoticons:true,renderEmoji:true,text:J});I(i._("{actor} named the conversation: {name}.",[i._param("actor",N),i._param("name",c("React").createElement("span",{className:K},O))]))}else I(i._("{actor} removed the conversation name.",[i._param("actor",N)]))})}function A(G,H,I){__p&&__p();if(G.author===c("MercuryViewer").getID()){G.log_message_data||j(0);if(G.log_message_data.image)I(i._("You changed the room picture."));else I(i._("You removed the room picture."))}else c("MercuryParticipants").get(G.author,function(J){var K=c("MercuryMessageRendererUtils").getLinkToParticipant(J,H);G.log_message_data||j(0);if(G.log_message_data.image)I(i._("{actor} changed the room picture.",[i._param("actor",K)]));else I(i._("{actor} removed the room picture.",[i._param("actor",K)]))})}function B(G,H,I){__p&&__p();if(G.tags!==undefined&&G.tags.indexOf(c("MessagingSourceEnum").EVENT_UPCOMING_BUMP)!==-1)I(i._("The conversation picture has been set."));else if(G.author===c("MercuryViewer").getID()){G.log_message_data||j(0);if(G.log_message_data.image)I(i._("You changed the conversation picture."));else I(i._("You removed the conversation picture."))}else c("MercuryParticipants").get(G.author,function(J){var K=c("MercuryMessageRendererUtils").getLinkToParticipant(J,H);G.log_message_data||j(0);if(G.log_message_data.image)I(i._("{actor} changed the conversation picture.",[i._param("actor",K)]));else I(i._("{actor} removed the conversation picture.",[i._param("actor",K)]))})}function C(G,H){if(G.author===c("MercuryViewer").getID())H(i._("You changed the wallpaper."));else c("MercuryParticipants").get(G.author,function(I){var J=c("MercuryMessageRendererUtils").getLinkToParticipant(I);H(i._("{actor} changed the wallpaper.",[i._param("actor",J)]))})}function D(G,H){__p&&__p();var I=[G.author];G.log_message_data||j(0);var J=G.log_message_data.removed_participants;J||j(0);var K=void 0;if(J.length===1){K=J[0];I.push(K)}c("MercuryParticipants").getMulti(I,function(L){__p&&__p();var M=L[G.author],N=L[K];if(G.author===c("MercuryViewer").getID())if(!K||K===G.author)H(i._("You left the chat."));else H(i._("You removed {name} from the chat.",[i._param("name",c("MercuryMessageRendererUtils").getLinkToParticipant(N))]));else if(!K||K===G.author)H(i._("{actor} left the chat.",[i._param("actor",c("MercuryMessageRendererUtils").getLinkToParticipant(M))]));else if(K===c("MercuryViewer").getID())H(i._("{actor} removed you from the chat.",[i._param("actor",c("MercuryMessageRendererUtils").getLinkToParticipant(M))]));else H(i._("{actor} removed {name} from the chat.",[i._param("actor",c("MercuryMessageRendererUtils").getLinkToParticipant(M)),i._param("name",c("MercuryMessageRendererUtils").getLinkToParticipant(N))]))})}function E(G,H,I){__p&&__p();G.log_message_data||j(0);var J=G.log_message_data.name,K="_5wzs"+(c("UserAgent").isBrowser("Chrome")?" _4fbd":"");if(G.author===c("MercuryViewer").getID())if(J){var L=c("React").createElement(c("MessengerTextWithEmoticons.react"),{renderEmoticons:true,renderEmoji:true,text:J});I(i._("You named the chat {name}.",[i._param("name",c("React").createElement("span",{className:K},L))]))}else I(i._("You removed the chat name."));else c("MercuryParticipants").get(G.author,function(M){var N=c("MercuryMessageRendererUtils").getLinkToParticipant(M,H);if(J){var O=c("React").createElement(c("MessengerTextWithEmoticons.react"),{renderEmoticons:true,renderEmoji:true,text:J});I(i._("{actor} named the chat {name}.",[i._param("actor",N),i._param("name",c("React").createElement("span",{className:K},O))]))}else I(i._("{actor} removed the chat name.",[i._param("actor",N)]))})}function F(G,H,I){__p&&__p();if(G.author===c("MercuryViewer").getID()){G.log_message_data||j(0);if(G.log_message_data.image)I(i._("You changed the chat picture."));else I(i._("You removed the chat picture."))}else c("MercuryParticipants").get(G.author,function(J){var K=c("MercuryMessageRendererUtils").getLinkToParticipant(J,H);G.log_message_data||j(0);if(G.log_message_data.image)I(i._("{actor} changed the chat picture.",[i._param("actor",K)]));else I(i._("{actor} removed the chat picture.",[i._param("actor",K)]))})}}),null);
__d("MercuryLogMessage.react",["cx","fbt","DOM","DOMDimensions","Event","EventReminderRequestHelper","ImmutableObject","MercuryLogMessageRenderer","MercuryLogMessageType","MessagingGenericAdminTextType","React","ReactDOM","ShimButton.react","cancelAnimationFrame","emptyFunction","formatDate","joinClasses","requestAnimationFrame","requireWeak"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes,m=266;j=babelHelpers.inherits(n,c("React").Component);k=j&&j.prototype;function n(){__p&&__p();var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.state={messageText:null,showEventReminderFlyout:false},this.$MercuryLogMessage4=function(){this.$MercuryLogMessage5()}.bind(this),this.$MercuryLogMessage9=function(){if(!this.state.showEventReminderFlyout)c("EventReminderRequestHelper").fetchEventReminder(this.props.thread.thread_id,this.props.thread.lightweight_event.oid,function(){this.$MercuryLogMessage1&&this.setState({showEventReminderFlyout:true})}.bind(this));else this.setState({showEventReminderFlyout:false})}.bind(this),this.$MercuryLogMessage11=function(t){if(t!==this.state.showEventReminderFlyout)this.setState({showEventReminderFlyout:t})}.bind(this),p}n.prototype.componentDidMount=function(){this.$MercuryLogMessage1=true;this.UNSAFE_componentWillReceiveProps(this.props)};n.prototype.componentWillUnmount=function(){this.$MercuryLogMessage1=false;if(this.$MercuryLogMessage2)c("cancelAnimationFrame")(this.$MercuryLogMessage2)};n.prototype.$MercuryLogMessage3=function(){return c("React").createElement(c("ShimButton.react"),{form:"link",onClick:this.$MercuryLogMessage4},i._("Show previous messages."))};n.prototype.$MercuryLogMessage5=function(){var o=this.props.loadMoreMessages&&this.props.loadMoreMessages();if(!this.$MercuryLogMessage1)return;if(o)this.setState({messageText:this.$MercuryLogMessage3()});else{var p=i._("Couldn't find previous messages.");this.setState({messageText:p})}};n.prototype.UNSAFE_componentWillReceiveProps=function(o){if(o.message.log_message_type===c("MercuryLogMessageType").SERVER_ERROR)return;c("MercuryLogMessageRenderer").renderText(o.message,o.thread,o.isLastOfType,function(p){this.$MercuryLogMessage1&&this.setState({messageText:p})}.bind(this))};n.prototype.shouldComponentUpdate=function(o,p){return this.state.messageText!=p.messageText||o.maxWidth!==this.props.maxWidth||this.state.showEventReminderFlyout!==p.showEventReminderFlyout};n.prototype.componentDidUpdate=function(){this.$MercuryLogMessage6();if(!this.refs.attachment)return;c("MercuryLogMessageRenderer").renderAttachmentLegacy(this.refs.attachment,this.props.message);c("DOM").scry(this.refs.wrap,"img").forEach(function(o){var p=c("Event").listen(o,"load",function(){this.$MercuryLogMessage6();p.remove()}.bind(this))}.bind(this))};n.prototype.render=function(){return c("React").createElement("div",babelHelpers["extends"]({},this.props,{className:c("joinClasses")(this.props.className,"_5ye6"),ref:"wrap",style:babelHelpers["extends"]({},this.props.style,this.$MercuryLogMessage7()),title:c("formatDate")(new Date(this.props.message.timestamp),"g:ia")}),c("React").createElement("div",{className:"_5ye7"},c("MercuryLogMessageRenderer").renderIcon(this.props.message),this.state.messageText),c("React").createElement("div",{className:"_5ye8",ref:"attachment"},this.$MercuryLogMessage8()))};n.prototype.$MercuryLogMessage8=function(){__p&&__p();if(this.props.thread&&!this.props.thread.lightweight_event||!this.props.message.log_message_data)return null;var o=void 0;c("requireWeak")("EventReminderStateStore",function(s){o=s.getEvent(this.props.thread.thread_id)}.bind(this));if(!o||!o.exists)return null;var p;c("requireWeak")("Link.react",function(s){p=s});var q=void 0;switch(this.props.message.log_message_data.message_type){case c("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_CREATE:case c("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_TIME:case c("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_TITLE:case c("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_LOCATION:case c("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE:q=i._("Change");break;default:q=null}var r=c("React").createElement(p,{href:"#",onClick:this.$MercuryLogMessage9,title:i._("Edit Event"),ref:"event_rem_link"},q);if(this.props.displayItems)r=null;return c("React").createElement("span",null,r,this.$MercuryLogMessage10())};n.prototype.$MercuryLogMessage10=function(){__p&&__p();if(!this.state.showEventReminderFlyout)return null;var o="right",p=c("ReactDOM").findDOMNode(this.refs.wrap);if(p&&p instanceof Element&&p.getBoundingClientRect().left<m)o="left";var q={alignment:o,position:"above",contextRef:function(){return this.refs.event_rem_link}.bind(this),shown:this.state.showEventReminderFlyout,onToggle:this.$MercuryLogMessage11},r=void 0;c("requireWeak")("EventsActionsLogger",function(v){r=v});var s={action_history:[{surface:r.Surface.MESSENGER_CHAT_TAB,mechanism:r.Mechanism.REMINDER_ADMIN_TEXT}]},t={threadID:this.props.thread.thread_id,dialogProps:q,flyoutNoSheet:true,isEditing:true,actionContext:s},u;c("requireWeak")("ChatEventReminderContainer.react",function(v){u=v});return c("React").createElement(u,t)};n.prototype.$MercuryLogMessage7=function(){return this.props.maxWidth?{maxWidth:this.props.maxWidth}:null};n.prototype.$MercuryLogMessage6=function(){if(this.$MercuryLogMessage2)c("cancelAnimationFrame")(this.$MercuryLogMessage2);this.$MercuryLogMessage2=c("requestAnimationFrame")(function(){this.props.onImageLoad&&this.props.onImageLoad(c("DOMDimensions").getElementDimensions(this.refs.wrap).height);delete this.$MercuryLogMessage2}.bind(this))};n.propTypes={loadMoreMessages:l.func,maxWidth:l.number,message:l.instanceOf(c("ImmutableObject")).isRequired,onImageLoad:l.func,thread:l.object};n.defaultProps={onImageLoad:c("emptyFunction")};f.exports=n}),null);
__d("ChatConversation.react",["ChatCollapsedLogMessageGroup.react","ChatDateBreak.react","ChatMessageGroup.react","immutable","MercuryLogMessage.react","MercuryIDs","MessengerReadReceipt.bs","MessageList.react","React","MercuryShareAttachmentRenderLocations","cancelAnimationFrame","requestAnimationFrame"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("immutable").OrderedMap,i=c("React").PropTypes,j=c("React").createClass({displayName:"ChatConversation",_raf:undefined,_onMountTimeout:undefined,propTypes:{contextBanner:i.object,isCanonical:i.bool.isRequired,loadMoreMessages:i.func,maxBubbleWidth:i.number.isRequired,messages:i.instanceOf(c("immutable").List).isRequired,onAttachmentLoad:i.func,onMount:i.func,onlineUsers:i.instanceOf(c("immutable").List).isRequired,onStickerClick:i.func,viewer:i.string.isRequired,thread:i.object,threadID:i.string.isRequired},componentDidMount:function k(){this._raf=c("requestAnimationFrame")(function(){this._onMountTimeout=setTimeout(function(){this.props.onMount&&this.props.onMount();delete this._onMountTimeout}.bind(this),0);delete this._raf}.bind(this))},componentWillUnmount:function k(){if(this._raf)c("cancelAnimationFrame")(this._raf);clearTimeout(this._onMountTimeout)},render:function k(){return c("React").createElement("div",null,this.props.contextBanner,c("React").createElement(c("MessageList.react"),{DateBreak:c("ChatDateBreak.react"),LogMessage:c("MercuryLogMessage.react"),MessageGroup:c("ChatMessageGroup.react"),deliveryTimestamp:0,isCanonical:this.props.isCanonical,location:c("MercuryShareAttachmentRenderLocations").CHAT,loadMoreMessages:this.props.loadMoreMessages,maxBubbleWidth:this.props.maxBubbleWidth,CollapsedLogMessageGroup:c("ChatCollapsedLogMessageGroup.react"),messages:this.props.messages,onAttachmentLoad:this.props.onAttachmentLoad,onlineUsers:this.props.onlineUsers,onStickerClick:this.props.onStickerClick,readReceipts:this._calculateReceipts(this.props),ref:"messageList",viewer:this.props.viewer,thread:this.props.thread,threadID:this.props.threadID}))},_calculateReceipts:function k(l){__p&&__p();var m=c("MercuryIDs").getParticipantIDFromUserID(l.viewer),n=c("MessengerReadReceipt.bs").getSeenTimestamps(l.readReceipts,l.threadID),o=new Set(l.thread?l.thread.participants:n.keys());o["delete"](m);return n.withMutations(function(n){__p&&__p();c("immutable").Seq(l.messages).reverse().forEach(function(p){__p&&__p();if(o.size===0)return false;if(!o.has(p.author))return null;n.update(p.author,function(q){if(!q||q.watermark<=p.timestamp)return{watermark:p.timestamp,action:p.timestamp};return q});o["delete"](p.author);return null})})},getMessageList:function k(){return this.refs.messageList}});f.exports=j}),null);
__d("ChatEditParticipantsUtils",["AsyncDialog","AsyncRequest","MercuryIDs","MercuryThreadIDMap","URI"],(function a(b,c,d,e,f,g){"use strict";var h=c("MercuryThreadIDMap").get(),i={showParticipantsModal:function j(k){if(!c("MercuryIDs").isGroupChat(k))return;h.getServerIDFromClientID(k,function(l){c("AsyncDialog").send(new(c("AsyncRequest"))(new(c("URI"))("/ajax/browser/dialog/multichat_members/").addQueryData({id:l})))})}};f.exports=i}),null);
__d("ChatTabComposerContainer.react",["cx","fbt","Bootloader","ChatComposer","FantaMessageActions","FantaTypeComposer","MercuryIDs","MercuryMessageActions","MercuryParticipants","MercuryShareAttachmentRenderLocations","MercuryThreads","MessengerBotMenuDataFetcher","MNCommercePageSetting","P2PGKValues","React","ReactComponentWithPureRenderMixin","SearchableEntry","SimpleXUIDialog","StoreAndPropBasedStateMixin","getPageIDFromThreadID","getThreadTypeNameFromThreadType","gkx","nullthrows","setImmediate"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("ChatComposer").ChatComposer,k="right",l=c("React").PropTypes,m=c("gkx")("AT74KMJ8RYhvB1tMU93uHQ5gZqTAUi_w-rBy6KswPeaIPbVgyCy23kvmxPapx5bD4puY3bmrQeh4Z7ALUGarUq4kATHuSQM2CsFm5KKmhgZoYA"),n=c("React").createClass({displayName:"ChatTabComposerContainer",mixins:[c("ReactComponentWithPureRenderMixin"),c("StoreAndPropBasedStateMixin")(c("MercuryThreads"),c("MercuryParticipants"))],propTypes:{composer:l.object.isRequired,disableInput:l.bool.isRequired,fileUploader:l.object,inputKeyDown:l.func,onEscape:l.func,onFileUploadFail:l.func,onPhotoUploadFail:l.func,onStickerSelect:l.func,onTab:l.func,onUploadCancel:l.func,onUploadComplete:l.func,onUploadSubmit:l.func,threadID:l.string,viewer:l.string.isRequired},_inputRef:null,_photoUploader:null,_setTextImmediate:null,statics:{calculateState:function o(p){var q=c("MercuryThreads").getForFBID(p.viewer),r=p.threadID?q.getOrFetch(p.threadID):null,s=c("P2PGKValues").P2PVisible&&p.viewer!==c("MercuryIDs").getUserIDFromThreadID(p.threadID),t=c("getPageIDFromThreadID")(p.threadID),u=t===null||t===undefined?false:c("MessengerBotMenuDataFetcher").getHasPageSetting(t,function(){},function(){},c("MNCommercePageSetting").STRUCTURED_MENU_ENABLED),v=r&&r.participants?r.participants.map(c("MercuryParticipants").getOrFetch,c("MercuryParticipants")):[];return{thread:r,participants:v,showP2PButton:s,pageID:t,showStructuredMenu:u}}},componentDidMount:function o(){this.props.onMount(this);if(this.state.pageID)c("MessengerBotMenuDataFetcher").getHasPageSetting(this.state.pageID,function(p){this.setState({showStructuredMenu:p})}.bind(this),function(){this.setState({showStructuredMenu:false})}.bind(this),c("MNCommercePageSetting").STRUCTURED_MENU_ENABLED)},UNSAFE_componentWillReceiveProps:function o(p){if(p.threadID!==this.props.threadID)this.setState({participantIDs:[],participants:[]})},render:function o(){var p=this.props.composer;return m?c("React").createElement(j,{composer:p,fileUploader:this.props.fileUploader,inputRef:function(q){return this._inputRef=q}.bind(this),defaultText:p.text,onEmojiSelect:this._handleEmojiSelect,onEscape:this._handleEscape,onInputKeyDown:this._handleInputKeyDown,onTab:this.props.onTab,onTextChange:this._onTextChange,onUploaderMount:function(q){return this._photoUploader=q}.bind(this),pageID:this.state.pageID,participantIDs:this.state.participantIDs,participants:this.state.participants,disableInput:this.props.disableInput,showP2PButton:this.state.showP2PButton,showStructuredMenu:this.state.showStructuredMenu,thread:this.state.thread,threadID:this.props.threadID,uploadPhotoFn:function(q){this._photoUploader&&this._photoUploader.uploadFiles([].concat(q))}.bind(this),viewer:this.props.viewer}):c("React").createElement(j,babelHelpers["extends"]({composer:this.props.composer,defaultText:p.text,fileUploader:this.props.fileUploader,fileUploaderProps:this._getFileUploaderProps(),ref:"composer",thread:this.state.thread},this.props,{disableInput:this.props.disableInput,onTextChange:this._onTextChange,p2pProps:this._getP2PProps(),pageID:this.state.pageID,participantIDs:this.state.participantIDs,participants:this.state.participants,photoUploaderProps:this._getPhotoUploaderProps(),showP2PButton:this.state.showP2PButton,showStructuredMenu:this.state.showStructuredMenu,stickerButtonProps:this._getStickerButtonProps()}))},onSend:function o(p){__p&&__p();var q,r=this;if(p&&p.profile_ranges&&p.profile_ranges.length)(function(){var s=p,t=r.state,u=t.thread,v=t.participants;c("Bootloader").loadModules(["MessengerMentionsTypedLogger","MessengerMentionsLoggerEvents"],function(w,x){new w().setEvent(x.MENTION).setGroupSize(v&&v.length).setNumDelivered((s.profile_ranges||[]).length).setThreadid(u&&u.thread_id).setThreadType(c("getThreadTypeNameFromThreadType")(u&&u.thread_type)).setOfflineThreadid(s.offline_threading_id).log()},"ChatTabComposerContainer.react")})();if(m)this._inputRef&&this._inputRef.onSend&&this._inputRef.onSend(p);else if(this.refs.composer)this.refs.composer.onSend(p)},setParticipantIDs:function o(p){p=p||[];this.setState({participantIDs:p})},getInput:function o(){return m?this._inputRef:this.refs.composer&&this.refs.composer.getInput()},isUploading:function o(){return this.refs.composer.isUploading()},_getP2PProps:function o(){if(!this.state.showP2PButton)return{};return{button:c("React").createElement("i",{className:"hidden_elem"}),className:"_6ga _6gb",flyoutAlignment:k,referrer:c("MercuryShareAttachmentRenderLocations").CHAT,threadID:this.props.threadID,onTrigger:this.props.onP2PTrigger}},_getStickerButtonProps:function o(){var p={className:"_6gb _6gf",flyoutAlignment:k,threadID:this.props.threadID,onStickerSelect:this.props.onStickerSelect};return p},_getPhotoUploaderProps:function o(){var p={className:"_6gd",customUI:true,imageClassName:"hidden_elem",linkClassName:"_6gb _6ge",threadID:this.props.threadID,onLastUploadCancel:this._handleUploadCancel,onAllUploadsComplete:this._handleUploadComplete,onLastUploadFail:this._handlePhotoUploadFail,onUploadError:this._handleUploadError,onSubmit:this._handleUploadSubmit};return p},_getFileUploaderProps:function o(){var p=this._getPhotoUploaderProps();p.linkClassName="_6gb _6gg";p.imagesOnly=false;p.onLastUploadFail=this._handleFileUploadFail;return p},_handleUploadComplete:function o(p,q){c("MercuryMessageActions").getForFBID(this.props.viewer).confirmAttachmentPlaceholder(q.upload_id,q);this.props.onUploadComplete&&this.props.onUploadComplete(q)},_handleUploadError:function o(p){var q=void 0,r=void 0;switch(p.error){case"size-exceeded":q=i._("The file you have selected is too large");r=i._("The file you have selected is too large. The maximum size is 25MB.");break;default:q=i._("File Upload Failed");r=i._("There was a problem uploading the file.")}this._showErrorDialog(q,r);this.props.onFileUploadFail&&this.props.onFileUploadFail(p)},_handleUploadCancel:function o(p,q){c("MercuryMessageActions").getForFBID(this.props.viewer).cancelAttachmentPlaceholder(q.upload_id,q);this.props.onUploadCancel&&this.props.onUploadCancel(q)},_handleFileUploadFail:function o(p,q){c("MercuryMessageActions").getForFBID(this.props.viewer).cancelAttachmentPlaceholder(q.upload_id,q);var r=i._("File Upload Failed"),s=i._("There was a problem uploading the file.");if(q.errorDialogParams){r=q.errorDialogParams.title||r;s=q.errorDialogParams.body||s}this._showErrorDialog(r,s);this.props.onFileUploadFail&&this.props.onFileUploadFail(q)},_handlePhotoUploadFail:function o(p,q){c("MercuryMessageActions").getForFBID(this.props.viewer).cancelAttachmentPlaceholder(q.upload_id,q);var r=i._("Upload Failed"),s=i._("Please try again. Make sure that you are uploading a valid file.");if(q.errorDialogParams){r=q.errorDialogParams.title||r;s=q.errorDialogParams.body||s}this._showErrorDialog(r,s);this.props.onPhotoUploadFail&&this.props.onPhotoUploadFail(q)},_handleUploadSubmit:function o(p,q){this.props.onUploadSubmit&&this.props.onUploadSubmit(q)},_showErrorDialog:function o(p,q){c("SimpleXUIDialog").show(q,p)},_handleReplyToMention:function o(p,event){if(event.threadID===this.props.threadID)c("MercuryParticipants").get(event.participantID,function(q){if(!q||!this.refs.composer)return;var r=new(c("SearchableEntry"))({uniqueID:c("nullthrows")(q.fbid),title:"@"+q.name});c("setImmediate")(function(){this.refs.composer.getInput()&&this.refs.composer.getInput().focus();this.refs.composer.replyToMention&&this.refs.composer.replyToMention(r)}.bind(this))}.bind(this))},_handleInputKeyDown:function o(p,q){this.props.inputKeyDown&&this.props.inputKeyDown(p,q)},_handleEscape:function o(p){this.props.onEscape&&this.props.onEscape(p)},_handleEmojiSelect:function o(p){this._inputRef&&this._inputRef.insertEmoji&&this._inputRef.insertEmoji(p)},_onTextChange:function o(p,q){var r=this.props.threadID;if(r)this._setTextImmediate=c("setImmediate")(function(){this._setTextImmediate=null;c("FantaMessageActions").composerTextUpdate(r,p,q)}.bind(this))}});f.exports=n}),null);
__d("ChatTitleLink.react",["cx","ChatEditParticipantsUtils","Link.react","MercuryThreads","MercuryThreadTitle.react","MessengerAdminGroupUtils","React","TrackingNodes","UserAgent","goURI"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("MercuryThreads").get(),j=c("React").PropTypes,k=c("React").createClass({displayName:"ChatTitleLink",propTypes:{href:j.string,thread:j.object,viewer:j.string},getDefaultProps:function m(){return{href:null}},getTitle:function m(){return this.refs.threadTitle.getTitle()},render:function m(){if(!this.props.thread)return null;var n=this.props,o=n.href,p=n.thread,q=n.viewer,r=babelHelpers.objectWithoutProperties(n,["href","thread","viewer"]);return c("React").createElement(l,babelHelpers["extends"]({className:"titlebarText"+(c("UserAgent").isBrowser("Chrome")&&!c("UserAgent").isPlatform("Windows")?" fixemoji":"")+(o===null?" noLink":""),"data-ft":c("TrackingNodes").getTrackingInfo(c("TrackingNodes").types.TITLE),"data-hover":"tooltip",onClick:function(s){return this._handleClick(s)}.bind(this),href:o},r),c("React").createElement(c("MercuryThreadTitle.react"),{ref:"threadTitle",isNewThread:i.isNewEmptyLocalThread(p.thread_id),thread:p,useAndSeparator:true,useShortName:!p.is_canonical,viewer:q}))},_handleClick:function m(n){var o=this.props,p=o.href,q=o.thread;if(!p)return;if(q&&q.associated_object)c("goURI")(p);else if(c("MessengerAdminGroupUtils").showParticipantsModal(q.is_canonical,i.isEmptyLocalThread(q.thread_id),q)){c("ChatEditParticipantsUtils").showParticipantsModal(q.thread_id);n.preventDefault()}}}),l=function l(m){return m.href?c("React").createElement(c("Link.react"),m):c("React").createElement("span",m)};f.exports=k}),null);
__d("ChatTabHeader.react",["cx","fbt","AutoFocusableLink.react","Bootloader","MercuryBootloadOnInteraction.react","BootloadOnRender.react","ChatCloseButton.react","ChatTitleLink.react","EventPlanExperiment","EventReminderStateStore","FantaTypeComposer","immutable","JSResource","LayerFadeOnHide","LazyComponent.react","LoadOnRender.react","MercuryThreadInfo","MercuryTypingAnimation.react","MessageRequestUtils","MessagingTag","MessengerAdminGroupUtils","MessengerJoinableModeType","React","SimpleNUXMessage","TooltipData","XUIAmbientNUX.react","requireWeak","gkx"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes,m="118809038721180",n=function n(q){c("Bootloader").loadModules(["ArchiveWarningReact.bs"],function(r){var s=r.jsComponent;return q(s)},"ChatTabHeader.react")},o=c("gkx")("AT7esXHVKl_rB1r5C-zEkmCVhZJMRd4NQJBo-b1EyRH6vUNk2XZEcNJ3WOEvumLbmsR6a_bwkl5o0d60WUY3jm1v");j=babelHelpers.inherits(p,c("React").PureComponent);k=j&&j.prototype;function p(q){__p&&__p();k.constructor.call(this,q);this.$ChatTabHeader1=false;this.$ChatTabHeader4=function(){for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];this.props.onClick.apply(null,s)}.bind(this);this.$ChatTabHeader15=function(){return this.refs.menu}.bind(this);this.$ChatTabHeader16=function(){c("SimpleNUXMessage").markMessageSeenByUser(m);this.setState({eventPlanNuxSeen:true})}.bind(this);this.state={eventPlanNuxSeen:c("SimpleNUXMessage").hasUserSeenMessage(m)}}p.prototype.componentDidMount=function(){this.$ChatTabHeader1=true;c("requireWeak")("ChatVideoCallButton.react",function(q){if(this.$ChatTabHeader1)this.setState({RTCComponent:q})}.bind(this))};p.prototype.componentWillUnmount=function(){this.$ChatTabHeader1=false};p.prototype.render=function(){var q=this.$ChatTabHeader3(),r=this.props.isRaised;return c("React").createElement("div",{className:"_15p4"+(!this.props.isRaised?" _15p5":"")+(r||!q?" _2pis":""),onMouseUp:this.$ChatTabHeader4,ref:"root"},c("React").createElement("div",{"aria-level":"2",className:"titlebarTextWrapper _15p6",role:"heading"},c("React").createElement("div",{className:"_61td",role:r?"presentation":"button",tabIndex:r?-1:0},q,this.$ChatTabHeader5()),this.props.isTyping&&!this.props.isRaised?c("React").createElement(c("MercuryTypingAnimation.react"),{className:"_15p8",color:"dark"}):null),c("React").createElement("ul",{className:"_32ca"+(o?" _2qi8":"")},this.$ChatTabHeader6(),c("React").createElement("li",{className:"_32cb"},c("React").createElement(c("ChatCloseButton.react"),{active:this.props.isActive,className:"_3olu _3olv",onClick:this.props.onCloseClick}))))};p.prototype.focus=function(){this.refs.root&&this.refs.root.focus()};p.prototype.$ChatTabHeader7=function(){return this.props.thread?c("MessageRequestUtils").isMessageRequest(this.props.thread):false};p.prototype.$ChatTabHeader6=function(){if(!this.props.isRaised)return null;var q=[this.$ChatTabHeader8(),this.$ChatTabHeader9(),this.$ChatTabHeader10(),this.$ChatTabHeader11(),this.$ChatTabHeader12(),this.$ChatTabHeader13()];return q.filter(Boolean)};p.prototype.$ChatTabHeader12=function(){return this.$ChatTabHeader14({isAudio:true})};p.prototype.$ChatTabHeader11=function(){return this.$ChatTabHeader14({isAudio:false})};p.prototype.$ChatTabHeader14=function(q){__p&&__p();if(this.props.isEmptyChat||this.$ChatTabHeader7())return null;var r=this.props,s=r.isGroupChat,t=r.onRTCNuxCloseButtonClick,u=r.rtcNuxShown,v=r.thread,w=r.threadID,x=r.viewer;if(s){if(!v||v.participants.length<=1||!c("MercuryThreadInfo").canReply(v))return null;if(v.joinable_mode&&v.joinable_mode.mode===c("MessengerJoinableModeType").JOINABLE)return null}var y=babelHelpers["extends"]({isGroupChat:s,onRTCNuxCloseButtonClick:t,rtcCallData:v&&v.rtc_call_data,rtcNuxShown:u&&q.isAudio,threadID:w,thread:v,viewer:x},q);y.className="_3olv"+(y.isAudio?" _2fpc":"")+(!y.isAudio?" _2fpd":"");var z=this.state.RTCComponent;return c("React").createElement("li",{className:"_3a61"+(y.isAudio?" _461a":"")+(!y.isAudio?" _461b":""),key:"rtc"+(y.isAudio?"audio":"video")},z?c("React").createElement(z,y):c("React").createElement(c("MercuryBootloadOnInteraction.react"),{component:c("React").createElement(c("LazyComponent.react"),y),loader:c("JSResource")("ChatVideoCallButton.react").__setRef("ChatTabHeader.react"),placeholder:c("React").createElement(c("AutoFocusableLink.react"),{className:y.className,role:"button"})}))};p.prototype.$ChatTabHeader13=function(){__p&&__p();var q=this.props.thread;if(this.props.isEmptyChat||!!q&&q.folder===c("MessagingTag").PENDING)return null;var r=babelHelpers["extends"]({attachmentsShelf:this.props.attachmentsShelf,composer:this.props.composer,isEmptyChat:this.props.isEmptyChat,isGroupChat:this.props.isGroupChat,isMultiCompany:this.props.isMultiCompany,isMuted:this.props.isMuted,isPageChat:this.props.isPageChat,membershipParticipants:this.props.membershipParticipants,nameConversationFunc:this.props.nameConversationFunc,otherUserID:this.props.otherUserID,participants:this.props.participants,sheetController:this.props.sheetController,showAddFriend:this.props.showAddFriend,thread:this.props.thread,threadID:this.props.threadID,viewer:this.props.viewer},this.props.additionalMenuProps);r.className="_3olv _1ll-";var s=i._("Options"),t=false;if(this.props.threadID){var u=c("EventReminderStateStore").getEvent(this.props.threadID);t=u&&!u.exists&&!this.state.eventPlanNuxSeen&&c("EventPlanExperiment").shouldShowEntryPointNuxWithExposure()}return c("React").createElement("div",{key:"menu"},c("React").createElement("li",{className:"_3a61 _461_",ref:"menu"},c("React").createElement(c("MercuryBootloadOnInteraction.react"),{component:c("React").createElement(c("LazyComponent.react"),r),loader:c("JSResource")("ChatTabMenu.react").__setRef("ChatTabHeader.react"),placeholder:c("React").createElement(c("AutoFocusableLink.react"),{className:r.className,"aria-label":s,role:"button"})})),c("React").createElement(c("XUIAmbientNUX.react"),{alignment:"right",behaviors:{LayerFadeOnHide:c("LayerFadeOnHide")},contextRef:this.$ChatTabHeader15,onCloseButtonClick:this.$ChatTabHeader16,shown:t,width:"auto"},i._("Click here to start a new plan.")))};p.prototype.$ChatTabHeader10=function(){if(this.props.isPageChat||this.props.isEmptyChat||this.props.isMultiCompany&&!this.props.isGroupChat||this.$ChatTabHeader7())return null;var q={className:"_3olv _3jyj",isFBAtWork:this.props.isWorkUser,shouldAddToApprovalQueue:c("MessengerAdminGroupUtils").shouldAddToApprovalQueue(this.props.thread,this.props.viewer),shown:true,onClick:function(){return this.props.sheetController.openAddFriendsSheet()}.bind(this)},r=i._("Add");return c("React").createElement("li",{className:"_3a61 _4620",key:"add"},c("React").createElement(c("MercuryBootloadOnInteraction.react"),{component:c("React").createElement(c("LazyComponent.react"),q),loader:c("JSResource")("ChatAddToThreadButton.react").__setRef("ChatTabHeader.react"),placeholder:c("React").createElement(c("AutoFocusableLink.react"),{"aria-label":r,className:q.className,role:"button"})}))};p.prototype.$ChatTabHeader8=function(){if(!this.props.isViewerEmployee)return null;var q=this.props.participants,r=q?q.length>0&&q.every(function(s){return!!(s&&s.employee)}):false;if(!r)return null;return c("React").createElement("li",{key:"archiveWarning"},c("React").createElement(c("LoadOnRender.react"),{component:c("React").createElement(c("LazyComponent.react"),{shown:true}),loader:n,placeholder:c("React").createElement("div",null)}))};p.prototype.$ChatTabHeader9=function(){if(!this.props.isWorkUser||!this.props.isMultiCompany)return null;var q=i._("Multi-company chat");return c("React").createElement("li",{key:"multiCompanyBadge"},c("React").createElement("div",{className:"_3olv"},c("React").createElement(c("AutoFocusableLink.react"),babelHelpers["extends"]({className:"_kp6",onClick:this.props.onClick,lable:q,role:"presentation"},c("TooltipData").propsFor(q,"above")))))};p.prototype.$ChatTabHeader17=function(){return c("React").createElement("span",{className:"_3a61"+(!this.props.isRaised?" _3-99":"")},c("React").createElement("span",{className:"_3olv _2nlt"}))};p.prototype.$ChatTabHeader5=function(){return c("React").createElement(c("ChatTitleLink.react"),babelHelpers["extends"]({href:this.props.isRaised?this.props.href:undefined,thread:this.props.thread,viewer:this.props.viewer},c("TooltipData").propsFor(this.props.tooltip,"above")))};p.prototype.$ChatTabHeader3=function(){var q=this.props,r=q.isRaised,s=q.thread;if(!r&&s&&s.unread_count>0)return c("React").createElement(c("BootloadOnRender.react"),{component:c("React").createElement(c("LazyComponent.react"),{className:"_3-8_ _3-99",count:s.unread_count,type:"special"}),loader:c("JSResource")("XUIBadge.react").__setRef("ChatTabHeader.react"),placeholder:c("React").createElement("span",null)});return this.$ChatTabHeader17()};p.propTypes={additionalMenuProps:l.object,attachmentsShelf:l.object.isRequired,composer:l.object,href:l.string,isActive:l.bool.isRequired,isEmptyChat:l.bool,isGroupChat:l.bool,isMuted:l.bool,isPageChat:l.bool,isRaised:l.bool,isTyping:l.bool,isViewerEmployee:l.bool,isWorkUser:l.bool,nameConversationFunc:l.func.isRequired,onClick:l.func.isRequired,onCloseClick:l.func.isRequired,onRTCNuxCloseButtonClick:l.func.isRequired,otherUserID:l.string,participants:l.arrayOf(l.object),rtcNuxShown:l.bool.isRequired,sheetController:l.object.isRequired,showAddFriend:l.func.isRequired,thread:l.object,threadID:l.string,tooltip:l.string,viewer:l.string.isRequired};f.exports=p}),null);
__d("getGroupNameTooltipFromParticipantIDs",["fbt","MercuryParticipants","MercuryViewer"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=10,j="\n";function k(m,n){__p&&__p();var o=[],p=c("MercuryViewer").getID();m=m&&m.filter(function(s){return s!==p});if(!m||!m.length){n(null);return}var q=m.length,r=q-i;if(r>1)m=m.slice(0,i);c("MercuryParticipants").getMulti(m,function(s){for(var t in s){var u=s[t];o.push(u.name)}if(r>1){var v=h._("and {number of hidden chat participants} more.",[h._param("number of hidden chat participants",r)]);o.push(v)}n(o.join(j))})}function l(m){__p&&__p();var n=[],o=c("MercuryViewer").getID();m=m&&m.filter(function(r){return r!==o});if(!m||!m.length)return null;n=m.map(function(r){var s=c("MercuryParticipants").getOrFetch(r);return s&&s.name}).filter(function(r){return!!r});var p=m.length-(m.length-n.length)-i;if(p>1){n=n.slice(0,i);var q=h._("and {number of hidden chat participants} more.",[h._param("number of hidden chat participants",p)]);n.push(q)}return n.join(j)}f.exports={getGroupNameTooltipFromParticipantIDs:l,getGroupNameTooltipFromParticipantIDsAsync:k}}),null);
__d("getTitleHrefFromThreadID",["MercuryIDs","MercuryParticipants","WebMessengerThreadPermalinks"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i,j){__p&&__p();if(c("MercuryIDs").isLocalThread(i)){j();return}var k=c("MercuryIDs").getUserIDFromThreadID(i);if(k)c("MercuryParticipants").get(c("MercuryIDs").getParticipantIDFromUserID(k),function(l){if(l.href)j(l.href);else j(c("WebMessengerThreadPermalinks").getThreadURIFromUserID(k))});else c("WebMessengerThreadPermalinks").getThreadURI(i,j)}f.exports=h}),null);
__d("ChatTabHeaderContainer.react",["ChatTabHeader.react","CurrentUser","FantaTypeComposer","immutable","MercuryIDs","MercuryParticipants","MercuryThreadInfo","MercuryThreads","React","SubscriptionsHandler","WorkModeConfig","getPageIDFromThreadID","getGroupNameTooltipFromParticipantIDs","getTitleHrefFromThreadID"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=c("getGroupNameTooltipFromParticipantIDs").getGroupNameTooltipFromParticipantIDs,k=c("React").PropTypes;h=babelHelpers.inherits(l,c("React").PureComponent);i=h&&h.prototype;function l(m){i.constructor.call(this,m);this.$ChatTabHeaderContainer1=new(c("SubscriptionsHandler"))();this.state=this.calculateState(m)}l.prototype.calculateState=function(m){__p&&__p();var n=false,o=true,p=false,q=void 0,r=void 0,s=void 0,t=void 0,u=void 0;if(m.threadID){var v=c("MercuryThreads").getForFBID(m.viewer);t=v.getOrFetch(m.threadID);n=c("MercuryIDs").isGroupChat(m.threadID);o=v.isNewEmptyLocalThread(m.threadID);p=!!t&&c("MercuryThreadInfo").isMuted(t);q=c("MercuryIDs").getUserIDFromThreadID(m.threadID);r=c("getPageIDFromThreadID")(m.threadID);if(t){s=t.participants.map(c("MercuryParticipants").getOrFetch,c("MercuryParticipants"));u=j(t.participants)}}var w=this.state&&this.state.additionalMenuProps||{};if(m)w=babelHelpers["extends"]({},w,m.additionalMenuProps);return{additionalMenuProps:w,isEmptyChat:o,isGroupChat:n,isMuted:p,otherUserID:q,pageID:r,participants:s,thread:t,tooltip:u}};l.prototype.UNSAFE_componentWillMount=function(){this.$ChatTabHeaderContainer1.addSubscriptions(c("MercuryThreads").addListener("change",function(){this.setState(this.calculateState(this.props))}.bind(this)),c("MercuryParticipants").addListener("change",function(){this.setState(this.calculateState(this.props))}.bind(this)))};l.prototype.componentDidMount=function(){this.$ChatTabHeaderContainer2();this.props.onMount&&this.props.onMount(this)};l.prototype.UNSAFE_componentWillReceiveProps=function(m){if(m.threadID!==this.props.threadID)this.$ChatTabHeaderContainer2();this.setState(this.calculateState(m))};l.prototype.componentWillUnmount=function(){this.$ChatTabHeaderContainer1.release()};l.prototype.render=function(){return c("React").createElement(c("ChatTabHeader.react"),{additionalMenuProps:this.state.additionalMenuProps,attachmentsShelf:this.props.attachmentsShelf,composer:this.props.composer,href:this.state.href,isActive:this.props.isActive,isEmptyChat:this.state.isEmptyChat,isGroupChat:this.state.isGroupChat,isMultiCompany:this.props.isMultiCompany,isMuted:this.state.isMuted,isPageChat:!!this.state.pageID,isRaised:this.props.isRaised,isTyping:this.props.isTyping,isViewerEmployee:c("CurrentUser").isEmployee(),isWorkUser:!!c("WorkModeConfig").is_work_user,membershipParticipants:this.props.membershipParticipants,nameConversationFunc:this.props.nameConversationFunc,onClick:this.props.onClick,onCloseClick:this.props.onCloseClick,onRTCNuxCloseButtonClick:this.props.onRTCNuxCloseButtonClick,otherUserID:this.state.otherUserID,participants:this.state.participants,ref:"header",rtcNuxShown:this.props.rtcNuxShown,sheetController:this.props.sheetController,showAddFriend:this.props.showAddFriend,thread:this.state.thread,threadID:this.props.threadID,tooltip:this.state.tooltip,viewer:this.props.viewer})};l.prototype.focus=function(){this.refs.header.focus()};l.prototype.setAdditionalMenuProps=function(m){var n=babelHelpers["extends"]({},this.state.additionalMenuProps,m);this.setState({additionalMenuProps:n})};l.prototype.$ChatTabHeaderContainer2=function(){c("getTitleHrefFromThreadID")(this.props.threadID,function(m){return this.setState({href:m})}.bind(this))};l.propTypes={additionalMenuProps:k.object,attachmentsShelf:k.object.isRequired,composer:k.object,isActive:k.bool.isRequired,isRaised:k.bool,isTyping:k.bool,nameConversationFunc:k.func.isRequired,onClick:k.func.isRequired,onCloseClick:k.func.isRequired,onMount:k.func,onRTCNuxCloseButtonClick:k.func.isRequired,rtcNuxShown:k.bool.isRequired,sheetController:k.object.isRequired,showAddFriend:k.func.isRequired,threadID:k.string,viewer:k.string.isRequired};f.exports=l}),null);
__d("XGroupCallNuxController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/groupcall/nux/",{action:{type:"String",required:true}})}),null);
__d("FantaChatHeaderContainer.react",["cx","AsyncRequest","ChatTabHeaderContainer.react","FantaTabActions","FantaTabSheetActions","FantaTypeComposer","immutable","MercuryConfig","MercuryIDs","MercuryIgnoredBlockedParticipants.bs","MercuryParticipants","MercuryThreadInfo","MercuryThreads","MessageRequestUtils","React","XGroupCallNuxController","isEmpty"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("MercuryThreads").get(),l=c("React").PropTypes;i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;function m(){__p&&__p();var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.$FantaChatHeaderContainer1=false,this.state={rtcNuxShown:false},this.$FantaChatHeaderContainer5=function(){var s=this.props.threadID;c("FantaTabSheetActions").openAddMoreFriendsSheet(s)}.bind(this),this.$FantaChatHeaderContainer4=function(){var s=this.props.threadID;c("FantaTabSheetActions").openNameConversationSheet(s)}.bind(this),this.$FantaChatHeaderContainer6=function(){var s=this.props.threadID;c("FantaTabSheetActions").openAddMoreFriendsSheet(s)}.bind(this),this.$FantaChatHeaderContainer8=function(){this.props.onClose&&this.props.onClose()}.bind(this),this.$FantaChatHeaderContainer7=function(event){this.$FantaChatHeaderContainer3();var s=event.target;if(!s)return;if(s.getAttribute("role")==="presentation"||s.classList&&(s.classList.contains("_15p6")||s.classList.contains("_2nlt")||s.classList.contains("_14lt"))){event.preventDefault();c("FantaTabActions").minimizeTab(this.props.threadID)}}.bind(this),this.$FantaChatHeaderContainer3=function(){if(this.state.rtcNuxShown&&this.$FantaChatHeaderContainer1){this.setState({rtcNuxShown:false});var s=c("XGroupCallNuxController").getURIBuilder().setString("action","dismiss").getURI();new(c("AsyncRequest"))(s).send()}}.bind(this),o}m.prototype.shouldComponentUpdate=function(n,o){var p=this.props,q=this.state;return p.viewer!==n.viewer||p.threadID!==n.threadID||p.isLastGroupTab!==n.isLastGroupTab||p.thread!==n.thread||q.rtcNuxShown!==o.rtcNuxShown||p.customColor!==n.customColor||p.blockedIDs!==n.blockedIDs||!p.membershipParticipants&&!!n.membershipParticipants||!!p.membershipParticipants&&!!n.membershipParticipants&&!p.membershipParticipants.equals(n.membershipParticipants)};m.prototype.componentDidMount=function(){this.$FantaChatHeaderContainer1=true;this.$FantaChatHeaderContainer2()};m.prototype.componentWillUnmount=function(){this.$FantaChatHeaderContainer3();this.$FantaChatHeaderContainer1=false};m.prototype.render=function(){var n=this.props,o=n.isFocused,p=n.thread,q=n.threadID,r=n.viewer,s=n.customColor,t=this.state.rtcNuxShown,u=!!p&&c("MercuryThreadInfo").isMuted(p),v=c("MercuryIDs").getParticipantIDFromFromThreadID(q),w=v?c("MercuryParticipants").getNow(v):null,x=w&&w.is_business_enabled,y=p&&c("MercuryThreadInfo").showComposer(p)&&!c("isEmpty")(p.participants)&&!c("MessageRequestUtils").isMessageRequest(p)&&!c("MercuryConfig").ViewerIsReadOnly&&!(c("MercuryConfig").ColdOpenBlock&&(c("MercuryThreadInfo").isColdOpen(p)||c("MercuryThreadInfo").isEmptyLocalThread(p))),z=p&&c("MercuryIgnoredBlockedParticipants.bs").qualifiesAs(this.props.viewer,this.props.blockedIDs,p),A=k.isNewEmptyLocalThread(q),B=p&&p.message_count===0,C={hasMessageBlocked:z,isBusinessEnabled:x,isEmptyChat:A,isEmptyConversation:B,isMuted:u,show:y},D=s?{color:s}:null;return c("React").createElement("div",{className:"clearfix fbNubFlyoutTitlebar titlebar"+(!!s?" _1m34":""),style:D},c("React").createElement(c("ChatTabHeaderContainer.react"),{composer:this.props.composer,additionalMenuProps:C,attachmentsShelf:document.createElement("div"),isActive:o,isRaised:true,isTyping:false,nameConversationFunc:this.$FantaChatHeaderContainer4,rtcNuxShown:t,sheetController:{openAddFriendsSheet:this.$FantaChatHeaderContainer5},showAddFriend:this.$FantaChatHeaderContainer6,threadID:q,viewer:r,onClick:this.$FantaChatHeaderContainer7,onCloseClick:this.$FantaChatHeaderContainer8,onRTCNuxCloseButtonClick:this.$FantaChatHeaderContainer3,isMultiCompany:this.props.isMultiCompany,membershipParticipants:this.props.membershipParticipants}))};m.prototype.$FantaChatHeaderContainer9=function(n){return n.length>0&&n.every(function(o){var p=c("MercuryParticipants").getNow(o);return!!(p&&p.employee)})};m.prototype.$FantaChatHeaderContainer2=function(){if(this.props.isLastGroupTab){var n=c("XGroupCallNuxController").getURIBuilder().setString("action","should_show").getURI();new(c("AsyncRequest"))(n).setHandler(function(o){var p=o.payload.shouldShow;if(this.$FantaChatHeaderContainer1)this.setState({rtcNuxShown:p})}.bind(this)).send()}};m.propTypes={blockedIDs:l.instanceOf(Set).isRequired,customColor:l.string,isFocused:l.bool.isRequired,isLastGroupTab:l.bool.isRequired,onClose:l.func.isRequired,thread:l.object,threadID:l.string.isRequired,viewer:l.string.isRequired};f.exports=m}),null);
__d("FantaConversation.react",["Bootloader","ChatConversation.react","CurrentUser","EventProfiler","MercuryIDs","MessengerHotLikePreviewEvents","React","StickerInterfaces","StickersTypedLogger","SubscriptionsHandler","emptyFunction"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=c("React").PropTypes;h=babelHelpers.inherits(k,c("React").Component);i=h&&h.prototype;function k(l){__p&&__p();i.constructor.call(this,l);this.$FantaConversation4=function(m){if(this.props.threadID===m)this.setState({likePreview:null})}.bind(this);this.$FantaConversation5=function(m,n){__p&&__p();if(!m)return;new(c("StickersTypedLogger"))().setEvent("click_sticker").setPackid(m).setStickerid(n).log();c("Bootloader").loadModules(["StickersPackInTray","StickersActions","StickersStoreController"],function(o,p,q){o.onIsPackInTray(m,c("StickerInterfaces").MESSAGES,function(r){if(r.in_sticker_tray){p.selectTrayPack(m);p.showStickerFlyout(this.props.threadID)}else q.showStore(m)}.bind(this))}.bind(this),"FantaConversation.react")}.bind(this);this.state={likePreview:null};this.$FantaConversation1=new(c("SubscriptionsHandler"))()}k.prototype.shouldComponentUpdate=function(l,m){var n=this.props,o=this.state;return!n.onlineUsers.equals(l.onlineUsers)||!n.messages.equals(l.messages)||n.threadID!==l.threadID||n.thread!==l.thread||o.likePreview!==m.likePreview};k.prototype.componentDidMount=function(){this.$FantaConversation2();this.$FantaConversation3()};k.prototype.componentDidUpdate=function(){this.$FantaConversation3()};k.prototype.componentWillUnmount=function(){this.$FantaConversation1.release()};k.prototype.$FantaConversation3=function(){c("EventProfiler").informManualInteractionTimestamp(["MessageJewelListItem","ChatSideBarLink"],true,"click")};k.prototype.$FantaConversation2=function(){this.$FantaConversation1.addSubscriptions(c("MessengerHotLikePreviewEvents").addListener(c("MessengerHotLikePreviewEvents").START,function(l,m){if(this.props.threadID===m)this.setState({likePreview:l})}.bind(this)),c("MessengerHotLikePreviewEvents").addListener(c("MessengerHotLikePreviewEvents").STOP,this.$FantaConversation4),c("MessengerHotLikePreviewEvents").addListener(c("MessengerHotLikePreviewEvents").STOP_EMOJI,this.$FantaConversation4),c("MessengerHotLikePreviewEvents").addListener(c("MessengerHotLikePreviewEvents").REMOVE,this.$FantaConversation4))};k.prototype.render=function(){var l=this.props.messages,m=this.props,n=m.onLoadMoreMessages,o=m.thread,p=m.threadID,q=this.state.likePreview,r=c("CurrentUser").getID();if(q)l=l.push(q);return o?c("React").createElement(c("ChatConversation.react"),{isCanonical:c("MercuryIDs").isCanonical(p),loadMoreMessages:n,maxBubbleWidth:181-this.props.scrollbarPadding,messages:l,onAttachmentLoad:function(){return this.props.onAttachmentLoad()}.bind(this),onMount:c("emptyFunction"),onStickerClick:this.$FantaConversation5,onlineUsers:this.props.onlineUsers,readReceipts:this.props.readReceipts,ref:"conversation",thread:o,threadID:p,viewer:r}):c("React").createElement("div",null)};k.prototype.getMessageList=function(){return this.refs.conversation&&this.refs.conversation.getMessageList()};k.propTypes={messages:j.object.isRequired,onLoadMoreMessages:j.func.isRequired,onlineUsers:j.object.isRequired,scrollbarPadding:j.number,thread:j.object,threadID:j.string.isRequired};f.exports=k}),null);
__d("FantaPageGreetingLoader.react",["cx","BootloadOnRender.react","JSResource","LazyComponent.react","React","getPageIDFromThreadID","idx"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=function i(j){var k=j.thread,l=j.threadID;if(k!=null){var m,n=((m=k)!=null?m.is_canonical_neo_user:m)||false;if(n)return null}else return null;return c("getPageIDFromThreadID")(l)?c("React").createElement("div",{className:"_av1"},c("React").createElement(c("BootloadOnRender.react"),{loader:c("JSResource")("MercuryChatTabPagesGreetingContainer.react").__setRef("FantaPageGreetingLoader.react"),placeholder:c("React").createElement("div",null),component:c("React").createElement(c("LazyComponent.react"),{threadID:l})})):null};f.exports=i}),null);
__d("MercuryCamQuickReply.react",["cx","fbt","BootloadedComponent.react","JSResource","MercuryIDs","MercuryThreads","MessengerQuickCamOrigins","React","XUISpinner.react","convertMIGColorToFIGColor"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("MercuryThreads").get(),m=c("React").PropTypes;j=babelHelpers.inherits(n,c("React").PureComponent);k=j&&j.prototype;n.prototype.UNSAFE_componentWillUpdate=function(o,p){if(o&&this.props.lastMessage!==o.lastMessage&&this.props.camQuickReplyWillShow)this.props.camQuickReplyWillShow()};n.prototype.componentDidUpdate=function(o,p){if(o&&this.props.lastMessage!==o.lastMessage&&this.props.camQuickReplyDidShow)this.props.camQuickReplyDidShow()};n.prototype.render=function(){var o=this.props.lastMessage,p=c("MercuryIDs").getParticipantIDFromUserID(this.props.viewer);if(!(o&&o.message_source&&o.author!==p&&o.message_source==="camera"))return null;var q=l.getThreadMetaNow(this.props.threadID),r=q?c("convertMIGColorToFIGColor")(q.custom_color):null,s=c("React").createElement("div",{className:"_zdf",style:r&&{color:r}},i._("Send a photo reply"));return c("React").createElement("div",{className:"_zdg"},c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("MessengerQuickCamButtonHTML5.react").__setRef("MercuryCamQuickReply.react"),bootloadPlaceholder:c("React").createElement(c("XUISpinner.react"),{className:"_5h-9"}),className:"_5yhk _6gb",location:c("MessengerQuickCamOrigins").CHAT_TAB,threadID:this.props.threadID,viewer:this.props.viewer,textChild:s}))};function n(){j.apply(this,arguments)}n.propTypes={camQuickReplyWillShow:m.func,camQuickReplyDidShow:m.func,lastMessage:m.object,threadID:m.string.isRequired,viewer:m.string.isRequired};f.exports=n}),null);
__d("MercuryLastMessageIndicator.react",["cx","fbt","MercuryIDs","MercuryMessageSourceTags","MercuryParticipants","MercuryThreads","MercuryViewer","MessengerReadReceipt.bs","MessengerTextWithEmoticons.react","React","ReactDOM","immutable","SubscriptionsHandler","TooltipData","WorkModeConfig","emptyFunction","formatDate","joinClasses"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j,k,l=c("MercuryThreads").get(),m=c("immutable").Set,n=c("React").PropTypes,o=function o(t,u,v){var w=c("MessengerReadReceipt.bs").getSeenTimestamp(t,v,u[0]),x=w.action*.001;return{seenTimestamp:x,seenByData:null}},p=function p(t,u,v){__p&&__p();var w={};for(var x=t,y=Array.isArray(x),z=0,x=y?x:x[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var A;if(y){if(z>=x.length)break;A=x[z++]}else{z=x.next();if(z.done)break;A=z.value}var B=A;w[B]=c("MercuryParticipants").getNow(B)}var C=l.getThreadMetaNow(u),D=null;if(C&&C.custom_nickname)D=C.custom_nickname;var E={};for(var F=Object.keys(w),G=Array.isArray(F),H=0,F=G?F:F[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var I;if(G){if(H>=F.length)break;I=F[H++]}else{H=F.next();if(H.done)break;I=H.value}var J=I,K=w[J],L=void 0;if(!K)L=c("MercuryParticipants").getDefaultName();else{L=K.short_name;if(D&&D[K.fbid])L=D[K.fbid]}E[J]=L}var M=void 0,N=false,O=false;if(r(t,v,C))O=true;else if(t.length==1)M=" "+E[t[0]];else if(t.length==2)M=" "+E[t[0]]+", "+E[t[1]];else if(t.length==3)M=" "+E[t[0]]+", "+E[t[1]]+", "+E[t[2]];else if(t.length>3){M=" "+E[t[0]]+", "+E[t[1]]+", ";N=true}return{seenTimestamp:null,seenByData:{seenByAll:O,text:M,showTooltip:N,seenBy:t}}},q=function q(t,u,v){var w=c("MessengerReadReceipt.bs").getSeenBy(t,v,true);if(w.length===0)return{seenTimestamp:null,seenByData:null};var x=c("MercuryIDs").getUserIDFromThreadID(u);if(x)return o(t,w,u);else return p(w,u)},r=function r(t,u,v){var w=v?v.participants.length:0,x=t.length;if(u&&u.author!=c("MercuryViewer").getID()&&(!v||v.participants.indexOf(u.author)>-1))x++;return w>2&&x>=w-1};j=babelHelpers.inherits(s,c("React").Component);k=j&&j.prototype;function s(){var t,u;"use strict";for(var v=arguments.length,w=Array(v),x=0;x<v;x++)w[x]=arguments[x];return u=(t=k.constructor).call.apply(t,[this].concat(w)),this.state={seenTimestamp:null,seenByData:null},u}s.getDerivedStateFromProps=function(t,u){"use strict";return q(t.readReceipts,t.threadID,t.lastMessage)};s.prototype.shouldComponentUpdate=function(t,u){"use strict";__p&&__p();if(t.threadID!==this.props.threadID||t.lastMessage!==this.props.lastMessage||t.isTyping!==this.props.isTyping||u.seenTimestamp!==this.state.seenTimestamp)return true;var v=this.state.seenByData,w=u.seenByData;if(!v&&!w)return false;if(!v||!w)return true;if(v.seenByAll!==w.seenByAll||v.showTooltip!==w.showTooltip||v.text!==w.text)return true;if(!m(v.seenBy).equals(m(w.seenBy)))return true;return false};s.prototype.componentDidUpdate=function(){"use strict";if(!this.isVisible())return;this.props.indicatorDidShow&&this.props.indicatorDidShow()};s.prototype.componentWillUnmount=function(){"use strict";this.$MercuryLastMessageIndicator1&&this.$MercuryLastMessageIndicator1.release()};s.prototype.$MercuryLastMessageIndicator2=function(){"use strict";if(!this.props.lastMessage)return[];return this.props.lastMessage.source_tags||this.props.lastMessage.tags||[]};s.prototype.render=function(){"use strict";if(this.props.isTyping)return c("React").createElement("div",{className:this.$MercuryLastMessageIndicator3([])},c("React").createElement("div",{className:"_510h"}),c("React").createElement("span",{className:"_510f",ref:"text"},"\xa0"));var t=this.$MercuryLastMessageIndicator2(),u=this.state.seenByData,v=this.state.seenTimestamp;if(u)return c("React").createElement("div",{className:this.$MercuryLastMessageIndicator3(t)},c("React").createElement("div",{className:"_510h"}),c("React").createElement("span",{className:"_510f"},this.$MercuryLastMessageIndicator4(u)));else if(v)return c("React").createElement("div",{className:this.$MercuryLastMessageIndicator3(t)},c("React").createElement("div",{className:"_510h"}),c("React").createElement("span",{className:"_510f",ref:"text"},this.$MercuryLastMessageIndicator5(v)));else return c("React").createElement("div",{className:this.$MercuryLastMessageIndicator3(t)},c("React").createElement("div",{className:"_510h"}),c("React").createElement("span",{className:"_510f",ref:"text"},this.$MercuryLastMessageIndicator6(t)))};s.prototype.$MercuryLastMessageIndicator5=function(t){"use strict";var u=Date.now()*.001,v=void 0;if(t<u-518400)v="M j";else if(t<u-86400)v="D g:ia";else v="g:ia";return i._("Seen {timestamp}",[i._param("timestamp",c("formatDate")(t,v))])};s.prototype.$MercuryLastMessageIndicator6=function(t){"use strict";__p&&__p();if(t.includes(c("MercuryMessageSourceTags").MESSENGER))if(!c("WorkModeConfig").is_work_user)return c("React").createElement("a",{href:"/mobile/messenger",className:"fcg",target:"_blank"},i._("Sent from Messenger"));else return c("React").createElement("a",{href:"https://www.facebook.com/workplace/mobile/",className:"fcg",target:"_blank"},i._("Sent from Workplace Chat"));else if(t.includes(c("MercuryMessageSourceTags").MOBILE)){var u=c("WorkModeConfig").is_work_user?"/workplace/mobile":"/mobile";return c("React").createElement("a",{href:u,className:"fcg",target:"_blank"},i._("Sent from Mobile"))}else if(t.includes(c("MercuryMessageSourceTags").EMAIL))return c("React").createElement("span",null,i._("Sent from email"));return null};s.prototype.$MercuryLastMessageIndicator3=function(t){"use strict";__p&&__p();var u=this.props.lastMessage&&this.props.lastMessage.author&&c("MercuryViewer").isViewer(this.props.lastMessage.author),v="_510g"+(u?" _510e":""),w=null;if(this.props.isTyping)w=null;else if(this.state.seenByData!==null||this.state.seenTimestamp!==null)w="seen";else if(t.includes(c("MercuryMessageSourceTags").MESSENGER)||t.includes(c("MercuryMessageSourceTags").MOBILE))w="sentFromMobile";else if(t.includes(c("MercuryMessageSourceTags").EMAIL))w="sentFromEmail";return c("joinClasses")(v,w)};s.prototype.isVisible=function(){"use strict";var t=this.$MercuryLastMessageIndicator2();if(t.includes(c("MercuryMessageSourceTags").MESSENGER)||t.includes(c("MercuryMessageSourceTags").MOBILE)||t.includes(c("MercuryMessageSourceTags").EMAIL))return true;return this.state.seenTimestamp!==null||this.state.seenByData!==null};s.prototype.$MercuryLastMessageIndicator4=function(t){"use strict";__p&&__p();var u=t.seenByAll;if(u)return i._("Seen by everyone");var v=t.text;if(!v)return null;var w=c("React").createElement(c("MessengerTextWithEmoticons.react"),{renderEmoji:true,renderEmoticons:true,text:v}),x=t.showTooltip;if(!x)return i._("Seen by {names}",[i._param("names",w)]);else{var y=this.$MercuryLastMessageIndicator7(t);return i._("Seen by {names}{=num more link}",[i._param("names",w),i._param("=num more link",y)])}};s.prototype.$MercuryLastMessageIndicator7=function(t){"use strict";__p&&__p();if(!t.text||!t.showTooltip)return null;var u={},v=0,w=null;c("MercuryParticipants").getMulti(t.seenBy,function(y){w=t.seenBy.map(function(z){return y[z].name}).join("\r\n");v=Object.keys(y).length-2});u=Object.assign({"data-tooltip-alignh":"center"},c("TooltipData").propsFor(w,"above"));var x=i._({"*":"{num} more"},[i._param("num",v,[0])]);return c("React").createElement("span",babelHelpers["extends"]({className:"more"},u),x)};s.propTypes={indicatorDidShow:n.func,lastMessage:n.object,threadID:n.string.isRequired,isTyping:n.bool.isRequired};s.defaultProps={indicatorDidShow:c("emptyFunction")};f.exports=s}),null);
__d("MercuryQuickReply.react",["cx","BootloadedComponent.react","JSResource","MercuryIDs","MessengerQuickCamOrigins","MessengerViewerContactMethodsWebGraphQLQuery","React","WebGraphQL","XUISpinner.react","gkx","idx"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").PureComponent);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={viewerEmail:null,viewerPhone:null},n}l.prototype.componentDidMount=function(){if(this.$MercuryQuickReply1(this.props.lastMessage)!==null)this.props.quickReplyDidShow()};l.prototype.componentDidUpdate=function(m){if(this.$MercuryQuickReply1(this.props.lastMessage)!==null&&this.$MercuryQuickReply1(m.lastMessage)===null)this.props.quickReplyDidShow();this.$MercuryQuickReply2(this.props.lastMessage)};l.prototype.render=function(){__p&&__p();var m=this.props.lastMessage,n=c("MercuryIDs").getParticipantIDFromUserID(this.props.viewer);if(!m||m.author===n)return null;var o=this.$MercuryQuickReply1(m);if(Array.isArray(o)){var p=o.every(function(q){return q.content_type==="user_email"&&this.state.viewerEmail===null||q.content_type==="user_phone_number"&&this.state.viewerPhone===null}.bind(this));if(!p)return c("React").createElement("div",{className:"_419m"},c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("MessengerBotsQuickReplyButtonList.react").__setRef("MercuryQuickReply.react"),bootloadPlaceholder:c("React").createElement(c("XUISpinner.react"),{className:"_5h-9"}),isSponsored:m.is_sponsored,messageId:m.message_id,options:o,pageId:c("MercuryIDs").getUserIDFromParticipantID(m.author),threadID:m.thread_id,quickCamOriginLocation:this.props.quickCamOriginLocation,viewer:this.props.viewer,viewerEmail:this.state.viewerEmail,viewerPhone:this.state.viewerPhone}))}return null};l.prototype.$MercuryQuickReply1=function(m){var n=m&&m.platform_xmd&&JSON.parse(m.platform_xmd);return Array.isArray(n&&n.quick_replies)?n&&n.quick_replies:null};l.prototype.$MercuryQuickReply2=function(m){__p&&__p();var n=this.$MercuryQuickReply1(m);if(!n||n.length===0)return;if(n.some(function(o){return o.content_type==="user_email"||o.content_type==="user_phone_number"}))c("WebGraphQL").exec(new(c("MessengerViewerContactMethodsWebGraphQLQuery"))({})).done(function(o){var p,q,r,s,t=(p=o)!=null?(p=p.viewer)!=null?(p=p.user)!=null?p.all_phones:p:p:p,u=(q=o)!=null?(q=q.viewer)!=null?q.all_emails:q:q,v=!t?null:t.find(function(x){return x.is_preferred});if(!v&&t)v=t[0];var w=!u?null:u.find(function(x){return x.is_primary});this.setState({viewerEmail:(r=w)!=null?r.display_email:r,viewerPhone:(s=v)!=null?(s=s.phone_number)!=null?s.universal_number:s:s})}.bind(this))};l.propTypes={quickReplyDidShow:k.func.isRequired,lastMessage:k.object,quickCamOriginLocation:k.oneOf(c("MessengerQuickCamOrigins").getValues()).isRequired,threadID:k.string.isRequired,viewer:k.string.isRequired};f.exports=l}),null);
__d("FantaConversationScroller.react",["cx","fbt","Animation","Arbiter","BootloadedComponent.react","Bootloader","ChatTypingIndicatorsWrapper.react","CurrentUser","Event","FantaConversation.react","FantaPageGreetingLoader.react","FantaTabActions","Grid.react","immutable","JSResource","MercuryLastMessageIndicator.react","MercuryAttachment","MercuryCamQuickReply.react","MercuryConfig","MercuryIDs","MercuryQuickReply.react","MercuryThreads","MessengerHotLikePreviewEvents","MessengerQuickCamOrigins","MessengerVideoAutoplayActions","MessengerVideoAutoplayStore","React","ReactDOM","MercuryShareAttachmentRenderLocations","Scroll","ScrollBoundaryContain","Style","SubscriptionsHandler","TimeSlice","XUISpinner.react","clearImmediate","emptyFunction","getElementPosition","getPageIDFromThreadID","gkx","isEventSupported","setImmediate","setTimeoutAcrossTransitions","clearTimeout","throttle"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("MercuryThreads").get(),m=c("Grid.react").GridItem,n=c("React").PropTypes,o=15,p=null,q=20,r=1e3,s=100;function t(v){__p&&__p();if(p===null){var w=v.firstElementChild;if(w){c("Style").set(v,"overflow","scroll");var x=w.clientWidth;c("Style").set(v,"overflow","hidden");var y=w.clientWidth;p=Math.max(y-x,0);c("Style").set(v,"overflow","")}else p=0}return p}j=babelHelpers.inherits(u,c("React").Component);k=j&&j.prototype;function u(v){__p&&__p();k.constructor.call(this,v);this.$FantaConversationScroller9=[];this.state={loadingMessages:!l.isEmptyLocalThread(this.props.threadID),scrollbarPadding:p===null?o:p,hideLastMessageIndicator:false};this.$FantaConversationScroller21=function(w){__p&&__p();var x=c("ReactDOM").findDOMNode(this.refs.scrollContainer);if(x){this.$FantaConversationScroller22();if(this.$FantaConversationScroller23()&&!this.$FantaConversationScroller24()&&!this.$FantaConversationScroller3&&!this.props.hasFetchedAll){this.setState({loadingMessages:true});this.props.onLoadMoreMessages()}this.$FantaConversationScroller25();this.$FantaConversationScroller12()}}.bind(this);this.$FantaConversationScroller17=function(){__p&&__p();if(!this.refs||this.state.loadingMessages||!this.props.thread){this.$FantaConversationScroller9=[];return}var w=c("ReactDOM").findDOMNode(this.refs.scrollContainer),x=c("getPageIDFromThreadID")(this.props.threadID);if(!w||!x){this.$FantaConversationScroller9=[];return}var y=10,z=void 0,A=void 0;try{z=w.getBoundingClientRect();A=this.refs.conversation?this.refs.conversation.getMessageList():null}catch(B){return}if(!A||!z)return;var C=[];this.$FantaConversationScroller8.forEach(function(D){__p&&__p();if(!A)return;var E=D.message_id,F=A.getMessageElement(E);if(F){var G=F.getBoundingClientRect();if(G.top>z.top-y&&G.bottom<z.bottom+y){C.push(E);if(!this.$FantaConversationScroller9.includes(E))c("Bootloader").loadModules(["MessengerAdsWebLogger","MNAdsLoggerEventEnum"],function(H,I){H.log(D.ad_client_token,D.ad_id,I.MESSAGE_SEEN_THREAD,true,E,x)},"FantaConversationScroller.react")}}}.bind(this),this);this.$FantaConversationScroller9=C}.bind(this);this.$FantaConversationScroller26=function(){__p&&__p();if(this.$FantaConversationScroller11){c("clearTimeout")(this.$FantaConversationScroller11);delete this.$FantaConversationScroller11}var w=this.$FantaConversationScroller10;if(this.$FantaConversationScroller24()){this.$FantaConversationScroller27(false);this.$FantaConversationScroller10=true}else this.$FantaConversationScroller10=false;if(w!==this.$FantaConversationScroller10)c("FantaTabActions").scrollBottomChanged(this.props.threadID,this.$FantaConversationScroller10,this.$FantaConversationScroller28)}.bind(this);this.$FantaConversationScroller29=function(){if(this.$FantaConversationScroller11)c("clearTimeout")(this.$FantaConversationScroller11);this.$FantaConversationScroller11=c("setTimeoutAcrossTransitions")(this.$FantaConversationScroller26,s)}.bind(this);this.$FantaConversationScroller30=function(){this.$FantaConversationScroller1=null;c("FantaTabActions").scrollBottomChanged(this.props.threadID,this.$FantaConversationScroller6,this.$FantaConversationScroller28)}.bind(this);this.$FantaConversationScroller28=function(){if(c("gkx")("AT5Tksg1z1eIa6YmOH92o0v-zwCN16C1uxMcqW4ABgK3zj0WXDYLwN8d-MFrMPsR3UdYLnPnjw9H3yKbwAuQAAWx"))this.$FantaConversationScroller18();else{this.$FantaConversationScroller27(false);this.$FantaConversationScroller19()}}.bind(this);this.$FantaConversationScroller10=true;this.$FantaConversationScroller6=true}u.prototype.shouldComponentUpdate=function(v,w){var x=this.props,y=this.state;return!x.onlineUsers.equals(v.onlineUsers)||x.hasFetchedAll!==v.hasFetchedAll||x.isFocused!==v.isFocused||!x.messages.equals(v.messages)||x.showContextBanner!==v.showContextBanner||x.thread!==v.thread||x.threadID!==v.threadID||y.loadingMessages!==w.loadingMessages||y.hideLastMessageIndicator!==w.hideLastMessageIndicator};u.prototype.componentDidMount=function(){__p&&__p();this.$FantaConversationScroller7=new(c("SubscriptionsHandler"))();this.$FantaConversationScroller13();this.$FantaConversationScroller14();if(!c("gkx")("AT5Tksg1z1eIa6YmOH92o0v-zwCN16C1uxMcqW4ABgK3zj0WXDYLwN8d-MFrMPsR3UdYLnPnjw9H3yKbwAuQAAWx"))this.$FantaConversationScroller15();c("MessengerVideoAutoplayActions").updateStore(this.props.threadID,this.$FantaConversationScroller16());this.setState({scrollbarPadding:t(this.refs.scrollContainer)});this.$FantaConversationScroller12=c("throttle")(this.$FantaConversationScroller17,r);this.$FantaConversationScroller8=this.props.messages.filter(function(v){return v.is_sponsored});this.$FantaConversationScroller12()};u.prototype.componentDidUpdate=function(v){__p&&__p();if(!c("gkx")("AT5Tksg1z1eIa6YmOH92o0v-zwCN16C1uxMcqW4ABgK3zj0WXDYLwN8d-MFrMPsR3UdYLnPnjw9H3yKbwAuQAAWx"))this.$FantaConversationScroller15();if(this.$FantaConversationScroller3){var w=c("ReactDOM").findDOMNode(this.refs.scrollContainer),x=this.$FantaConversationScroller3||0,y=w.scrollHeight-x;this.scrollToPosition(y,false);this.$FantaConversationScroller3=null}if(!v.messages.equals(this.props.messages)){c("MessengerVideoAutoplayActions").updateStore(this.props.threadID,this.$FantaConversationScroller16());var z=v.messages.last(),A=this.props.messages.last();if(z!==A&&A&&A.author){var B=c("MercuryIDs").getUserIDFromParticipantID(A.author);if(B===c("CurrentUser").getID())if(c("gkx")("AT5Tksg1z1eIa6YmOH92o0v-zwCN16C1uxMcqW4ABgK3zj0WXDYLwN8d-MFrMPsR3UdYLnPnjw9H3yKbwAuQAAWx"))this.$FantaConversationScroller18();else{this.scrollToBottom(false);this.$FantaConversationScroller19()}}}this.$FantaConversationScroller12();if(c("gkx")("AT5Tksg1z1eIa6YmOH92o0v-zwCN16C1uxMcqW4ABgK3zj0WXDYLwN8d-MFrMPsR3UdYLnPnjw9H3yKbwAuQAAWx"))this.$FantaConversationScroller20()};u.prototype.componentWillUnmount=function(){this.$FantaConversationScroller1&&c("clearImmediate")(this.$FantaConversationScroller1);this.$FantaConversationScroller7.release()};u.prototype.UNSAFE_componentWillReceiveProps=function(v){var w=this.state.loadingMessages&&v.messages.size>0&&!v.messages.equals(this.props.messages);if(w||v.hasFetchedAll||v.showContextBanner){this.setState({loadingMessages:false});var x=c("ReactDOM").findDOMNode(this.refs.scrollContainer),y=x.scrollHeight,z=c("Scroll").getTop(x);this.$FantaConversationScroller3=y-z}this.$FantaConversationScroller8=v.messages.filter(function(A){return A.is_sponsored})};u.prototype.$FantaConversationScroller15=function(){var v=arguments.length<=0||arguments[0]===undefined?false:arguments[0];if(this.$FantaConversationScroller6)c("TimeSlice").guard(function(){this.scrollToBottom(v)}.bind(this),"post load chat animations",{propagationType:c("TimeSlice").PropagationType.ORPHAN})()};u.prototype.renderGroupWave=function(){var v=this.props.thread;if(c("MercuryIDs").isLocalThread(this.props.threadID)&&c("gkx")("AT7uCGaYk4KWBCIq3SurfBIwk1DjmbU_QXgSqcY73Sdnw3DJhbzA4qigZjhm4wwYtWnHVZcxghHN6RO33C1W8YjG")&&v&&!v.is_canonical&&!v.thread_fbid)return c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement(c("XUISpinner.react"),{background:"light",className:"loading",size:"small"}),bootloadLoader:c("JSResource")("ChatWaveImage.react").__setRef("FantaConversationScroller.react"),thread:v});return null};u.prototype.$FantaConversationScroller25=function(){__p&&__p();var v=this.props.threadID,w=c("ReactDOM").findDOMNode(this.refs.scrollContainer);if(!w)return;var x=void 0,y=void 0;try{x=w.getBoundingClientRect();y=this.refs.conversation?this.refs.conversation.getMessageList():null}catch(z){return}if(!y||!x)return;var A=[],B=c("MessengerVideoAutoplayStore").getMessageIDs(v),C=B||this.$FantaConversationScroller16()||c("immutable").List();C.map(function(D){var E=c("MercuryAttachment").getVideoElem(D,y);if(E)A.push([D,E.getBoundingClientRect()])});if(A.length)c("MessengerVideoAutoplayActions").onScroll(v,B?null:C,c("immutable").Map(A),x)};u.prototype.$FantaConversationScroller16=function(){return this.props.messages.filter(function(v){return c("MercuryAttachment").isSingleVideoAttachment(v)||c("MercuryAttachment").isSharedVideoAttachmentMessage(v)}).reverse().map(function(v){return v.message_id})};u.prototype.scrollToBottom=function(v){var w=c("ReactDOM").findDOMNode(this.refs.scrollContainer);if(w)this.scrollToPosition(w.scrollHeight,v)};u.prototype.scrollToPosition=function(v,w){var x=c("ReactDOM").findDOMNode(this.refs.scrollContainer);this.$FantaConversationScroller5&&this.$FantaConversationScroller5.stop();if(w)this.$FantaConversationScroller5=new(c("Animation"))(x).to("scrollTop",v).ease(c("Animation").ease.end).duration(400).go();else c("Scroll").setTop(x,v)};u.prototype.$FantaConversationScroller24=function(v){var w=c("ReactDOM").findDOMNode(this.refs.scrollContainer);v=v===0?0:v||q;return c("Scroll").getTop(w)+w.clientHeight>=w.scrollHeight-v};u.prototype.$FantaConversationScroller23=function(){var v=c("ReactDOM").findDOMNode(this.refs.scrollContainer);return c("Scroll").getTop(v)<v.clientHeight};u.prototype.$FantaConversationScroller18=function(){if(this.$FantaConversationScroller11){c("clearTimeout")(this.$FantaConversationScroller11);delete this.$FantaConversationScroller11}if(this.$FantaConversationScroller24(0)){this.$FantaConversationScroller27(false);this.$FantaConversationScroller10=true}};u.prototype.$FantaConversationScroller20=function(){if(this.$FantaConversationScroller11)this.$FantaConversationScroller26();if(this.$FantaConversationScroller10)this.$FantaConversationScroller27(false)};u.prototype.$FantaConversationScroller19=function(){var v=this.$FantaConversationScroller6;if(this.$FantaConversationScroller24())this.$FantaConversationScroller6=true;else this.$FantaConversationScroller6=false;if(v!==this.$FantaConversationScroller6)this.$FantaConversationScroller1=c("setImmediate")(this.$FantaConversationScroller30)};u.prototype.$FantaConversationScroller13=function(){__p&&__p();var v,w=this,x=c("ReactDOM").findDOMNode(this.refs.scrollContainer);if(!x)return;if(c("gkx")("AT5Tksg1z1eIa6YmOH92o0v-zwCN16C1uxMcqW4ABgK3zj0WXDYLwN8d-MFrMPsR3UdYLnPnjw9H3yKbwAuQAAWx"))this.$FantaConversationScroller7.addSubscriptions(c("Event").listen(x,"click",this.$FantaConversationScroller29),c("Event").listen(x,"contextmenu",this.$FantaConversationScroller29),c("Event").listen(x,"doubleclick",this.$FantaConversationScroller29),c("Event").listen(x,"drag",this.$FantaConversationScroller29),c("Event").listen(x,"dragend",this.$FantaConversationScroller29),c("Event").listen(x,"dragenter",this.$FantaConversationScroller29),c("Event").listen(x,"dragexit",this.$FantaConversationScroller29),c("Event").listen(x,"dragleave",this.$FantaConversationScroller29),c("Event").listen(x,"dragover",this.$FantaConversationScroller29),c("Event").listen(x,"dragstart",this.$FantaConversationScroller29),c("Event").listen(x,"drop",this.$FantaConversationScroller29),c("Event").listen(x,"mousedown",this.$FantaConversationScroller29),c("Event").listen(x,"mouseenter",this.$FantaConversationScroller29),c("Event").listen(x,"mouseleave",this.$FantaConversationScroller29),c("Event").listen(x,"mousemove",this.$FantaConversationScroller29),c("Event").listen(x,"mouseout",this.$FantaConversationScroller29),c("Event").listen(x,"mouseover",this.$FantaConversationScroller29),c("Event").listen(x,"mouseup",this.$FantaConversationScroller29),c("Event").listen(x,"touchcancel",this.$FantaConversationScroller29),c("Event").listen(x,"touchend",this.$FantaConversationScroller29),c("Event").listen(x,"touchmove",this.$FantaConversationScroller29),c("Event").listen(x,"touchstart",this.$FantaConversationScroller29),c("Event").listen(x,"scroll",this.$FantaConversationScroller29),c("Event").listen(x,"wheel",this.$FantaConversationScroller29),c("Event").listen(x,"mousewheel",this.$FantaConversationScroller29),c("Event").listen(x,"DOMMouseScroll",this.$FantaConversationScroller29));else(function(){var z=c("isEventSupported")("mousewheel")?"mousewheel":c("isEventSupported")("wheel")?"wheel":"DOMMouseScroll",A=function(){this.$FantaConversationScroller19()}.bind(w),B=function B(){x.addEventListener(z,A,{passive:true})},C=function C(){x.removeEventListener(z,A,{passive:true})};w.$FantaConversationScroller7.addSubscriptions(c("Arbiter").subscribe("overflow-applied-to-body",function(){return this.$FantaConversationScroller15()}.bind(w)),c("Event").listen(x,"mousedown",A),c("Event").listen(x,"mouseup",A),c("Event").listen(x,"mouseenter",B),c("Event").listen(x,"mouseleave",C),{cancel:C},c("Event").listen(x,"scroll",c("throttle")(w.$FantaConversationScroller21,50)))})();var y=c("ScrollBoundaryContain").applyToElem(x);if(y)this.$FantaConversationScroller7.addSubscriptions(y)};u.prototype.$FantaConversationScroller14=function(){__p&&__p();this.$FantaConversationScroller7.addSubscriptions(c("MessengerHotLikePreviewEvents").addListener(c("MessengerHotLikePreviewEvents").START,function(v,w){if(this.props.threadID===w){if(c("gkx")("AT5Tksg1z1eIa6YmOH92o0v-zwCN16C1uxMcqW4ABgK3zj0WXDYLwN8d-MFrMPsR3UdYLnPnjw9H3yKbwAuQAAWx"))this.$FantaConversationScroller18();else this.$FantaConversationScroller27(false);clearInterval(this.$FantaConversationScroller4);this.$FantaConversationScroller4=setInterval(function(){this.$FantaConversationScroller27(false)}.bind(this),50)}}.bind(this)),c("MessengerHotLikePreviewEvents").addListener(c("MessengerHotLikePreviewEvents").FINISH_ANIMATION,function(v){clearInterval(this.$FantaConversationScroller4)}.bind(this)),c("MessengerHotLikePreviewEvents").addListener(c("MessengerHotLikePreviewEvents").FINISH_EMOJI_ANIMATION,function(v){clearInterval(this.$FantaConversationScroller4)}.bind(this)),c("MessengerHotLikePreviewEvents").addListener(c("MessengerHotLikePreviewEvents").REMOVE,function(v){if(this.props.threadID===v)clearInterval(this.$FantaConversationScroller4)}.bind(this)))};u.prototype.render=function(){__p&&__p();var v=this.props,w=v.hasFetchedAll,x=v.messages,y=v.showContextBanner,z=v.thread,A=v.threadID,B=c("CurrentUser").getID(),C=c("gkx")("AT572SLwCLmZDDTsXg5I9LZsOQ15AFaFyPW6mF-2-OPcT86erU7KYs2R9o67DUyJwQ6AK0Y7upy2o2--jlRi_7EZ"),D=C&&(l.isEmptyLocalThread(A)||w||y),E=!c("MercuryConfig").ChatSeenHeadsEnabled,F=this.state.loadingMessages||!z?c("React").createElement(c("XUISpinner.react"),{background:"light",className:"loading",size:"small"}):null,G=function(){return this.$FantaConversationScroller15()}.bind(this);return c("React").createElement("div",{className:"_2v5j"},c("React").createElement("div",{className:"fbNubFlyoutBody scrollable",onClick:function(H){if(H.target&&H.target.classList&&H.target.classList.contains("_5wd4"))this.props.onFocus&&this.props.onFocus()}.bind(this),ref:"scrollContainer",role:"button",tabIndex:"0"},c("React").createElement("div",{className:"fbNubFlyoutBodyContent"},c("React").createElement(c("FantaPageGreetingLoader.react"),{thread:z,threadID:A}),c("React").createElement(c("Grid.react"),{className:"conversationContainer",role:"log",cols:1},c("React").createElement(m,{alignv:"bottom"},c("React").createElement("div",{className:"accessible_elem"},i._("Chat conversation start")),D?c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("div",null),bootloadLoader:c("JSResource")("MessengerContextBannerContainer.react").__setRef("FantaConversationScroller.react"),isContinuation:false,location:c("MercuryShareAttachmentRenderLocations").CHAT,viewer:B,threadID:A}):null,F,c("React").createElement("div",{style:x.size>0?{height:"176px"}:F?{height:"168px"}:{height:"192px"}},c("React").createElement(c("FantaConversation.react"),babelHelpers["extends"]({onAttachmentLoad:G,scrollbarPadding:this.state.scrollbarPadding,ref:"conversation"},this.props)),c("gkx")("AT7Fdvvof3gB21NGh8Fo7o5af68El03cTnUDtqQrI_yHQbziWN3MyQvvj6iMavHBZ0fTg3S3rpHTM9337zgjjUnM")?c("React").createElement(c("MercuryCamQuickReply.react"),{camQuickReplyWillShow:c("emptyFunction"),camQuickReplyDidShow:function(){return this.$FantaConversationScroller15(true)}.bind(this),lastMessage:x.size>0?x.last():undefined,threadID:A,viewer:B}):null,c("React").createElement(c("MercuryQuickReply.react"),{lastMessage:x.size>0?x.last():undefined,threadID:A,quickReplyDidShow:function(){return this.$FantaConversationScroller15(true)}.bind(this),viewer:B,quickCamOriginLocation:c("MessengerQuickCamOrigins").CHAT_TAB}),c("React").createElement(c("ChatTypingIndicatorsWrapper.react"),{threadID:A,indicatorClass:undefined,indicatorsWillShow:c("emptyFunction"),indicatorsDidShow:function(){return this.setState({hideLastMessageIndicator:true},function(){if(c("gkx")("AT5Tksg1z1eIa6YmOH92o0v-zwCN16C1uxMcqW4ABgK3zj0WXDYLwN8d-MFrMPsR3UdYLnPnjw9H3yKbwAuQAAWx"))this.$FantaConversationScroller20();else this.$FantaConversationScroller15(true)}.bind(this))}.bind(this),indicatorsDidHide:function(){return this.setState({hideLastMessageIndicator:false})}.bind(this),rootClassName:undefined,viewer:B,onlineUsers:this.props.onlineUsers}),this.renderGroupWave(),E?c("React").createElement(c("MercuryLastMessageIndicator.react"),{isTyping:this.state.hideLastMessageIndicator,indicatorDidShow:function(){if(c("gkx")("AT5Tksg1z1eIa6YmOH92o0v-zwCN16C1uxMcqW4ABgK3zj0WXDYLwN8d-MFrMPsR3UdYLnPnjw9H3yKbwAuQAAWx"))this.$FantaConversationScroller20();else this.$FantaConversationScroller15(true)}.bind(this),indicatorWillShow:c("emptyFunction"),lastMessage:x.size>0?x.last():null,readReceipts:this.props.readReceipts,threadID:A}):null),c("React").createElement("div",{className:"accessible_elem"},i._("Chat conversation end")))))))};u.prototype.$FantaConversationScroller22=function(){var v=c("ReactDOM").findDOMNode(this.refs.scrollContainer),w=c("getElementPosition")(v);c("Arbiter").inform("chatScrolled/"+this.props.threadID,{scrollTop:c("Scroll").getTop(v),top:w.y,viewHeight:w.height})};u.prototype.$FantaConversationScroller27=function(v){var w=c("ReactDOM").findDOMNode(this.refs.scrollContainer);if(w)this.$FantaConversationScroller31(w.scrollHeight,v)};u.prototype.$FantaConversationScroller31=function(v,w){var x=c("ReactDOM").findDOMNode(this.refs.scrollContainer);this.$FantaConversationScroller5&&this.$FantaConversationScroller5.stop();if(w===true)this.$FantaConversationScroller5=new(c("Animation"))(x).to("scrollTop",v).ease(c("Animation").ease.end).duration(400).go();else c("Scroll").setTop(x,v)};u.propTypes={hasFetchedAll:n.bool.isRequired,isFocused:n.bool.isRequired,messages:n.object.isRequired,onFocus:n.func,onLoadMoreMessages:n.func.isRequired,onlineUsers:n.instanceOf(c("immutable").List).isRequired,showContextBanner:n.bool,thread:n.object,threadID:n.string.isRequired};f.exports=u}),null);
__d("FantaDragAndDropRow.react",["cx","fbt","ix","Bootloader","Image.react","MessengerEnvironment","MercuryAttachment","React","XUICloseButton.react","XUISpinner.react","emptyFunction","ifRequired","joinClasses"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l;k=babelHelpers.inherits(m,c("React").Component);l=k&&k.prototype;function m(){__p&&__p();var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=l.constructor).call.apply(n,[this].concat(q)),this.$FantaDragAndDropRow1=function(){var s=this.props,t=s.threadID,u=s.fileData;c("MessengerEnvironment").messengerui?c("ifRequired")("MessengerActions",function(v){v.cancelFileUpload(t,u.id)},function(){c("Bootloader").loadModules(["MessengerActions"],function(v){v.cancelFileUpload(t,u.id)},"FantaDragAndDropRow.react")}):c("ifRequired")("FantaMessageActions",function(v){v.cancelFileUpload(t,u.id)},function(){c("Bootloader").loadModules(["FantaMessageActions"],function(v){v.cancelFileUpload(t,u.id)},"FantaDragAndDropRow.react")})}.bind(this),o}m.prototype.componentDidMount=function(){c("MessengerEnvironment").messengerui?c("Bootloader").loadModules(["MessengerActions"],c("emptyFunction"),"FantaDragAndDropRow.react"):c("Bootloader").loadModules(["FantaMessageActions"],c("emptyFunction"),"FantaDragAndDropRow.react")};m.prototype.render=function(){var n=this.props,o=n.fileData,p=n.isUploaded,q=o.file,r="";if(q.type)r=c("MercuryAttachment").getAttachIconClassByMime(q.type);var s=c("joinClasses")(r,"_3tn"),t=p?"done":"",u=c("joinClasses")(t,"_2qh _2qe uploadFileRow");return c("React").createElement("div",{className:u},c("React").createElement(c("XUISpinner.react"),{className:"_2qf"}),c("React").createElement(c("XUICloseButton.react"),{"aria-label":i._("Remove file"),className:"_2qg",shade:"dark",size:"small",onClick:this.$FantaDragAndDropRow1}),c("React").createElement("div",{className:"_4-te"},c("React").createElement("span",{className:s},c("React").createElement(c("Image.react"),{src:j("86988")})),q.name))};f.exports=m}),null);
__d("FantaDragAndDrop.react",["Bootloader","BootloadOnRender.react","FantaDragAndDropRow.react","FantaTypeComposer","JSResource","LazyComponent.react","MercuryShareAttachmentRenderLocations","MessengerEnvironment","React","emptyFunction","gkx","ifRequired"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=960,k=c("React").PropTypes;h=babelHelpers.inherits(l,c("React").Component);i=h&&h.prototype;function l(){__p&&__p();var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=i.constructor).call.apply(m,[this].concat(p)),this.$FantaDragAndDrop3=function(r){var s=this.props.composer;this.$FantaDragAndDrop7(function(t){t.removeSharePreview(r,s)})}.bind(this),this.$FantaDragAndDrop4=function(r,s){var t=this.props.composer;this.$FantaDragAndDrop7(function(u){u.loadedShareData(r,s,t)})}.bind(this),this.$FantaDragAndDrop5=function(r){var s=this.props.composer;this.$FantaDragAndDrop7(function(t){t.loadingShareData(r,s)})}.bind(this),n}l.prototype.componentDidMount=function(){c("MessengerEnvironment").messengerui?c("Bootloader").loadModules(["MessengerActions"],c("emptyFunction"),"FantaDragAndDrop.react"):c("Bootloader").loadModules(["FantaMessageActions"],c("emptyFunction"),"FantaDragAndDrop.react")};l.prototype.shouldComponentUpdate=function(m){var n=this.props,o=n.composer,p=m.composer,q=o.fileUploader,r=q.uploadingFiles,s=q.uploadedFiles,t=p.fileUploader.uploadingFiles,u=p.fileUploader.uploadedFiles,v=o.sharePreview,w=p.sharePreview;return n.threadID!==m.threadID||!!(!r&&t)||!!(r&&t&&!r.equals(t))||!!(!s&&u)||!!(s&&u&&!s.equals(u))||!!(!v&&w)||!!(v&&w&&!v.equals(w))};l.prototype.render=function(){var m=this.props,n=m.composer,o=m.threadID,p=n.sharePreview,q=p.share,r=p.uri,s=n.fileUploader,t=s.uploadingFiles,u=s.uploadedFiles;return c("React").createElement("div",{className:"fbNubFlyoutAttachments"},c("React").createElement("div",{className:"chatAttachmentShelf"},q||r?c("React").createElement(c("BootloadOnRender.react"),{loader:c("JSResource")("MercurySharePreview.react").__setRef("FantaDragAndDrop.react"),placeholder:c("React").createElement("div",null),component:c("React").createElement(c("LazyComponent.react"),{onClose:this.$FantaDragAndDrop3,onLoaded:this.$FantaDragAndDrop4,onLoading:this.$FantaDragAndDrop5,threadID:o,imageSize:{width:j,height:j},location:c("MercuryShareAttachmentRenderLocations").CHAT_PREVIEW,share:q,uri:r})}):null,!c("gkx")("AT5V6GuV7OE1f4CNmq1NUhZOeDrgnZF-AQ7WoOvZA8jFMJsYzyghwU79Bm31vgH-mi9DAlUGSFnfYvhwjhMfTolYEEzHhgUrhLD2UxTqbooHHw")&&c("React").createElement("div",{ref:function(v){this.$FantaDragAndDrop1=v}.bind(this)},this.$FantaDragAndDrop6(t,false),this.$FantaDragAndDrop6(u,true))))};l.prototype.$FantaDragAndDrop7=function(m){c("MessengerEnvironment").messengerui?c("ifRequired")("MessengerActions",function(n){m(n)},function(){c("Bootloader").loadModules(["MessengerActions"],function(n){m(n)},"FantaDragAndDrop.react")}):c("ifRequired")("FantaMessageActions",function(n){m(n)},function(){c("Bootloader").loadModules(["FantaMessageActions"],function(n){m(n)},"FantaDragAndDrop.react")})};l.prototype.$FantaDragAndDrop6=function(m,n){var o=this.props.threadID;return m&&m.map(function(p){return c("React").createElement(c("FantaDragAndDropRow.react"),{fileData:p,isUploaded:n,key:n?"uped-"+p.id:"uping-"+p.id,threadID:o})}).toArray()};l.propTypes={composer:k.object.isRequired,threadID:k.string.isRequired};f.exports=l}),null);
__d("FantaMercuryTabOverflowBootloader.react",["BootloadOnRender.react","JSResource","LazyComponent.react","React"],(function a(b,c,d,e,f,g){"use strict";var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;j.prototype.render=function(){return c("React").createElement(c("BootloadOnRender.react"),{component:c("React").createElement(c("LazyComponent.react"),{items:this.props.items}),loader:c("JSResource")("FantaMercuryTabOverflow.react").__setRef("FantaMercuryTabOverflowBootloader.react"),placeholder:c("React").createElement("div",null)})};function j(){h.apply(this,arguments)}f.exports=j}),null);
__d("FantaTab.react",["cx","EventProfiler","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j;i=babelHelpers.inherits(k,c("React").Component);j=i&&i.prototype;function k(){var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=j.constructor).call.apply(l,[this].concat(o)),this.$FantaTab1=false,m}k.prototype.componentDidMount=function(){c("EventProfiler").informManualInteractionTimestamp(["MessageJewelListItem","ChatSideBarLink"],true,"click")};k.prototype.render=function(){var l=this.props,m=l.isFocused,n=l.isLastTab,o=l.isLastTabOfType,p=l.MainComponent,q=l.messengerState,r=l.MinimizedComponent,s=l.raisedTabCount,t=l.tab,u=l.tabContent,v=t.isMinimized?r:p,w=t.id+(t.isMinimized?"-minimized":"-maximized"),x=this.$FantaTab1&&!t.isMinimized;this.$FantaTab1=t.isMinimized;return c("React").createElement("div",{className:"_5qi9 _5qib"+(this.props.isFocused?" _5qic":"")+(t.isMinimized?" _3001":"")},c("React").createElement(v,{isFocused:m,isHovered:t.isHovered||x,isLastTab:n,isLastTabOfType:o,key:w,messengerState:q,raisedTabCount:s,tab:t,tabContent:u}))};f.exports=k}),null);
__d("FantaTabGroup.react",["cx","FantaTab.react","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("React").PropTypes;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;l.prototype.shouldComponentUpdate=function(m){return!this.props.tabGroup.equals(m.tabGroup)||!!(!this.props.tabContents&&m.tabContents)||!!(this.props.tabContents&&m.tabContents&&!this.props.tabContents.equals(m.tabContents))};l.prototype.render=function(){var m=this.props,n=m.isLastOfTypeChecker,o=m.MainComponent,p=m.messengerState,q=m.MinimizedComponent,r=m.OverflowComponent,s=m.tabContents,t=m.tabGroup,u=t.focusedTabID,v=t.getRaisedandUnraisedTabs(),w=v.raisedTabs,x=v.unraisedTabs,y=void 0;if(n)y=w.findLastKey(function(B){return n(B)&&B.id});var z=t.allowedRaisedTabs===0?null:this.$FantaTabGroup1(x,r),A=w.count();return c("React").createElement("div",{className:"_59v1"},z,w.map(function(B){return c("React").createElement(c("FantaTab.react"),{isFocused:B.id===u,isLastTab:B===w.last(),isLastTabOfType:B.id===y,key:B.id,messengerState:p,MainComponent:o,MinimizedComponent:q,raisedTabCount:A,tab:B,tabContent:s&&s.get(B.id)})}).toArray())};l.prototype.$FantaTabGroup1=function(m,n){if(!m.isEmpty())return c("React").createElement("div",{className:"_1kws"},c("React").createElement(n,{items:m}));return null};function l(){i.apply(this,arguments)}l.propTypes={MainComponent:k.func.isRequired,MinimizedComponent:k.func.isRequired,OverflowComponent:k.func.isRequired,tabContents:k.object,tabGroup:k.object.isRequired};f.exports=l}),null);
__d("FantaPageComposerNullState.react",["cx","fbt","BootloadOnRender.react","JSResource","LazyComponent.react","MNCommerceCallToActionType","MNCommercePostbackCTADataManager","MNCommercePostbackRefSendManager","React","XUISpinner.react","getPageIDFromThreadID"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k;j=babelHelpers.inherits(l,c("React").PureComponent);k=j&&j.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=k.constructor).call.apply(m,[this].concat(p)),this.$FantaPageComposerNullState2=function(){var r=this.props,s=r.threadID,t=r.nullStateCTA;switch(t.action_type){case c("MNCommerceCallToActionType").OPEN_NATIVE:break;case c("MNCommerceCallToActionType").POSTBACK:default:c("MNCommercePostbackCTADataManager").sendAndConfirm(t.id,t.title,s);break}}.bind(this),n}l.prototype.render=function(){return c("React").createElement("div",{className:"_2xh0"},this.$FantaPageComposerNullState1(),c("React").createElement("div",{className:"_2xh4 _59w_"},c("React").createElement(c("BootloadOnRender.react"),{component:c("React").createElement(c("LazyComponent.react"),{cta:this.props.nullStateCTA,onClick:this.$FantaPageComposerNullState2,threadID:this.props.threadID}),loader:c("JSResource")("ChatPageComposerNullState.react").__setRef("FantaPageComposerNullState.react"),placeholder:c("React").createElement(c("XUISpinner.react"),{size:"small"})})))};l.prototype.$FantaPageComposerNullState1=function(){if(this.props.nullStateCTA!==null)switch(this.props.nullStateCTA.action_type){case c("MNCommerceCallToActionType").OPEN_NATIVE:return null;case c("MNCommerceCallToActionType").POSTBACK:if(!c("MNCommercePostbackRefSendManager").hasMDotMeRef(c("getPageIDFromThreadID")(this.props.threadID))&&!this.props.nullStateCTA.instantgame_metadata)return c("React").createElement("div",{className:"_4teq"},i._("When you tap {cta title}, {name} will see your public info.",[i._param("cta title",this.props.nullStateCTA.title),i._param("name",this.props.pageName)]));break;default:return null}return null};f.exports=l}),null);
__d("FantaPendingActions.react",["Bootloader","BootloadOnRender.react","FantaTabActions","JSResource","LazyComponent.react","MercuryThreadActions","MessengerMessageRequestsTypedLogger","MessageRequestUtils","MessagingTag","React","MercuryIDs","CurrentUser"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=c("MercuryThreadActions").get();h=babelHelpers.inherits(k,c("React").PureComponent);i=h&&h.prototype;function k(){__p&&__p();var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=i.constructor).call.apply(l,[this].concat(o)),this.$FantaPendingActions3=function(){var q=this.props.thread,r=!!q&&c("MessageRequestUtils").isFiltered(q),s=c("CurrentUser").getID(),t=c("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,s);new(c("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_delete_request").setThreadID(c("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(r?"other":"pending").setThreadKey(t).setEntryPoint(null).log()}.bind(this),this.$FantaPendingActions4=function(q){var r=this.props.thread,s=!!r&&c("MessageRequestUtils").isFiltered(r),t=c("CurrentUser").getID(),u=c("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,t);if(q==="hide")new(c("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_decline_cancel").setThreadID(c("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(s?"other":"pending").setThreadKey(u).setEntryPoint("inbox_banner").log()}.bind(this),this.$FantaPendingActions1=function(){__p&&__p();var q,r=this.props,s=r.thread,t=r.threadID,u=!!s&&c("MessageRequestUtils").isFiltered(s),v=c("CurrentUser").getID(),w=c("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,v);if(u)c("Bootloader").loadModules(["WebMessengerDeleteThreadDialog"],function(x){x.show(t,this.$FantaPendingActions3,this.$FantaPendingActions4,function(){return c("FantaTabActions").closeTab(t)})}.bind(this),"FantaPendingActions.react");else(function(){var x=c("MercuryIDs").isGroupChat(t);c("Bootloader").loadModules(["WebMessengerDeclineMRDialog"],function(y){y.show(s,t,function(){return c("FantaTabActions").closeTab(t)},x)},"FantaPendingActions.react")})();new(c("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_decline_attempt").setThreadID(c("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(u?"other":"pending").setThreadKey(w).setEntryPoint(null).log()}.bind(this),this.$FantaPendingActions2=function(){var q=this.props.thread,r=!!q&&c("MessageRequestUtils").isFiltered(q),s=c("CurrentUser").getID(),t=c("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,s);j.changeFolder(this.props.threadID,c("MessagingTag").INBOX);new(c("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_accept_request").setThreadID(c("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(r?"other":"pending").setThreadKey(t).setEntryPoint(null).log()}.bind(this),m}k.prototype.render=function(){var l=this.props.thread,m=!!l&&c("MessageRequestUtils").isFiltered(l);return c("React").createElement(c("BootloadOnRender.react"),{loader:c("JSResource")("ChatPendingActions.react").__setRef("FantaPendingActions.react"),placeholder:c("React").createElement("div",{style:{height:27}}),component:c("React").createElement(c("LazyComponent.react"),{isFiltered:m,onDeleteClick:this.$FantaPendingActions1,onReplyClick:this.$FantaPendingActions2})})};f.exports=k}),null);
__d("FantaTabComposer.react",["fbt","ChatTabComposerContainer.react","FantaTabActions","FantaTypeComposer","Keys","LogHistory","MercuryIDs","MercuryThreadIDMap","MercuryThreads","PhotosUploadWaterfall","React","SimpleXUIDialog","TypingDetectorController","WaterfallIDGenerator","WorkFileUploadsGating","XUIDialogButton.react","XUIDialogCancelButton.react","emptyFunction","getEveryoneMentionIndex"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("MercuryThreadIDMap").get(),l=c("MercuryThreads").get(),m=c("LogHistory").getInstance("chat_tab_view"),n=c("React").PropTypes,o=/^\s*$/;i=babelHelpers.inherits(p,c("React").Component);j=i&&i.prototype;function p(){__p&&__p();var q,r;for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=j.constructor).call.apply(q,[this].concat(t)),this.$FantaTabComposer3=c("WaterfallIDGenerator").generate(),this.$FantaTabComposer4=function(v,w){var x=this.props.threadID;k.getServerIDFromClientID(x,function(y){this.$FantaTabComposer2=new(c("TypingDetectorController"))(c("MercuryIDs").getUserIDFromThreadID(x),v,"mercury-chat",null,y,w)}.bind(this))}.bind(this),this.$FantaTabComposer14=function(v){this.$FantaTabComposer15(c("PhotosUploadWaterfall").UPLOAD_START,v);this.props.onSendPhoto(v,this.$FantaTabComposer1.onSend);this.$FantaTabComposer16("submit",v);this.focusInput()}.bind(this),this.$FantaTabComposer8=function(v){this.$FantaTabComposer15(c("PhotosUploadWaterfall").CLIENT_ERROR,v);this.$FantaTabComposer16("failed",v)}.bind(this),this.$FantaTabComposer10=function(v){this.$FantaTabComposer15(c("PhotosUploadWaterfall").CLIENT_ERROR,v);this.$FantaTabComposer16("failed",v)}.bind(this),this.$FantaTabComposer12=function(v){this.$FantaTabComposer15(c("PhotosUploadWaterfall").CANCEL_DURING_UPLOAD,v);this.$FantaTabComposer16("canceled",v)}.bind(this),this.$FantaTabComposer13=function(v){this.$FantaTabComposer15(c("PhotosUploadWaterfall").ALL_UPLOADS_DONE,v);this.$FantaTabComposer16("completed",v);var w=v.image_ids.length||v.attachments.length;this.$FantaTabComposer17(w)}.bind(this),this.$FantaTabComposer9=function(){this.props.onSendMessage("",this.props.composer,this.$FantaTabComposer1.onSend)}.bind(this),this.$FantaTabComposer11=function(v){this.props.onSelectSticker(v,function(){return this.$FantaTabComposer1.getInput()&&this.$FantaTabComposer1.getInput().focus()}.bind(this))}.bind(this),this.$FantaTabComposer6=function(v,w,x){this.props.onSendHotLike(v.emoji,w,x,function(){return this.$FantaTabComposer1.getInput()&&this.$FantaTabComposer1.getInput().focus()}.bind(this))}.bind(this),this.$FantaTabComposer7=function(v){this.$FantaTabComposer1.getInput().insertEmoji(v)}.bind(this),this.$FantaTabComposer5=function(event,v){__p&&__p();var w=this.props.threadID;if(event.keyCode===c("Keys").RETURN&&!event.shiftKey){event.preventDefault();var x=this.$FantaTabComposer20();if(x){var y=c("getEveryoneMentionIndex")(x)>-1;if(y)this.$FantaTabComposer18(v,x);else this.$FantaTabComposer19(v,x)}else this.$FantaTabComposer19(v,[])}if(event.keyCode===c("Keys").DOWN&&event.shiftKey&&this.hasEmptyInput()){c("FantaTabActions").minimizeTab(w);return}}.bind(this),r}p.prototype.componentDidMount=function(){var q=this.props,r=q.threadID,s=q.participants;if(this.props.isFocused&&s.length>0&&!l.isEmptyLocalThread(r))this.focusInput()};p.prototype.componentDidUpdate=function(q){if(this.props.isFocused&&this.props.isFocused!==q.isFocused&&!l.isEmptyLocalThread(this.props.threadID))this.focusInput()};p.prototype.componentWillUnmount=function(){this.$FantaTabComposer2&&this.$FantaTabComposer2.destroy()};p.prototype.render=function(){var q=this.props,r=q.participants,s=q.threadID,t=q.viewer;if(r.length===0)return c("React").createElement("div",null);return c("React").createElement(c("ChatTabComposerContainer.react"),{composer:this.props.composer,disableInput:this.props.disableInput,disableFileUploads:!c("WorkFileUploadsGating").canUploadFiles,fileUploader:this.props.fileUploader,initializeThingsWithInputFn:this.$FantaTabComposer4,inputKeyDown:this.$FantaTabComposer5,onBlur:c("emptyFunction"),onCustomLikeSelect:this.$FantaTabComposer6,onEmojiSelect:this.$FantaTabComposer7,onEscape:this.props.onEscape,onFileUploadFail:this.$FantaTabComposer8,onMount:function u(){},onP2PTrigger:this.$FantaTabComposer9,onPhotoUploadFail:this.$FantaTabComposer10,onStickerSelect:this.$FantaTabComposer11,onTab:this.props.onTab,onUploadCancel:this.$FantaTabComposer12,onUploadComplete:this.$FantaTabComposer13,onUploadSubmit:this.$FantaTabComposer14,placeholder:h._("Type a message..."),ref:function(u){this.$FantaTabComposer1=u;if(this.props.isFocused&&!l.isEmptyLocalThread(this.props.threadID))this.focusInput()}.bind(this),resizeFn:function u(){},threadID:s,viewer:t})};p.prototype.$FantaTabComposer15=function(q,r){c("PhotosUploadWaterfall").sendSignal(babelHelpers["extends"]({qn:this.$FantaTabComposer3,step:q,uploader:c("PhotosUploadWaterfall").APP_CHAT},r||{}))};p.prototype.$FantaTabComposer17=function(q){if(q===0)return;this.$FantaTabComposer15(c("PhotosUploadWaterfall").POST_PUBLISHED,{count:q});this.$FantaTabComposer3=c("WaterfallIDGenerator").generate()};p.prototype.$FantaTabComposer16=function(q,r){m.debug("photo_uploader:"+q,"{}")};p.prototype.$FantaTabComposer18=function(q,r){var s=h._("Mention everyone?").toString(),t=h._("Doing so will send a mention to everyone in this group.").toString(),u=h._("Mention \u0040everyone!").toString(),v=c("React").createElement("div",null,c("React").createElement(c("XUIDialogCancelButton.react"),null),c("React").createElement(c("XUIDialogButton.react"),{action:"cancel",label:u,use:"confirm",onClick:function(){this.$FantaTabComposer19(q,r)}.bind(this)}));c("SimpleXUIDialog").showEx(t,s,v,null,null)};p.prototype.$FantaTabComposer19=function(q,r){this.props.onSendMessage({message:q,mentions:r},this.props.composer,this.$FantaTabComposer1.onSend);return};p.prototype.focusInput=function(){this.$FantaTabComposer1&&this.$FantaTabComposer1.getInput()&&this.$FantaTabComposer1.getInput().focus()};p.prototype.$FantaTabComposer21=function(){return this.$FantaTabComposer1&&this.$FantaTabComposer1.getInput()&&this.$FantaTabComposer1.getInput().getValue()||""};p.prototype.$FantaTabComposer20=function(){if(!this.$FantaTabComposer1)return null;var q=this.$FantaTabComposer1.getInput();return q&&q.getMentions?q.getMentions():null};p.prototype.hasEmptyInput=function(){return o.test(this.$FantaTabComposer21())};p.propTypes={fileUploader:n.object,isFocused:n.bool.isRequired,onEscape:n.func.isRequired,onSelectSticker:n.func.isRequired,onSendHotLike:n.func.isRequired,onSendMessage:n.func.isRequired,onSendPhoto:n.func.isRequired,onTab:n.func.isRequired,participants:n.array.isRequired,threadID:n.string.isRequired,viewer:n.string.isRequired};f.exports=p}),null);
__d("FantaTabSheetPlaceholder.react",["cx","React","XUISpinner.react"],(function a(b,c,d,e,f,g,h){"use strict";var i=function i(){return c("React").createElement("div",{className:"_w_z"},c("React").createElement(c("XUISpinner.react"),null))};f.exports=i}),null);
__d("FantaTabSheet.react",["cx","BootloadedComponent.react","CurrentUser","FantaTabSheetActions","FantaTabSheetPlaceholder.react","JSResource","MercuryIDs","MercuryMessages","MercuryParticipants","MercurySheetPolicy","React","emptyFunction"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("MercuryMessages").get(),l=c("React").PropTypes;i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;m.prototype.shouldComponentUpdate=function(n){var o=this.props;return o.threadID!==n.threadID||!o.tabContent.equals(n.tabContent)};m.prototype.render=function(){__p&&__p();var n=this.props,o=n.threadID,p=n.tabContent,q=p.loggingID,r=p.openSheet,s=p.privacyController,t=p.thread,u=p.typeahead,v=void 0;switch(r){case c("MercurySheetPolicy").sheets.ChatThreadIsMutedTabSheet:v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("FantaTabSheetChatThreadIsMuted.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),key:r,threadID:o});break;case c("MercurySheetPolicy").sheets.ChatNameConversationTabSheet:v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("FantaTabSheetNameConversation.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement(c("FantaTabSheetPlaceholder.react"),null),key:r,thread:t,threadID:o});break;case c("MercurySheetPolicy").sheets.ChatUserBlockedTabSheet:var w=c("MercuryIDs").getUserIDFromThreadID(o);if(w){var x=c("MercuryParticipants").getNow(c("MercuryIDs").getParticipantIDFromUserID(w));if(x&&s)v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("ChatUserBlockedTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),gender:x.gender,key:r,privacyActionController:s,shortName:x.short_name})}break;case c("MercurySheetPolicy").sheets.ChatOfflineTabSheet:v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("FantaTabSheetOffline.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),key:r,privacyController:s,threadID:o});break;case c("MercurySheetPolicy").sheets.ChatReadOnlyTabSheet:case c("MercurySheetPolicy").sheets.ChatReadOnlyPermanentTabSheet:v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("FantaTabSheetReadOnly.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),key:r,threadID:o});break;case c("MercurySheetPolicy").sheets.FantaAddFriendsSheet:v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("FantaTabSheetAddFriends.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement(c("FantaTabSheetPlaceholder.react"),null),key:r,loggingID:q,thread:t,threadID:o,typeahead:u});break;case c("MercurySheetPolicy").sheets.FantaAddMoreFriendsSheet:v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("FantaTabSheetAddMoreFriends.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement(c("FantaTabSheetPlaceholder.react"),null),key:r,loggingID:q,thread:t,threadID:o,typeahead:u});break;case c("MercurySheetPolicy").sheets.ChatThreadIsMessageBlockedSheet:v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("FantaTabSheetMessageBlocked.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),key:r,threadID:o});break;case c("MercurySheetPolicy").sheets.ChatUserFocusSheet:v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("ChatUserFocusSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),key:r,thread:t,threadID:o});break;case c("MercurySheetPolicy").sheets.ChatUserFocusBypassSheet:v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("ChatUserFocusBypassSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),key:r});break;case c("MercurySheetPolicy").sheets.ChatUserTimezoneSheet:v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("ChatUserTimezoneSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),data:p.timezoneInfo,key:r,onDismiss:function C(){return c("FantaTabSheetActions").closeUserTimezoneSheet(o)},resize:c("emptyFunction"),threadID:o});break;case c("MercurySheetPolicy").sheets.ChatUploadWarningTabSheet:v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("ChatUploadWarningTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),key:r});break;case c("MercurySheetPolicy").sheets.ChatNoRecipientsTabSheet:if(!c("MercuryIDs").isCanonical(o))v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("ChatNoRecipientsTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),key:r});break;case c("MercurySheetPolicy").sheets.ChatNewMessagesTabSheet:v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("FantaNewMessagesTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),key:r,threadID:o});break;case c("MercurySheetPolicy").sheets.ChatEmployeeAwaySheet:v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("ChatEmployeeAwaySheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),key:r});break;case c("MercurySheetPolicy").sheets.ChatEventReminderTabSheet:v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("FantaEventReminderTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),key:r,threadID:o});break;case c("MercurySheetPolicy").sheets.ChatAppointmentBanner:if(t){var y=k.getCurrentlyLoadedMessages(o);v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("ChatAppointmentBannerRoot.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),pageID:t.other_user_fbid,userID:c("CurrentUser").getID(),count:100,messageList:y,appointmentBannerDidUpdate:c("emptyFunction"),key:r,threadID:o})}break;case c("MercurySheetPolicy").sheets.ChatMontageSheet:v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("ChatMontageSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),key:r,threadID:o,onResize:c("emptyFunction")});break;case c("MercurySheetPolicy").sheets.ChatJoinCallSheet:if(t){var z=t.rtc_call_data,A=t.thread_fbid;v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("ChatJoinCallSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),key:r,rtcCallData:z,threadFBID:A})}break;case c("MercurySheetPolicy").sheets.ChatRoomAssociatedObjectSheet:if(t){var B=t.associated_object;v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("ChatRoomAssociatedObjectSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),key:r,associatedObject:B})}break;case c("MercurySheetPolicy").sheets.ChatWorkDoNotDisturbSheet:v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("ChatWorkDoNotDisturbSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),key:r,description:p.workAvailabilityHumanReadable});break;case c("MercurySheetPolicy").sheets.ChatMentorshipProgramSheet:v=c("React").createElement(c("BootloadedComponent.react"),{bootloadLoader:c("JSResource")("MentorshipProgramSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:c("React").createElement("div",null),key:r,mentorship:p.mentorship});break}if(v)return c("React").createElement("div",{className:"_1sk5"},c("React").createElement("div",{className:"_1sk6"},v));return null};function m(){i.apply(this,arguments)}m.propTypes={threadID:l.string.isRequired,tabContent:l.object.isRequired};f.exports=m}),null);
__d("FantaTabMain.react",["cx","fbt","invariant","Bootloader","BootloadOnRender.react","ChatBehavior","ChatTabBlinking","CurrentUser","DragDropTarget","Event","FantaAvailableStatus","FantaChatHeaderContainer.react","FantaConversationScroller.react","FantaDispatcher","FantaDragAndDrop.react","FantaMessageActions","FantaPageComposerNullState.react","FantaPendingActions.react","FantaTabActions","FantaTabComposer.react","FantaTabSheet.react","FBIDCheck","immutable","JSResource","Keys","LazyComponent.react","MercuryIDs","MercuryParticipants","MessageRequestUtils","MessagingTagConstants","MessengerBotMenuDataFetcher","MessengerParticipants.bs","MessengerState.bs","MNCommercePageSetting","Parent","React","ReactDOM","SimpleXUIDialog","TrackingNodes","WorkFileUploadsGating","convertMIGColorToFIGColor","getPageIDFromThreadID","getVendorPrefixedEventName","gkx","idx","ifRequired","joinClasses","throttle","MarketplaceWWWFeatureGating"],(function aa(ba,a,ca,da,b,ea,fa,c,d){"use strict";__p&&__p();var e,f,g=/\D+/g,h=a("React").PropTypes;e=babelHelpers.inherits(i,a("React").Component);f=e&&e.prototype;function i(){__p&&__p();var j,k;for(var l=arguments.length,m=Array(l),n=0;n<l;n++)m[n]=arguments[n];return k=(j=f.constructor).call.apply(j,[this].concat(m)),this.state={closing:false,disableInput:false},this.$FantaTabMain20=function(event){var o=!!a("Parent").byClass(event.target,"fantaTabMain-"+this.props.tab.id),p=!!a("Parent").byClass(event.relatedTarget,"fantaTabMain-"+this.props.tab.id);if(!o||!p){if(this.$FantaTabMain9){clearTimeout(this.$FantaTabMain9);this.$FantaTabMain9=null;return}a("FantaTabActions").hoveredTab(this.props.tab.id)}}.bind(this),this.$FantaTabMain21=function(event){var o=!!a("Parent").byClass(event.target,"fantaTabMain-"+this.props.tab.id),p=!!a("Parent").byClass(event.relatedTarget,"fantaTabMain-"+this.props.tab.id);if(!o||!p){if(this.$FantaTabMain9)clearTimeout(this.$FantaTabMain9);this.$FantaTabMain9=setTimeout(function(){this.$FantaTabMain9=null;a("FantaTabActions").unhoveredTab(this.props.tab.id)}.bind(this),500)}}.bind(this),this.$FantaTabMain18=function(event){var o=!!a("Parent").byClass(event.target,"fantaTabMain-"+this.props.tab.id),p=!!a("Parent").byClass(event.relatedTarget,"fantaTabMain-"+this.props.tab.id);if(!o||!p)if(!event.relatedTarget||!event.target)this.$FantaTabMain7=setTimeout(function(){this.$FantaTabMain7=null;this.$FantaTabMain22(this.props.tab.id)}.bind(this),100);else this.$FantaTabMain22(this.props.tab.id)}.bind(this),this.$FantaTabMain19=function(event){__p&&__p();if(this.$FantaTabMain7){clearTimeout(this.$FantaTabMain7);this.$FantaTabMain7=null;return}var o=!!a("Parent").byClass(event.target,"fantaTabMain-"+this.props.tab.id),p=!!a("Parent").byClass(event.relatedTarget,"fantaTabMain-"+this.props.tab.id),q=event.target;if(!(q&&q.classList&&(q.classList.contains("_3olu")||q.classList.contains("_61td")||q.classList.contains("_4zs3"))))if(!o||!p)if(!a("FantaDispatcher").isDispatching())a("FantaTabActions").focusTab(this.props.tab.id)}.bind(this),this.$FantaTabMain24=function(o){a("FantaMessageActions").linkPreview(this.props.tab.id,o)}.bind(this),this.$FantaTabMain23=function(o){var p=this.props.tabContent,q=p||{},r=q.composer,s=this.props.tab.id,t=false;if(a("gkx")("AT44gcd7lpH2YiclJ-LHsuuoRRi7VIOizU9LdST-uko3uQzHBXGOu3PdlMr4PkOBovUmJRjA-IeSNbDkk89bQ4wq8b7BDIrax8JSG-E9Uz6KPQ"))a("ifRequired")("MercuryThreads",function(u){return t=u.get().isEmptyLocalThread(s)});if(r&&!t)a("FantaMessageActions").prepareFilesForSend(s,o,r)}.bind(this),this.$FantaTabMain15=function(o){if(o.keyCode===a("Keys").ESC){this.$FantaTabMain2(true);o.preventDefault();o.stopPropagation()}}.bind(this),this.$FantaTabMain16=function(o){if(o.keyCode===a("Keys").TAB)this.$FantaTabMain17(o)}.bind(this),this.$FantaTabMain17=function(event){var o=this.props.raisedTabCount;if(o>1){event.preventDefault();this.$FantaTabMain3(event.ctrlKey,event.shiftKey)}}.bind(this),this.$FantaTabMain2=function(o){if(!this.refs.composer||this.refs.composer.hasEmptyInput()&&!this.$FantaTabMain25())this.$FantaTabMain26(o);else this.$FantaTabMain27(o)}.bind(this),k}i.prototype.UNSAFE_componentWillMount=function(){this.$FantaTabMain2=a("throttle")(this.$FantaTabMain2,100);this.$FantaTabMain3=a("throttle")(this.$FantaTabMain3,100)};i.prototype.componentDidMount=function(){this.$FantaTabMain10();this.$FantaTabMain11();this.$FantaTabMain12(this.props.tab.id);this.$FantaTabMain13();this.$FantaTabMain14()};i.prototype.componentDidUpdate=function(){this.$FantaTabMain11()};i.prototype.componentWillUnmount=function(){this.$FantaTabMain4&&this.$FantaTabMain4.disable()};i.prototype.shouldComponentUpdate=function(j,k){var l=this.props,m=this.state;return l.hasFetchedAll!==j.hasFetchedAll||l.isFocused!==j.isFocused||l.isHovered!==j.isHovered||l.isLastGroupTab!==j.isLastGroupTab||!l.messages.equals(j.messages)||!l.tab.equals(j.tab)||!l.tabContent&&!!j.tabContent||l.tabContent&&!l.tabContent.equals(j.tabContent)||l.thread!==j.thread||m.closing!==k.closing||m.disableInput!==k.disableInput||!l.onlineUsers.equals(j.onlineUsers)};i.prototype.$FantaTabMain11=function(){__p&&__p();var j=this.props,k=j.tab,l=j.thread,m=k.id;if(!l)return;var n=this.refs.root&&a("ReactDOM").findDOMNode(this.refs.root);if(!n)return;var o=l.unread_count;if(o!==undefined){var p=!!o&&(!a("ChatBehavior").showsTabUnreadUI||a("ChatBehavior").showsTabUnreadUI());if(p)a("ChatTabBlinking").blinkTab(m,{getTabElem:function q(){return n},isFocused:function(){return this.props.isFocused}.bind(this),isHovered:function q(){return false}});else a("ChatTabBlinking").unblinkTab(m)}};i.prototype.render=function(){__p&&__p();var j,k,l,m,n,o,p=this.props,q=p.hasFetchedAll,r=p.isFocused,s=p.isHovered,t=p.isLastGroupTab,u=p.messages,v=p.onLoadMoreMessages,w=p.onSelectSticker,x=p.onSendHotLike,y=p.onSendMessage,z=p.onSendPhoto,A=p.showContextBanner,B=p.tab,C=p.tabContent,D=p.thread,E=B.id,F=a("CurrentUser").getID(),G=C&&C.composer.fileUploader,H=C&&C.composer.sharePreview,I=G&&G.uploadingFiles,J=G&&G.uploadedFiles,K=D&&a("convertMIGColorToFIGColor")(D.custom_color),L=C&&C.nullStateCTA,M=L&&D&&D.message_count===0,N=D&&D.participants||[],O=C&&C.threadPreviewRecipients||a("immutable").List(),P=N.length>0?N:O.toArray(),Q=(j=this.props)!=null?(j=j.thread)!=null?j.other_user_fbid:j:j,R=Q?a("MercuryParticipants").getNow(a("MercuryIDs").getParticipantIDFromUserID(Q)):null,S=R&&R.short_name||"page",T=a("getPageIDFromThreadID")(this.props.tab.id),U=D&&a("MessageRequestUtils").isMessageRequest(D)?a("React").createElement(a("FantaPendingActions.react"),{thread:D,threadID:E}):M&&L?a("React").createElement(a("FantaPageComposerNullState.react"),{threadID:E,nullStateCTA:L,pageName:S}):C?a("React").createElement("div",{className:"fbNubFlyoutFooter"+(this.state.disableInput?" fbNubFlyoutComposerDisabled":"")},a("React").createElement(a("FantaTabComposer.react"),{composer:C.composer,disableInput:this.state.disableInput,fileUploader:G,isFocused:r,onEscape:this.$FantaTabMain15,onKeyDown:this.$FantaTabMain15,onKeyPress:this.$FantaTabMain16,onSelectSticker:w,onSendHotLike:x,onSendMessage:y,onSendPhoto:z,onTab:this.$FantaTabMain17,ref:"composer",participants:P,threadID:E,viewer:F})):null,V=a("FantaAvailableStatus").isAvailable(D,E);!!C||d(0);var ga=a("React").createElement(a("FantaTabSheet.react"),{tabContent:C,threadID:E}),W=(k=D)!=null?k.marketplace_thread_data:k,X=(l=W)!=null?l.for_sale_item:l,Y=(m=W)!=null?m.buyer_fbid:m,Z=(n=W)!=null?n.seller_fbid:n,$=void 0;if(X&&Y&&Z){var ha=a("MarketplaceWWWFeatureGating").marketplaceWWWMessengerBanner;$=ha?a("React").createElement(a("BootloadOnRender.react"),{loader:a("JSResource")("MarketplaceMessengerContextBanner.react").__setRef("FantaTabMain.react"),placeholder:a("React").createElement("div",null),component:a("React").createElement(a("LazyComponent.react"),{buyerID:Y,forSaleItem:X,renderLocation:"chat",sellerID:Z})}):null}var ia=C&&C.isMultiCompany,ja=C&&C.joinableInterstitialData?a("React").createElement(a("BootloadOnRender.react"),{loader:a("JSResource")("ChatJoinableInterstitialPreview.react").__setRef("FantaTabMain.react"),placeholder:a("React").createElement("div",null),component:a("React").createElement(a("LazyComponent.react"),{data:C.joinableInterstitialData,isActive:r,onClose:this.$FantaTabMain2})}):a("React").createElement("div",{className:"fbNubFlyoutInner"},a("React").createElement(a("FantaChatHeaderContainer.react"),{blockedIDs:a("MessengerState.bs").blockedIds(this.props.messengerState),composer:C.composer,customColor:K,isFocused:r,isLastGroupTab:t,isMultiCompany:ia,membershipParticipants:C.membershipParticipants,onClose:this.$FantaTabMain2,thread:D,threadID:E,viewer:F}),a("React").createElement("div",{className:"_1ia _2sz2",ref:function(ka){this.$FantaTabMain5=ka}.bind(this)},ga,a("React").createElement(a("FantaConversationScroller.react"),{hasFetchedAll:q,isFocused:r,messages:u,onFocus:function(){return this.refs.composer&&this.refs.composer.focusInput()}.bind(this),onLoadMoreMessages:v,onlineUsers:this.props.onlineUsers,readReceipts:a("MessengerState.bs").readReceiptsPerThread(this.props.messengerState),showContextBanner:A,thread:D,threadID:E,viewer:F}),a("React").createElement("div",{className:"_3bpu"}),a("React").createElement("div",{className:"_2hc2"},a("React").createElement(a("BootloadOnRender.react"),{loader:a("JSResource")("P2PChatThreadBannerContainer.react").__setRef("FantaTabMain.react"),placeholder:a("React").createElement("div",null),component:a("React").createElement(a("LazyComponent.react"),{isVisible:true,otherUserID:a("MercuryIDs").getUserIDFromThreadID(E),threadID:E})})),a("React").createElement("div",{className:"_4g6x"},a("React").createElement("div",{className:"_4g6y"},a("React").createElement("div",{className:"_4g6z _4g71"},c._("Drag Link\/Files Here")),a("React").createElement("div",{className:"_4g6z _4g6- _4g6_"},c._("Drop Files Here")),a("React").createElement("div",{className:"_4g6z _4g6- _4g70"},c._("Drop Link Here")))),T&&a("gkx")("AT6sbgm7rc2lUrfkuLmhGQcvGZoC5P9uoMvWR1gdSA6TrdITISrYRi27xHKWuRHMYoI4W7RaxO4KyBa-w6z3OpbbspZrp85jUpATWVUJp3E46w")?a("React").createElement(a("BootloadOnRender.react"),{component:a("React").createElement(a("LazyComponent.react"),{originalElement:U,pageID:T,playLinkClassName:"_2xh6 _2h_r",showGameImage:true,threadFBID:(o=this.props)!=null?(o=o.thread)!=null?o.thread_fbid:o:o,threadID:E}),loader:a("JSResource")("MessengerGameBotPlayButton.react").__setRef("FantaTabMain.react"),placeholder:a("React").createElement("div",null)}):U,a("React").createElement(a("FantaDragAndDrop.react"),{composer:C.composer,threadID:E,uploadedFiles:J,uploadingFiles:I,sharePreview:H}),$));return a("React").createElement("div",{className:a("joinClasses")((this.state.closing?"_2suj":"")+" _3_9e _s0f _50mz _50m_"+(V?" _4-0b":"")+" fbNub _50-v"+(r?" focusedTab":"")+(s?" hoveredTab":"")+" opened _27_3"+(a("gkx")("AT74KMJ8RYhvB1tMU93uHQ5gZqTAUi_w-rBy6KswPeaIPbVgyCy23kvmxPapx5bD4puY3bmrQeh4Z7ALUGarUq4kATHuSQM2CsFm5KKmhgZoYA")?" _68h9":""),"fantaTabMain-"+E),"data-ft":a("TrackingNodes").getTrackingInfo(a("TrackingNodes").types.CHAT_FLYOUT),onBlur:this.$FantaTabMain18,onFocus:this.$FantaTabMain19,onKeyDown:this.$FantaTabMain15,onKeyPress:this.$FantaTabMain16,onMouseEnter:this.$FantaTabMain20,onMouseLeave:this.$FantaTabMain21,ref:"root"},a("React").createElement("div",{className:"fbNubFlyout fbDockChatTabFlyout uiContextualLayerParent",role:"complementary"},a("React").createElement("div",{className:"fbNubFlyoutOuter"},ja)))};i.prototype.$FantaTabMain22=function(j){if(!a("FantaDispatcher").isDispatching())a("FantaTabActions").blurTab(this.props.tab.id);if(this.$FantaTabMain9){clearTimeout(this.$FantaTabMain9);this.$FantaTabMain9=null}a("FantaTabActions").unhoveredTab(j)};i.prototype.$FantaTabMain14=function(){var j=a("getPageIDFromThreadID")(this.props.tab.id);if(j)a("MessengerBotMenuDataFetcher").getHasPageSetting(j,function(k){this.setState({disableInput:k})}.bind(this),function(){this.setState({disableInput:false})}.bind(this),a("MNCommercePageSetting").COMPOSER_INPUT_DISABLED)};i.prototype.$FantaTabMain10=function(){__p&&__p();if(a("WorkFileUploadsGating").canUploadFiles&&!this.$FantaTabMain4){var j=a("ReactDOM").findDOMNode(this.$FantaTabMain5);if(j){var k=new(a("DragDropTarget"))(j);this.$FantaTabMain4=k;k.setOnFilesDropCallback(this.$FantaTabMain23);k.setOnURLDropCallback(this.$FantaTabMain24);k.enable()}}};i.prototype.$FantaTabMain3=function(j,k){if(!j)if(k)a("FantaTabActions").focusPreviousTab();else a("FantaTabActions").focusNextTab()};i.prototype.$FantaTabMain25=function(){return this.$FantaTabMain28()||this.$FantaTabMain29()};i.prototype.$FantaTabMain28=function(){var j,k,l=this.props.tabContent,m=((j=l)!=null?(j=j.composer)!=null?(j=j.fileUploader)!=null?j.uploadedFiles:j:j:j)||{size:0},n=((k=l)!=null?(k=k.composer)!=null?(k=k.fileUploader)!=null?k.uploadingFiles:k:k:k)||{size:0};return m.size>0||n.size>0};i.prototype.$FantaTabMain29=function(){var j,k=this.props.tabContent,l=(j=k)!=null?(j=j.composer)!=null?j.sharePreview:j:j;return!!(l&&l.params&&l.type)};i.prototype.$FantaTabMain26=function(j){__p&&__p();var k=this.props.tab,l=a("ReactDOM").findDOMNode(this.refs.root);this.$FantaTabMain1=setTimeout(function(){return j?a("FantaTabActions").closeAndTabNext(k.id):a("FantaTabActions").closeTab(k.id)},1.2*a("ifRequired")("cssVar",function(n){return"200ms".replace(g,"")},function(){return 200}));var m=a("Event").listen(l,a("getVendorPrefixedEventName")("animationend"),function(n){if(n.animationName==="closeChatTab"){j?a("FantaTabActions").closeAndTabNext(k.id):a("FantaTabActions").closeTab(k.id);clearTimeout(this.$FantaTabMain1);m.remove()}}.bind(this));this.$FantaTabMain30();this.setState({closing:true})};i.prototype.$FantaTabMain27=function(j){var k=this.props.tab,l=k.id;a("FantaTabActions").blurTab(l);var m=c._("Are you sure you want to close this chat window?"),n=c._("You haven't sent your message.");a("SimpleXUIDialog").showConfirm(m,n,function(o){if(o)j?a("FantaTabActions").closeAndTabNext(l):a("FantaTabActions").closeTab(l);else a("FantaTabActions").focusTab(l)},{autofocusConfirm:true,useReactFocusBehavior:true})};i.prototype.$FantaTabMain13=function(){this.$FantaTabMain8=Math.floor(Date.now()/1e3)};i.prototype.$FantaTabMain30=function(){var j=this.props.thread,k=j?j.other_user_fbid:null,l=Math.floor(Date.now()/1e3),m=this.$FantaTabMain8;if(j&&k&&!a("FBIDCheck").isUser_deprecated(k))a("Bootloader").loadModules(["PagesLogger","PagesLoggerEventEnum","PagesLoggerEventTargetEnum","PagesEventObserver","PagesEventType"],function(n,o,p,q,r){n.log(k,o.CLICK,p.MESSAGE_FANTA_TAB_CLOSE,"",["pages_surface_team"],{open_tab_timestamp:m,close_tab_timestamp:l,last_message_timestamp:j.last_message_timestamp,message_count:j.message_count,snippet_sender:j.snippet_sender,participants:j.participants});q.notify(r.MESSAGES_FANTA_TAB_CLOSE,k,{open_tab_timestamp:m,close_tab_timestamp:l,last_message_timestamp:j.last_message_timestamp,message_count:j.message_count,snippet_sender:j.snippet_sender,participants:j.participants})},"FantaTabMain.react")};i.prototype.$FantaTabMain12=function(j){__p&&__p();if(!a("MercuryIDs").isValidThreadID(j))return;a("Bootloader").loadModules(["GroupChatMessageBlockAlert","GroupChatMessageIgnoreAlert","MercuryIgnoredBlockedParticipants.bs","MercuryThreadActions","MercuryThreads"],function(k,l,m,n,o){__p&&__p();var p=n.get(),q=o.get();q.getThreadMeta(j,function(r){__p&&__p();var s=a("MessengerState.bs").fbid(this.props.messengerState),t=a("MessengerState.bs").ignoredIds(this.props.messengerState);a("MessengerState.bs").compute(s,function(u){__p&&__p();var v=u.blocked_ids;if(m.isPresentInGroupThread(s,v,r))k.show(m.participantsInGroupThread(s,v,r),function(){a("FantaTabActions").focusTab(j)},function(){a("FantaTabActions").closeTab(j);p.leaveGroup(j)});else if(a("MessengerParticipants.bs").areParticipantsInGroupThread(s,t,r)&&r.folder==="inbox"&&a("gkx")("AT6sQjs7GRVhEipNW3TkmIJi_BHZa2KKyD-Mi9QicLxYmeTJYm7WWpq-_Rh-wyDoXW1BNvzANnO7tf1hMqNgPGMF"))l.show(a("MessengerParticipants.bs").participantsInGroupThread(s,t,r),a("MercuryIDs").getThreadFBIDFromThreadID(j),function(){a("FantaTabActions").focusTab(j)},function(){a("FantaTabActions").closeTab(j);a("Bootloader").loadModules(["IgnoreMessagesTypedLogger","IgnoreMessagesLoggingEvent","IgnoreMessagesPlatforms"],function(w,x,y){p.changeFolder(j,a("MessagingTagConstants").other);new w().setEvent(x.IGNORE_CONFIRMED).setThreadID(a("MercuryIDs").getThreadFBIDFromThreadID(j)).setPlatform(y.CHAT_TABS).log()},"FantaTabMain.react")})})}.bind(this))}.bind(this),"FantaTabMain.react")};i.propTypes={hasFetchedAll:h.bool.isRequired,isFocused:h.bool.isRequired,isHovered:h.bool.isRequired,isLastGroupTab:h.bool.isRequired,messages:h.object,onlineUsers:h.instanceOf(a("immutable").List).isRequired,onLoadMoreMessages:h.func.isRequired,onSelectSticker:h.func.isRequired,onSendHotLike:h.func.isRequired,onSendMessage:h.func.isRequired,onSendPhoto:h.func.isRequired,raisedTabCount:h.number,showContextBanner:h.bool,tab:h.object.isRequired,tabContent:h.object,thread:h.object};b.exports=i}),null);
__d("FantaTabMainLoader.react",["Bootloader","FantaAppStore","FantaAvailableStatus","FantaGetMessageActions","FantaMessageActions","FantaTabMain.react","immutable","MercuryConfig","MercuryIDs","React","TimeSlice","emptyFunction","idx","requestIdleCallback","setImmediate"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=c("React").PropTypes,k=function m(n){__p&&__p();var o,p;c("FantaAppStore").addReducers(n);var q=c("FantaAppStore").getState(),r=(o=q)!=null?(o=o.mercury)!=null?o.tabContents:o:o;if(r)(function(){var s=r.reduce(function(s,t){var u=t.thread;if(u)s.push(u);return s},[]);c("setImmediate")(function(){return c("FantaGetMessageActions").threadsUpdated(s)})})();k=c("emptyFunction")};h=babelHelpers.inherits(l,c("React").Component);i=h&&h.prototype;function l(){__p&&__p();var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=i.constructor).call.apply(m,[this].concat(p)),this.$FantaTabMainLoader2=function(){var r=this.props.tab;c("FantaGetMessageActions").fetchMoreMessages(r.id)}.bind(this),this.$FantaTabMainLoader3=function(r,s){var t=this.props.tab;c("FantaMessageActions").sendSticker(t.id,r,s)}.bind(this),this.$FantaTabMainLoader4=function(r,s,t,u){var v=this.props.tab;c("FantaMessageActions").sendHotLike(v.id,r,s,t,u)}.bind(this),this.$FantaTabMainLoader5=function(r,s,t){var u=this.props.tab;c("FantaMessageActions").sendMessage(u.id,r,s,t)}.bind(this),this.$FantaTabMainLoader6=function(r,s){var t=this.props.tab;c("FantaMessageActions").sendPhoto(t.id,r,s)}.bind(this),n}l.prototype.shouldComponentUpdate=function(m){var n=this.props;return n.isFocused!==m.isFocused||n.isHovered!==m.isHovered||n.isLastTabOfType!==m.isLastTabOfType||!n.tab.equals(m.tab)||!n.tabContent.equals(m.tabContent)};l.prototype.componentDidMount=function(){var m=function m(){c("Bootloader").loadModules(["FantaReducersTabSheets"],k,"FantaTabMainLoader.react")};c("TimeSlice").guard(function(){c("requestIdleCallback")(m)},"additional request not needed for initial display",{propagationType:c("TimeSlice").PropagationType.ORPHAN})()};l.prototype.render=function(){var m=this.props,n=m.isFocused,o=m.isHovered,p=m.isLastTabOfType,q=m.messengerState,r=m.raisedTabCount,s=m.tab,t=m.tabContent,u=t.hasFetchedAll,v=t.showContextBanner,w=t.thread,x=t.threadPreviewID,y=t.messages,z=x?s.id+"-"+x:s.id;if(!t)return c("React").createElement("div",{key:"noContent-"+z});if(!y)y=c("immutable").List();var A=c("immutable").List([]);if(c("MercuryConfig").GDWC)A=this.$FantaTabMainLoader1(w,s);return c("React").createElement(c("FantaTabMain.react"),{hasFetchedAll:u,isFocused:n,isHovered:o,isLastGroupTab:p,key:z,messages:y,messengerState:q,onlineUsers:A,onLoadMoreMessages:this.$FantaTabMainLoader2,onSelectSticker:this.$FantaTabMainLoader3,onSendHotLike:this.$FantaTabMainLoader4,onSendMessage:this.$FantaTabMainLoader5,onSendPhoto:this.$FantaTabMainLoader6,raisedTabCount:r,showContextBanner:v,tab:s,tabContent:t,thread:w})};l.prototype.$FantaTabMainLoader1=function(m,n){__p&&__p();var o=c("MercuryIDs").getUserIDFromThreadID(n.id),p=[];if(o)p=c("FantaAvailableStatus").isAvailable(m,n.id)?[o]:[];else if(m){p=m.participants.filter(function(q){if(!q)return false;var r=c("MercuryIDs").getThreadIDFromParticipantID(q);if(!r)return false;var s=c("FantaAvailableStatus").isAvailable(null,r);return s});p=p.map(function(q){return c("MercuryIDs").getUserIDFromParticipantID(q)||""})}return c("immutable").List(p)};l.propTypes={isFocused:j.bool.isRequired,isHovered:j.bool.isRequired,isLastTabOfType:j.bool.isRequired,raisedTabCount:j.number,tab:j.object.isRequired,tabContent:j.object};f.exports=l}),null);
__d("FantaTabMinimized.react",["cx","fbt","ChatBehavior","ChatTabBlinking","ChatTabHeaderContainer.react","CurrentUser","Event","FantaAvailableStatus","FantaTabActions","React","ReactDOM","SimpleXUIDialog","emptyFunction","getVendorPrefixedEventName","ifRequired"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=/\D+/g,m=c("React").PropTypes;j=babelHelpers.inherits(n,c("React").Component);k=j&&j.prototype;function n(){__p&&__p();var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.state={closing:false},this.$FantaTabMinimized4=function(){var t=this.props.tabContent;if(!t||t&&t.composer.text.length===0)this.$FantaTabMinimized5();else this.$FantaTabMinimized6()}.bind(this),this.$FantaTabMinimized3=function(event){var t=event.target;if(t&&t.classList&&!t.classList.contains("button")){event.preventDefault();c("FantaTabActions").unminimizeTab(this.props.tab.id);c("FantaTabActions").focusTab(this.props.tab.id)}}.bind(this),p}n.prototype.componentDidMount=function(){this.$FantaTabMinimized2()};n.prototype.componentDidUpdate=function(){this.$FantaTabMinimized2()};n.prototype.shouldComponentUpdate=function(o){var p=this.props;return!p.tab.equals(o.tab)||!p.tabContent&&!!o.tabContent||!!p.tabContent&&!p.tabContent.equals(o.tabContent)};n.prototype.$FantaTabMinimized2=function(){__p&&__p();var o=this.props,p=o.tab,q=o.tabContent,r=p.id;if(!q)return;var s=q.thread;if(!s)return;var t=this.refs.root&&c("ReactDOM").findDOMNode(this.refs.root);if(!t)return;var u=s.unread_count;if(u!==undefined){var v=!!u&&(!c("ChatBehavior").showsTabUnreadUI||c("ChatBehavior").showsTabUnreadUI());if(v)c("ChatTabBlinking").blinkTab(r,{getTabElem:function w(){return t},isFocused:function w(){return false},isHovered:function w(){return false}});else c("ChatTabBlinking").unblinkTab(r)}};n.prototype.render=function(){var o=this.props,p=o.tab,q=o.tabContent,r=q&&q.thread&&q.thread.custom_color,s=r?{color:r}:null,t=p.id,u=q&&!!q.thread&&c("FantaAvailableStatus").isAvailable(q.thread,t);return c("React").createElement("div",{className:"_4cd8 _50mz _50m_ fbNub _50-v"+(u?" _4-0b":"")+" _27_3",ref:"root"},c("React").createElement("div",{className:(this.state.closing?"_2suj":"")+" clearfix fbNubFlyoutTitlebar titlebar"+(!!r?" _1m34":""),style:s},c("React").createElement(c("ChatTabHeaderContainer.react"),{attachmentsShelf:document.createElement("div"),composer:q&&q.composer,isActive:false,isRaised:false,isTyping:false,membershipParticipants:q&&q.membershipParticipants,nameConversationFunc:c("emptyFunction"),onClick:this.$FantaTabMinimized3,onCloseClick:this.$FantaTabMinimized4,onRTCNuxCloseButtonClick:c("emptyFunction"),rtcNuxShown:false,sheetController:{},showAddFriend:c("emptyFunction"),threadID:this.props.tab.id,viewer:c("CurrentUser").getID()})))};n.prototype.$FantaTabMinimized5=function(){__p&&__p();var o=this.props.tab,p=c("ReactDOM").findDOMNode(this.refs.root);this.$FantaTabMinimized1=setTimeout(function(){return c("FantaTabActions").closeAndTabNext(o.id)},1.2*c("ifRequired")("cssVar",function(r){return"200ms".replace(l,"")},function(){return 200}));var q=c("Event").listen(p,c("getVendorPrefixedEventName")("animationend"),function(r){if(r.animationName==="closeChatTab"){c("FantaTabActions").closeAndTabNext(o.id);clearTimeout(this.$FantaTabMinimized1);q.remove()}}.bind(this));this.setState({closing:true})};n.prototype.$FantaTabMinimized6=function(){var o=this.props.tab,p=i._("Are you sure you want to close this chat window?");c("FantaTabActions").blurTab(o.id);var q=i._("You haven't sent your message.");c("SimpleXUIDialog").showConfirm(p,q,function(r){if(r)c("FantaTabActions").closeAndTabNext(o.id);else c("FantaTabActions").focusTab(o.id)},{autofocusConfirm:true,useReactFocusBehavior:true})};n.propTypes={tab:m.object.isRequired,tabContent:m.object};f.exports=n}),null);
__d("FantaMercuryTabsWithMain.react",["Bootloader","CurrentUser","FantaAppStore","FantaCookieUtil","FantaMercuryTabOverflowBootloader.react","FantaTabActions","FantaTabGroup.react","FantaTabMainLoader.react","FantaTabMinimized.react","FluxContainer","LazyComponent.react","LoadOnRender.react","MercuryIDs","MessengerState.bs","PresenceState","React"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=c("MessengerState.bs").jsComponent,k=function k(m){c("Bootloader").loadModules(["MessengerReasonDialogContainerReact.bs"],function(n){var o=n.jsComponent;return m(o)},"FantaMercuryTabsWithMain.react")};h=babelHelpers.inherits(l,c("React").PureComponent);i=h&&h.prototype;l.getStores=function(){return[c("FantaAppStore")]};l.calculateState=function(){return{tabGroup:c("FantaAppStore").getState().tabGroup,tabContents:c("FantaAppStore").getState().mercury.tabContents}};l.prototype.componentDidMount=function(){if(this.props.loadDataOnMount)c("FantaTabActions").loadFromData(c("FantaCookieUtil").convertCookieData(c("PresenceState").get()))};l.prototype.render=function(){return c("React").createElement(j,{fbid:c("CurrentUser").getID()},function(m){return[c("React").createElement(c("FantaTabGroup.react"),{key:"tabgroup",messengerState:m,MainComponent:c("FantaTabMainLoader.react"),MinimizedComponent:c("FantaTabMinimized.react"),OverflowComponent:c("FantaMercuryTabOverflowBootloader.react"),tabGroup:this.state.tabGroup,tabContents:this.state.tabContents,isLastOfTypeChecker:this.$FantaMercuryTabsWithMain1}),c("React").createElement(c("LoadOnRender.react"),{key:"dialog",component:c("React").createElement(c("LazyComponent.react"),null),loader:k,placeholder:c("React").createElement("span",null)})]}.bind(this))};l.prototype.$FantaMercuryTabsWithMain1=function(m){return c("MercuryIDs").isGroupChat(m.id)};function l(){h.apply(this,arguments)}f.exports=c("FluxContainer").create(l)}),null);
__d("FantaTabsReactApp",["ChatPerfInstrumentation","FantaMercuryTabsWithMain.react","FantaTabsAppBase","React","ReactDOM","WorkplaceChatHelper","setImmediate"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=void 0;h=babelHelpers.inherits(k,c("FantaTabsAppBase"));i=h&&h.prototype;k.prototype.initializeFantaData=function(l){__p&&__p();if(c("WorkplaceChatHelper").suppressChatIfActiveOnDesktop())return;e(["FantaAppStore","FantaCookieUtil","FantaGetMessageActions","FantaTabActions","MercuryThreadInformer","PresenceState"],function(m,n,o,p,q,r){__p&&__p();p.loadFromData(n.convertCookieData(r.get(),null,l));r.registerStateLoader(function(s){p.loadFromData(n.convertCookieData(s,m.getState().tabGroup,l))});r.registerStateStorer(function(s){var t=m.getState().tabGroup;if(!j||j&&!j.equals(t)){j=t;return n.createCookieData(t,s)}else return s});q.get().subscribe("threads-updated",function(s,t){Object.keys(t).forEach(function(u){c("setImmediate")(function(){o.refreshThread(u)})})});c("ChatPerfInstrumentation").logInitData()})};k.prototype.initializeFantaUI=function(){__p&&__p();e(["FantaAppStore","FantaMercuryThreadEventsBootloaded","FantaMessageActions","FantaTabActions","FantaTabViewportManager","FBRTCMessageHandler","MercuryBrowserAlerts"],function(l,m,n,o,p,q,r){__p&&__p();q.init();r.init();c("ReactDOM").render(this.getViewComponent(),this.tabsElem);m.onMessagesReceived(function(t,u){c("setImmediate")(function(){n.receivedNewMessage(t,u)})});p.init(this.tabsElem);c("ChatPerfInstrumentation").logInitUI();var s=l.getState().tabGroup.tabs;if(s.toArray().length===0)c("ChatPerfInstrumentation").logDisplayDone()}.bind(this))};k.prototype.getViewComponent=function(){return c("React").createElement(c("FantaMercuryTabsWithMain.react"),{loadDataOnMount:false})};function k(){h.apply(this,arguments)}f.exports=new k()}),null);
__d("ChatInitialDataTransformer.bs",["bs_array","bs_js_dict","bs_caml_array","bs_caml_format","MessengerServerPayloadTransformer.bs"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i){__p&&__p();var j=i.viewer,k=i.is_page,l=[],m=[],n={},o=[],p={},q=[];c("bs_array").iter(function(r){__p&&__p();if(r==null)return 0;else{var s=c("MessengerServerPayloadTransformer.bs").getThreadFBID(r),t=c("MessengerServerPayloadTransformer.bs").getOtherUserID(r),u=c("MessengerServerPayloadTransformer.bs").transformThread(j,r,k);l.push(u);var v=c("MessengerServerPayloadTransformer.bs").transformMessages(j,r,k);if(v)c("bs_array").iter(function(E){m.push(E);return 0},v[0]);var w=c("MessengerServerPayloadTransformer.bs").getMessagePageInfo(r);if(w)if(!w[0].has_previous_page)if(s==null){if(!(t==null))q.push({type:"thread",fbid:t})}else q.push({type:"thread",fbid:s});var x=c("MessengerServerPayloadTransformer.bs").transformReadReceipts(j,r);if(x){var y=x[0];if(!(s==null))n[s]=y;if(!(t==null))n[t]=y}var z=c("MessengerServerPayloadTransformer.bs").transformDeliveryReceipts(r);if(z.length>=1){var A=c("bs_caml_array").caml_array_get(z,0);if(u.is_canonical){var B=u.other_user_fbid;if(!(B==null))o.push({other_user_fbid:B,thread_fbid:null,time:c("bs_caml_format").caml_float_of_string(A.timestamp_precise)})}else{var C=u.thread_fbid;if(!(C==null))o.push({other_user_fbid:null,thread_fbid:C,time:c("bs_caml_format").caml_float_of_string(A.timestamp_precise)})}}var D=c("MessengerServerPayloadTransformer.bs").transformParticipants(r);return c("bs_array").iter(function(E){p[E.fbid]=E;return 0},D)}},i.threads);return{threads:l,actions:m,roger:n,delivery_receipts:o,participants:c("bs_js_dict").values(p),end_of_history:q}}g.transform=h}),null);