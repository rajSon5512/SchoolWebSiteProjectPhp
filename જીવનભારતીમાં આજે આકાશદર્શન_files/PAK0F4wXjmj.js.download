if (self.CavalryLogger) { CavalryLogger.start_js(["5gSJD"]); }

__d("PinnedConversationNubsActionTaken",[],(function a(b,c,d,e,f,g){f.exports={TAB_CLOSED_BY_USER:0,COMMENT_ADDED:1}}),null);
__d("BonfireFeatureGating",["gkx"],(function a(b,c,d,e,f,g){"use strict";var h={canReceiveBonfireRingInterop:function i(){return c("gkx")("AT67-yEeEisuZnuRf9ZZfe8uDaUmU0f8iOgZ8XTHAvRp7_a_JJm4LDabRivTtsii-tCqADjQbwZjHRWhjygfaDJN")}};f.exports=h}),null);
__d("NubController",["csx","ArbiterMixin","Dock"],(function a(b,c,d,e,f,g,h){__p&&__p();function i(){}Object.assign(i.prototype,c("ArbiterMixin"),{init:function j(k){this.el=k;this.nubButton=k.querySelector(".fbNubButton");this.closeButton=k.querySelector("._2dv8");c("Dock").registerNubController(k,this);if(this.closeButton)this.closeButton.addEventListener("click",this.hide.bind(this));return this},buttonContentChanged:function j(){this.inform("nub/button/content-changed")},flyoutContentChanged:function j(){this.inform("nub/flyout/content-changed")},hide:function j(){c("Dock").hide(this.el)},show:function j(){c("Dock").show(this.el)}});f.exports=i}),null);
__d("BuddyListNub",["csx","cx","fbt","Arbiter","AsyncRequest","AvailableList","BootloadedComponent.react","ChannelConnection","ChatOptions","ChatSidebarActions","ChatSidebarStore","ChatSidebarVisibility","ChatVisibility","CSS","Dock","DOM","Event","intlNumUtils","JSLogger","JSResource","KeyboardShortcuts","Keys","NubController","OrderedFriendsList","Parent","PresencePrivacy","PresenceStatus","PresenceUtil","React","ReactDOM","Run","SidebarType","Style","Toggler","emptyFunction"],(function a(b,c,d,e,f,g,h,i,j){__p&&__p();var k,l,m=40,n=253,o="285px",p=c("JSLogger").create("buddylist_nub");k=babelHelpers.inherits(q,c("NubController"));l=k&&k.prototype;function q(r,s,t,u){"use strict";__p&&__p();l.constructor.call(this);l.init.call(this,r);this.root=r;this.orderedList=s;this.button=c("DOM").find(r,"a.fbNubButton");this.unreadCount=c("DOM").find(r,"span._5ayx");this.label=c("DOM").find(r,"span.label");this.body=c("DOM").scry(r,"div.fbNubFlyoutBody")[0];this.container=c("Parent").bySelector(r,"._56ox");var v=c("DOM").find(r,"div.fbNubFlyoutTitlebar");c("Toggler").createInstance(v).setSticky(false);c("Toggler").createInstance(r).setSticky(true);if(u)c("Run").onAfterLoad(function(){this.dropdown=c("ReactDOM").render(c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("span",null),bootloadLoader:c("JSResource")("ChatSidebarDropdown.react").__setRef("BuddyListNub"),onToggleSidebar:function w(){},sidebarType:c("SidebarType").BUDDYLIST}),u)}.bind(this));s.subscribeOnce("render",this.flyoutContentChanged.bind(this));c("Run").onAfterLoad(function(){__p&&__p();var w=c("DOM").find(v,"div._4k48");if(w)c("ReactDOM").render(c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("span",null),bootloadLoader:c("JSResource")("ChatSidebarComposeLink.react").__setRef("BuddyListNub"),className:"_3a-4"}),w);var x=c("DOM").find(this.button,"div._1us9");if(x)c("ReactDOM").render(c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("span",null),bootloadLoader:c("JSResource")("ChatSidebarComposeLink.react").__setRef("BuddyListNub"),className:"_3a-4"}),x);var y=c("DOM").find(this.button,"div._1usa");if(y)c("ReactDOM").render(c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("span",null),bootloadLoader:c("JSResource")("ChatSidebarDropdown.react").__setRef("BuddyListNub"),onToggleSidebar:function B(){},sidebarType:c("SidebarType").BUDDYLIST_NUB}),y);var z=c("DOM").find(v,"div._3gl7");if(z)c("ReactDOM").render(c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("span",null),bootloadLoader:c("JSResource")("ChatSidebarGroupCreateButtonReactComponent").__setRef("BuddyListNub")}),z);var A=c("DOM").find(this.button,"div._3gll");if(A)c("ReactDOM").render(c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("span",null),bootloadLoader:c("JSResource")("ChatSidebarGroupCreateButtonReactComponent").__setRef("BuddyListNub"),className:"newGCF"}),A)}.bind(this));s.setScrollContainer(this.body);c("AvailableList").subscribe("buddylist/availability-changed",this._updateCount.bind(this));c("Arbiter").subscribe("chat/connect",function(){return this._handleConnect(true)}.bind(this));c("Arbiter").subscribe("chat/option-changed",function(w,x){if(x.name=="hide_groups")this.onResize();else if(x.name==="hide_buddylist")x.value?this.hide():this.show()}.bind(this));c("ChannelConnection").subscribe(c("ChannelConnection").CONNECTED,function(){return this._updateView()}.bind(this));c("ChannelConnection").subscribe(c("ChannelConnection").SHUTDOWN,function(){return this._updateView()}.bind(this));c("ChannelConnection").subscribe(c("ChannelConnection").RECONNECTING,function(){return this._updateView()}.bind(this));c("ChannelConnection").subscribe([c("ChannelConnection").MUTE_WARNING,c("ChannelConnection").UNMUTE_WARNING],function(){return this._updateView()}.bind(this));this.subscribe("show",this.onShow.bind(this));this.subscribe("hide",this.onHide.bind(this));this.subscribe("resize",this.onResize.bind(this));c("Event").listen(r,"keydown",this._onKeyDown.bind(this));c("Event").listen(this.button,"click",this.onButtonClick.bind(this));c("KeyboardShortcuts").register("q",function(event){if(!this._isOpen){this.onButtonClick();this.show()}event.prevent()}.bind(this),{persistOnTransition:true,shortcutInfo:{displayKeys:["q"],description:j._("Search chat contacts")}});c("Arbiter").subscribe("minisidebar/show",this.hide.bind(this));c("Arbiter").subscribe("sidebar/visibility",function(w,x){if(x)this.hide();else this._onSidebarHide()}.bind(this));c("Style").set(this.body,"min-height",o);c("Arbiter").subscribe("sidebar/typeahead/active",function(w,x){__p&&__p();if(x){this._typeaheadActive=true;c("CSS").hide(this.body.parentNode);this.orderedList.hide();this.onResize()}else{this._typeaheadActive=false;this.onResize();c("CSS").show(this.body.parentNode);this.orderedList.show()}}.bind(this));c("OrderedFriendsList").getList(function(w){if(c("ChatSidebarStore").isEnabled()&&c("ChatSidebarStore").getVisibleType()===c("SidebarType").BUDDYLIST&&!c("ChatOptions").getSetting("hide_buddylist")&&!c("ChannelConnection").disconnected()&&!c("PresencePrivacy").isUserOffline()&&w.length>0)this.show();c("Event").listen(v,"click",function(x){if(c("CSS").matchesSelector(x.target,".titlebarTextWrapper"))this._syncHideBuddylist(true)}.bind(this));this._updateView();p.log("buddylist_initialized")}.bind(this))}q.prototype._handleVisibilityChange=function(){"use strict";this._updateView();if(!c("ChatVisibility").isOnline())this.hide()};q.prototype._updateView=function(r){"use strict";__p&&__p();var s,t;if(!c("ChatVisibility").isOnline())s=j._("{Chat} (Off)",[j._param("Chat",j._("Chat"))]);else if(c("ChannelConnection").disconnected())s=j._("{Chat} (Disconnected)",[j._param("Chat",j._("Chat"))]);else{var u=c("PresenceStatus").getOnlineCount();if(u){var v=c("DOM").create("span",{className:"count"},"("+c("intlNumUtils").formatNumberWithThousandDelimiters(u)+")");s=j._({"*":"{Chat} {number-available}"},[j._param("Chat",j._("Chat")),j._param("number-available",v,[0,u])])}else{s=j._("Chat");t=true}}this._setPresenceIcon();this._setUnread();this._setLabel(s,t);this.buttonContentChanged()};q.prototype._setPresenceIcon=function(){"use strict";c("CSS").conditionClass(this.root,"offline",!c("ChatVisibility").isOnline()||c("ChannelConnection").disconnected())};q.prototype.onButtonClick=function(){"use strict";if(!c("ChatSidebarStore").isInitialized())return true;c("ChatSidebarVisibility").shouldShowSidebarIgnoreEnabled(null,function(r,s){var t=c("ChatSidebarStore").isEnabled();if(!t&&r)c("ChatSidebarActions").enable(c("SidebarType").SIDEBAR);else c("ChatSidebarActions").show(t&&r?c("SidebarType").SIDEBAR:c("SidebarType").BUDDYLIST)})};q.prototype.onHide=function(){"use strict";this._isOpen=false;if(this._buddyListRenderSubscription){this.orderedList.unsubscribe(this._buddyListRenderSubscription);this._buddyListRenderSubscription=null}this._hideBuddyList();c("Arbiter").inform("buddylist/hide")};q.prototype._onKeyDown=function(event){"use strict";var r=c("Event").getKeyCode(event);if(r===c("Keys").ESC&&!c("CSS").hasClass(this.root,"menuOpened")){this.hide();return false}else if(r==c("Keys").RETURN)c("ChatSidebarVisibility").shouldShowSidebarIgnoreEnabled(null,function(s,t){c("ChatSidebarActions").enable(s?c("SidebarType").SIDEBAR:c("SidebarType").BUDDYLIST)})};q.prototype._onSidebarHide=function(event){"use strict";c("OrderedFriendsList").getList(function(r){if(c("ChatSidebarStore").isEnabled()&&!c("ChatOptions").getSetting("hide_buddylist")&&!c("ChannelConnection").disconnected()&&!c("PresencePrivacy").isUserOffline()&&r.lenth>0)this.show();else this.hide()}.bind(this))};q.prototype.onResize=function(){"use strict";var r=!this._typeaheadActive?n:c("Dock").getMaxFlyoutHeight(this.root)-60;c("Arbiter").inform("buddyList/resized",r,c("Arbiter").BEHAVIOR_PERSISTENT);if(this._typeaheadActive)c("Style").set(this.body,"max-height","none");else c("Style").set(this.body,"max-height",o);var s=Math.max(250,r),t=Math.floor(s/m);this.orderedList.setNumTopFriends(t,false,c("SidebarType").BUDDYLIST)};q.prototype._showBuddyList=function(){"use strict";this._buddyListRenderSubscription=this.orderedList.subscribe("render",function(){if(c("Style").get(this.body,"height")!=o)c("Style").set(this.body,"height",o)}.bind(this));this.orderedList.show();p.bump("buddylist_show")};q.prototype._hideBuddyList=function(){"use strict";this.orderedList.hide();p.bump("buddylist_hide")};q.prototype.onShow=function(){"use strict";this._isOpen=true;if(c("ChannelConnection").disconnected()){c("ChannelConnection").reconnect();this._showBuddyList()}else c("ChatVisibility").goOnline(this._showBuddyList.bind(this));this._syncHideBuddylist(false)};q.prototype._setLabel=function(r,s){"use strict";var t=this.label.textContent||this.label.innerText;if(t!==r){var u=this.label.cloneNode(true);c("DOM").setContent(u,r);c("DOM").replace(this.label,u);this.label=u}this.throbber&&c("CSS").conditionShow(this.throbber,!!s)};q.prototype._setUnread=function(r){"use strict";c("CSS").conditionShow(this.unreadCount,!!r)};q.prototype._updateCount=function(){"use strict";this._updateView()};q.prototype._syncHideBuddylist=function(r){"use strict";c("ChatOptions").setSetting("hide_buddylist",r,"buddylist");new(c("AsyncRequest"))("/ajax/chat/settings.php").setHandler(c("emptyFunction")).setErrorHandler(c("emptyFunction")).setData({hide_buddylist:r,window_id:c("PresenceUtil").getSessionID()}).setAllowCrossPageTransition(true).send()};c("Arbiter").subscribe(c("JSLogger").DUMP_EVENT,function(r,s){s.buddylist_visible=c("ChatSidebarStore").getVisibleType()===c("SidebarType").BUDDYLIST});f.exports=q}),null);
__d("NotificationBeeperConst",["keyMirror"],(function a(b,c,d,e,f,g){var h={IDLE_DELAY:1e4,ACTIVE_DELAY_LONG:4e3,FADE_OUT_LENGTH:1500,BeepStates:c("keyMirror")({PENDING:true,RENDERED:true,READY_TO_HIDE:true,FADING_OUT:true})};f.exports=h}),null);
__d("NotificationBeeperItemCloseButton.react",["cx","fbt","React","XUIAbstractGlyphButton.react"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j,k;j=babelHelpers.inherits(l,c("React").Component);k=j&&j.prototype;l.prototype.render=function(){"use strict";var m=i._("Close");return c("React").createElement(c("XUIAbstractGlyphButton.react"),babelHelpers["extends"]({},this.props,{className:"_3soc",title:m,label:m,labelIsHidden:true}))};function l(){"use strict";j.apply(this,arguments)}f.exports=l}),null);
__d("NotificationURI",["BusinessURI.brands","URI","VideoPermalinkURI","isFacebookURI"],(function a(b,c,d,e,f,g){__p&&__p();var h={localize:function i(j){try{j=c("BusinessURI.brands")(j)}catch(k){return j.toString()}var l=j.getSubdomain();return j.getUnqualifiedURI().getQualifiedURI().setSubdomain(l).toString()},snowliftable:function i(j){if(!j)return false;var k=new(c("URI"))(j),l=k.getQueryData();return c("isFacebookURI")(k)&&(c("VideoPermalinkURI").isValid(k)||"fbid"in l)},isVaultSetURI:function i(j){return this._areEquals(j,"/ajax/vault/sharer_preview.php")},isAlbumDraftRecoveryDialogURI:function i(j){return this._areEquals(j,"/ajax/photos/upload/overlay/")},isQuicksilverURI:function i(j){return this._areEquals(j,"/games/quicksilver/spotlight/")},isDirectURI:function i(j){return this._startsWith(j,"/direct/")},isIGAccountCreationURI:function i(j){return this._areEquals(j,"/ads/growth/aymt/instagram/account-creation-dialog/")},_areEquals:function i(j,k){if(!j)return false;var l=new(c("URI"))(j);return c("isFacebookURI")(l)&&l.getPath()===k},_startsWith:function i(j,k){if(!j)return false;var l=new(c("URI"))(j);return c("isFacebookURI")(l)&&l.getPath().startsWith(k)}};f.exports=h}),null);
__d("XLiveVideoLoadController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/live/video/load/",{video_id:{type:"FBID",required:true}})}),null);
__d("NotificationListRendererUtils",["AsyncRequest","Bootloader","NotificationURI","PageTransitions","URI","VideoChainingCaller","XLiveVideoLoadController","idx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=10;function i(event,l){c("Bootloader").loadModules(["FBStoriesLiveNotificationHandler"],function(m){m.renderLiveStory(l)},"NotificationListRendererUtils")}function j(event,l,m){c("Bootloader").loadModules(["TahoeController"],function(n){var o,p=c("NotificationURI").localize(new(c("URI"))(m.url)),q=l.video_channel_caller;n.openFromVideoLink(new(c("URI"))(p),{channelID:l.video_channel_id,caller:q?(o=c("VideoChainingCaller"))!=null?o[q]:o:null})},"NotificationListRendererUtils")}var k={openNotification:function l(event,m){__p&&__p();var n=m.renderer_data;if(n==null)return;if(!k.isStoryOnlyLiveVideoNotification(m)&&(event.metaKey||event.ctrlKey||event.button===1))return;if(n.__typename==="LiveVideoNotificationRendererData"){event.preventDefault();var o=c("XLiveVideoLoadController").getURIBuilder().setFBID("video_id",n.video_id).getURI(),p=new(c("AsyncRequest"))(o).setHandler(function(q){if(q.payload)k.openNotificationInSurface(event,m);else c("PageTransitions").go(m.url)});p.send()}},openNotificationInSurface:function l(event,m){var n=m.renderer_data;if(n==null)return;if(n.bucket_data)i(event,n);else if(n.can_render_in_tahoe)j(event,n,m)},isStoryOnlyLiveVideoNotification:function l(m){var n=m.renderer_data;if(n==null)return false;return n.__typename==="LiveVideoNotificationRendererData"&&!!n.bucket_data}};f.exports=k}),null);
__d("RelationshipDelightTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:RelationshipDelightLoggerConfig",this.$RelationshipDelightTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:RelationshipDelightLoggerConfig",this.$RelationshipDelightTypedLogger1,c("Banzai").VITAL)};h.prototype.logImmediately=function(){c("GeneratedLoggerUtils").log("logger:RelationshipDelightLoggerConfig",this.$RelationshipDelightTypedLogger1,{signal:true})};h.prototype.clear=function(){this.$RelationshipDelightTypedLogger1={};return this};h.prototype.getData=function(){return babelHelpers["extends"]({},this.$RelationshipDelightTypedLogger1)};h.prototype.updateData=function(j){this.$RelationshipDelightTypedLogger1=babelHelpers["extends"]({},this.$RelationshipDelightTypedLogger1,j);return this};h.prototype.setAlertID=function(j){this.$RelationshipDelightTypedLogger1.alert_id=j;return this};h.prototype.setEvent=function(j){this.$RelationshipDelightTypedLogger1.event=j;return this};h.prototype.setMetadata=function(j){this.$RelationshipDelightTypedLogger1.metadata=j;return this};h.prototype.setVC=function(j){this.$RelationshipDelightTypedLogger1.vc=j;return this};var i={alert_id:true,event:true,metadata:true,vc:true};f.exports=h}),null);
__d("RelationshipDelightUtils",["NotificationRelationshipDelightsConfig","QE2Logger","RelationshipDelightTypedLogger"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={};function i(n){var o=n.eligible_buckets;return!!o&&o.indexOf("SO_NOTIFICATIONS")!==-1}function j(){c("QE2Logger").logExposureForUser(c("NotificationRelationshipDelightsConfig").universeName)}function k(n){var o=c("NotificationRelationshipDelightsConfig").shouldDecorateNotificationWithHearts,p=c("NotificationRelationshipDelightsConfig").shouldLogExposureForNotification;if(i(n)===false)return false;if(p)j();return o===true}function l(n,event,o){var p=event+"-"+n;if(h[p])return;h[p]=true;var q=new(c("RelationshipDelightTypedLogger"))().setEvent(event).setAlertID(n);if(o)q.setMetadata(JSON.stringify(o));q.log()}var m={shouldHeartBadge:function n(o){var p=c("NotificationRelationshipDelightsConfig").shouldDecorateBadgeWithHearts,q=c("NotificationRelationshipDelightsConfig").shouldLogExposureForBadge;if(i(o)===false)return false;if(q)j();return p===true},shouldHeartBeeper:k,shouldHeartNotification:k,logNotificationAnimation:function n(o,p,q){l(o,"notification_animated",{animation:p,rowIndex:q})},logBeeperAnimation:function n(o){l(o,"beeper_animated")},logBadgeAnimation:function n(o){l(o,"badge_animated")}};f.exports=m}),null);
__d("NotificationBeeperItemContents.react",["cx","Animation","AsyncRequest","BootloadedComponent.react","Bootloader","FBProfilePhotoShadow.react","Image.react","ImageBlock.react","JSResource","NotificationBeeperItemCloseButton.react","NotificationInterpolator","NotificationListRendererUtils","NotificationURI","NotificationUserActions","React","ReactDOM","RelationshipDelightUtils","TextWithEntities.react","Timestamp.react","URI"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j;i=babelHelpers.inherits(k,c("React").Component);j=i&&i.prototype;function k(){__p&&__p();var l,m;"use strict";for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=j.constructor).call.apply(l,[this].concat(o)),this.isLiveVideo=null,this.$NotificationBeeperItemContents2=function(q){__p&&__p();this.$NotificationBeeperItemContents1();this.props.onHide();if(q.button===1||q.altKey||q.ctrlKey||q.metaKey||q.shiftKey)return;var r=this.props.notification;c("NotificationListRendererUtils").openNotification(q,r);if(q.isDefaultPrevented()===true)return;var s=r.primerAttributes;if(s&&(s.rel==="async"||s.rel==="async-post")){var t=new(c("AsyncRequest"))(s.ajaxify||r.url);if(s.rel==="async-post")t.setMethod("POST");t.send();q.preventDefault()}else if(s&&s.rel==="theater"){q.persist();c("Bootloader").loadModules(["PhotoSnowlift"],function(u){u.bootstrap(s.ajaxify||r.url,q.currentTarget)},"NotificationBeeperItemContents.react");q.preventDefault()}else if(s&&(s.rel==="dialog"||s.rel==="dialog-post")){c("Bootloader").loadModules(["AsyncDialog"],function(u){u.bootstrap(s.ajaxify||r.url,q.currentTarget,"dialog")},"NotificationBeeperItemContents.react");q.preventDefault()}}.bind(this),this.$NotificationBeeperItemContents3=function(){this.$NotificationBeeperItemContents1();this.props.onHide()}.bind(this),m}k.prototype.$NotificationBeeperItemContents1=function(){"use strict";c("NotificationUserActions").markNotificationsAsRead([this.props.notification.alert_id])};k.prototype.$NotificationBeeperItemContents4=function(){"use strict";new(c("Animation"))(c("ReactDOM").findDOMNode(this.refs.inner)).from("opacity","0").to("opacity","1").duration(200).go()};k.prototype.$NotificationBeeperItemContents5=function(){"use strict";var l=this.$NotificationBeeperItemContents6(),m=JSON.parse(l);return m.content_id};k.prototype.$NotificationBeeperItemContents7=function(){"use strict";if(this.isLiveVideo===null){var l=this.$NotificationBeeperItemContents6();this.isLiveVideo=l.indexOf("live_video")!==-1}return!!this.isLiveVideo};k.prototype.$NotificationBeeperItemContents6=function(){"use strict";return this.props.notification.tracking||"{}"};k.prototype.$NotificationBeeperItemContents8=function(){"use strict";var l=this.props.notification,m=c("RelationshipDelightUtils").shouldHeartBeeper(l);if(!m)return null;c("RelationshipDelightUtils").logBeeperAnimation(l.alert_id);return c("React").createElement("div",{className:"_5_xp"},c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("div",null),bootloadLoader:c("JSResource")("RelationshipDelightsActorAnimation.react").__setRef("NotificationBeeperItemContents.react")}))};k.prototype.componentDidMount=function(){"use strict";this.props.onReadyToHide(this.props.notification.alert_id);if(this.$NotificationBeeperItemContents7())c("Bootloader").loadModules(["VideoPlayerMetaData","PhotoSnowliftVideoNode"],function(l,m){var n=this.$NotificationBeeperItemContents5();if(n)l.genVideoData(n)}.bind(this),"NotificationBeeperItemContents.react")};k.prototype.componentDidUpdate=function(l){"use strict";if(l.notification.alert_id!==this.props.notification.alert_id||l.notification.creation_time!==this.props.notification.creation_time){this.$NotificationBeeperItemContents4();this.props.onReadyToHide(this.props.notification.alert_id)}};k.prototype.render=function(){"use strict";var l=this.props.notification,m=l.thumbnail?l.thumbnail.uri:null,n=l.icon?l.icon.uri:null,o=c("NotificationURI").localize(new(c("URI"))(l.url));return c("React").createElement("div",{ref:"inner",className:this.props.className},c("React").createElement(c("NotificationBeeperItemCloseButton.react"),{onClick:this.$NotificationBeeperItemContents3}),c("React").createElement("a",{href:o,onClick:this.$NotificationBeeperItemContents2,className:"_3soi"},c("React").createElement(c("ImageBlock.react"),{className:"_3soj",spacing:"medium"},c("React").createElement(c("FBProfilePhotoShadow.react"),{className:"_2yt7"},c("React").createElement(c("Image.react"),{src:m,className:"_3sok"+(!m?" hidden_elem":"")})),c("React").createElement("div",{className:"_3sol"},c("React").createElement(c("TextWithEntities.react"),{renderEmoticons:true,renderEmoji:true,interpolator:c("NotificationInterpolator"),ranges:l.title.ranges,aggregatedranges:l.title.aggregated_ranges,text:l.title.text}),c("React").createElement(c("ImageBlock.react"),{className:"_3som"},c("React").createElement(c("Image.react"),{className:"_1x8t"+(!n?" hidden_elem":""),src:n}),c("React").createElement(c("Timestamp.react"),{time:l.timestamp.time,text:l.timestamp.text,verbose:l.timestamp.verbose})))),this.$NotificationBeeperItemContents8()))};f.exports=k}),null);
__d("NotificationBeeperItem.react",["cx","CSSFade","NotificationBeeperConst","NotificationBeeperItemContents.react","NotificationBeeperItemRenderersList","React","ReactDOM","Style","setTimeoutAcrossTransitions"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("NotificationBeeperConst").FADE_OUT_LENGTH;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(){var m,n;"use strict";for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={encounteredException:false,fadedIn:false,hidden:false},this.$NotificationBeeperItem3=function(){this.setState({hidden:true})}.bind(this),n}l.prototype.componentDidCatch=function(){"use strict";this.props.onReadyToHide(this.props.notification.alert_id);this.setState(function(m){return babelHelpers["extends"]({},m,{encounteredException:true})})};l.prototype.componentDidMount=function(){"use strict";c("setTimeoutAcrossTransitions")(function(){this.setState({fadedIn:true})}.bind(this),50);this.props.onInserted(this.props.notification.alert_id)};l.prototype.componentWillUnmount=function(){"use strict";if(this.$NotificationBeeperItem1)this.$NotificationBeeperItem1.cancel()};l.prototype.render=function(){"use strict";if(this.state.encounteredException)return null;var m=this.props.notification,n=m.renderer_data,o=m.tracking,p=this.$NotificationBeeperItem4(n);return c("React").createElement("li",{className:this.state.hidden?"hidden_elem":"",ref:function(q){return this.$NotificationBeeperItem2=q}.bind(this),"data-gt":o},c("React").createElement(p,{className:"_3sod"+(this.state.fadedIn?" _3soe":""),notification:this.props.notification,onHide:this.$NotificationBeeperItem3,onReadyToHide:this.props.onReadyToHide,onPreventHide:this.props.onPreventHide}))};l.prototype.componentDidUpdate=function(m,n,o){"use strict";__p&&__p();if(!this.$NotificationBeeperItem2)return;var p=c("ReactDOM").findDOMNode(this.$NotificationBeeperItem2);if(!p)return;if(this.props.fadingOut){this.$NotificationBeeperItem1=c("CSSFade").hide(p,{callback:this.$NotificationBeeperItem3,duration:k});p.style.transitionDuration="0ms"}else{if(this.$NotificationBeeperItem1){this.$NotificationBeeperItem1.cancel();this.$NotificationBeeperItem1=undefined}c("Style").set(p,"opacity","1")}};l.prototype.$NotificationBeeperItem4=function(m){"use strict";if(m&&m.__typename==="LiveVideoNotificationRendererData"&&m.video_id==null)return c("NotificationBeeperItemContents.react");return c("NotificationBeeperItemRenderersList")[m&&m.__typename]||c("NotificationBeeperItemContents.react")};f.exports=l}),null);
__d("NotificationImpressions",["AsyncSignal","NotificationTokens","URI"],(function a(b,c,d,e,f,g){var h="/ajax/notifications/impression.php";function i(j,k){var l={ref:k};c("NotificationTokens").untokenizeIDs(j).forEach(function(m,n){l["alert_ids["+n+"]"]=m});new(c("AsyncSignal"))(new(c("URI"))(h).getQualifiedURI().toString(),l).send()}f.exports={log:i}}),null);
__d("SoundPlayer",["URI","createArrayFromMixed"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=new Map();function i(l){var m=new(c("URI"))(l);return m.getDomain()?l:new(c("URI"))(window.location.href).setPath(m.getPath()).toString()}function j(l){var m=new(c("URI"))(l).getPath();if(/\.mp3$/.test(m))return"audio/mpeg";if(/\.og[ga]$/.test(m))return"audio/ogg";return""}var k={preload:function l(m){__p&&__p();for(var n=c("createArrayFromMixed")(m),o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var q;if(o){if(p>=n.length)break;q=n[p++]}else{p=n.next();if(p.done)break;q=p.value}var r=q;if(h.has(r))return;var s=document.createElement("audio");if(!s||!s.canPlayType||!s.canPlayType(j(r)))continue;s.preload="auto";s.src=i(r);document.body&&document.body.appendChild(s);h.set(r,s);return}},play:function l(m){__p&&__p();var n=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];for(var o=c("createArrayFromMixed")(m),p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var r;if(p){if(q>=o.length)break;r=o[q++]}else{q=o.next();if(q.done)break;r=q.value}var s=r;if(!h.has(s))k.preload(s);var t=h.get(s);if(!t)continue;if(n.loop)t.setAttribute("loop","");if(n.volume)t.volume=n.volume;t.play();return}},pause:function l(m){__p&&__p();for(var n=c("createArrayFromMixed")(m),o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var q;if(o){if(p>=n.length)break;q=n[p++]}else{p=n.next();if(p.done)break;q=p.value}var r=q,s=h.get(r);if(s){s.pause();return}}},stop:function l(m){__p&&__p();for(var n=c("createArrayFromMixed")(m),o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var q;if(o){if(p>=n.length)break;q=n[p++]}else{p=n.next();if(p.done)break;q=p.value}var r=q,s=h.get(r);if(s){s.pause();s.removeAttribute("src");s.src=i(r);return}}}};f.exports=k}),null);
__d("SoundSynchronizer",["SoundPlayer","WebStorage","createArrayFromMixed"],(function a(b,c,d,e,f,g){__p&&__p();var h="fb_sounds_playing3";function i(){__p&&__p();var m=c("WebStorage").getLocalStorage();if(m)try{var n=m[h];if(n){n=JSON.parse(n);if(Array.isArray(n))return n}}catch(o){}return[]}function j(m){var n=c("WebStorage").getLocalStorage();if(n){var o=i();o.push(m);while(o.length>5)o.shift();try{n[h]=JSON.stringify(o)}catch(p){}}}function k(m){return i().some(function(n){return n===m})}var l={play:function m(n,o,p){n=c("createArrayFromMixed")(n);o=o||n[0]+Math.floor(Date.now()/1e3);if(k(o))return;c("SoundPlayer").play(n,{loop:!!p});j(o)},isSupported:function m(){return!!c("WebStorage").getLocalStorage()}};f.exports=l}),null);
__d("SoundRPC",["Event","FBJSON","SoundSynchronizer"],(function a(b,c,d,e,f,g){__p&&__p();function h(j,k,l){c("SoundSynchronizer").play(j,k,l)}var i={playLocal:h,playRemote:function j(k,l,m,n){var o={name:"SoundRPC",data:{paths:l,sync:m,loop:n}};k.postMessage(c("FBJSON").stringify(o),"*")},supportsRPC:function j(){return!!window.postMessage},_listen:function j(){c("Event").listen(window,"message",function(k){if(!/\.facebook.com$/.test(k.origin))return;var l={};try{l=c("FBJSON").parse(k.data)}catch(m){}if(l.name==="SoundRPC")h(l.data.paths,l.data.sync,l.data.loop)})}};f.exports=i}),null);
__d("Sound",["SoundInitialData","SoundPlayer","SoundRPC","SoundSynchronizer","URI","UserAgent_DEPRECATED","Visibility","isFacebookURI"],(function a(b,c,d,e,f,g){__p&&__p();var h=null,i=false,j={init:function n(o){},play:function n(o,p,q){if(h)c("SoundRPC").playRemote(h.contentWindow,o,p,false);else c("SoundRPC").playLocal(o,p,q);i=true},hasPlayedSoundBefore:function n(){return i},playOnlyIfImmediate:function n(o,p,q){if(!i&&c("Visibility").isHidden())return;this.play(o,p,q)},stop:function n(o){if(!h)c("SoundPlayer").stop(o)}},k=new(c("URI"))(location.href);if(k.getSubdomain()&&k.getSubdomain()!=="www")k.setSubdomain("www");var l=k.getDomain();function m(){if(c("UserAgent_DEPRECATED").ie()<9)return false;if(c("SoundInitialData").RPC_DISABLED)return false;return c("SoundSynchronizer").isSupported()&&c("SoundRPC").supportsRPC()}if(c("isFacebookURI")(k)&&location.host!==l&&m()){h=document.createElement("iframe");h.setAttribute("src","//"+l+"/sound_iframe.php");h.style.display="none";document.body.appendChild(h)}f.exports=j}),null);
__d("NotificationSound",["Sound"],(function a(b,c,d,e,f,g){__p&&__p();var h=5e3;c("Sound").init(["audio/mpeg"]);function i(j){this._soundPath=j;this._lastPlayed=0}Object.assign(i.prototype,{play:function j(k){if(!this._soundPath)return;var l=Date.now();if(l-this._lastPlayed<h)return;this._lastPlayed=l;c("Sound").playOnlyIfImmediate(this._soundPath,k)}});f.exports=i}),null);
__d("NotificationBeeper.react",["cx","Arbiter","ChannelConstants","FacebookWebNotificationsSubscription","NotificationBeeperConst","NotificationBeeperItem.react","NotificationConstants","NotificationImpressions","NotificationSound","NotificationUpdates","NotificationUserActions","NotifTestIDs","React","SubscriptionsHandler","clearTimeout","setTimeoutAcrossTransitions","shield"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("NotificationBeeperConst").ACTIVE_DELAY_LONG,l=c("NotificationBeeperConst").BeepStates,m=c("NotificationBeeperConst").FADE_OUT_LENGTH,n=c("NotificationBeeperConst").IDLE_DELAY,o="beeper",p=c("NotificationConstants").PayloadSourceType,q=p.CLIENT,r=p.OTHER_APPLICATION;i=babelHelpers.inherits(s,c("React").Component);j=i&&i.prototype;function s(){__p&&__p();var t,u;"use strict";for(var v=arguments.length,w=Array(v),x=0;x<v;x++)w[x]=arguments[x];return u=(t=j.constructor).call.apply(t,[this].concat(w)),this.state={beeps:{},fading:false,hovering:false,soundEnabled:this.props.soundEnabled},this.onMouseEnter=function(){this.$NotificationBeeper2&&c("clearTimeout")(this.$NotificationBeeper2);var y=[],z=this.state.beeps;Object.keys(z).forEach(function(A){if(z[A].state!=l.PENDING)y.push(A);else z[A].state=l.RENDERED});c("NotificationUserActions").markNotificationsAsSeen(y);this.setState({hovering:true,fading:false,beeps:z})}.bind(this),this.onMouseLeave=function(){this.$NotificationBeeper5(k);this.setState({hovering:false})}.bind(this),this.$NotificationBeeper6=function(y){if(!this.state.hovering)this.$NotificationBeeper5();if(this.state.soundEnabled&&this.state.beeps[y].shouldPlaySound){if(!this.$NotificationBeeper3)this.$NotificationBeeper3=new(c("NotificationSound"))(this.props.soundPath);this.$NotificationBeeper3.play(y)}if(this.props.shouldLogImpressions)c("NotificationImpressions").log([y],o)}.bind(this),this.onReadyToHide=function(y,z){this.setState(function(A){var B=babelHelpers["extends"]({},A.beeps);B[y]=babelHelpers["extends"]({},B[y],{state:l.READY_TO_HIDE});return babelHelpers["extends"]({},A,{beeps:B})});if(!this.$NotificationBeeper2)this.$NotificationBeeper5(z)}.bind(this),this.$NotificationBeeper8=function(y){this.setState(function(z){var A=babelHelpers["extends"]({},z.beeps);A[y]=babelHelpers["extends"]({},A[y],{state:l.RENDERED});return babelHelpers["extends"]({},z,{beeps:A})})}.bind(this),this.$NotificationBeeper7=function(){this.$NotificationBeeper2=null;this.setState(function(y){var z=babelHelpers["extends"]({},y.beeps);Object.keys(z).forEach(function(A){if(z[A].state==l.READY_TO_HIDE)z[A]=babelHelpers["extends"]({},z[A],{state:l.FADING_OUT})});return babelHelpers["extends"]({},y,{beeps:z,fading:true})});c("setTimeoutAcrossTransitions")(c("shield")(this.$NotificationBeeper9,this),m)}.bind(this),this.$NotificationBeeper9=function(){__p&&__p();if(!this.state.fading)return;this.setState(function(y){var z=babelHelpers["extends"]({},y.beeps);Object.keys(z).forEach(function(A){if(z[A].state==l.FADING_OUT)delete z[A]});return babelHelpers["extends"]({},y,{beeps:z,fading:false})});c("setTimeoutAcrossTransitions")(function(){this.setState(function(y){var z=babelHelpers["extends"]({},y.beeps);Object.keys(z).forEach(function(A){if(z[A].state==l.PENDING)z[A]=babelHelpers["extends"]({},z[A],{state:l.RENDERED})});return babelHelpers["extends"]({},y,{beeps:z})})}.bind(this))}.bind(this),u}s.prototype.UNSAFE_componentWillMount=function(){"use strict";__p&&__p();var t=new(c("SubscriptionsHandler"))();t.addSubscriptions(c("NotificationUpdates").subscribe("update-notifications",function(u,v){if(v.payloadsource===r||v.payloadsource===q){var w=v.nodes;if(w&&w.length)this.handleBeepChanges(this.$NotificationBeeper4(w))}}.bind(this)),c("Arbiter").subscribe(c("ChannelConstants").getArbiterType("notif_sound_pref_changed"),function(u,v){this.setState({soundEnabled:v.obj.enabled})}.bind(this)));t.addSubscriptions(c("FacebookWebNotificationsSubscription").subscribe({event:"NEW_BEEPER",callback:function(u){var v=u.notification,w=u.should_play_sound;if(v!==null){var x;this.handleBeepChanges((x={},x[v.alert_id]={notification:v,shouldPlaySound:w},x))}}.bind(this)}));this.$NotificationBeeper1=t;c("Arbiter").inform("NotificationBeeper/mounted",null,c("Arbiter").BEHAVIOR_PERSISTENT)};s.prototype.componentWillUnmount=function(){"use strict";if(this.$NotificationBeeper1)this.$NotificationBeeper1.release();this.$NotificationBeeper1=null};s.prototype.$NotificationBeeper5=function(t){"use strict";this.$NotificationBeeper2&&c("clearTimeout")(this.$NotificationBeeper2);this.$NotificationBeeper2=c("setTimeoutAcrossTransitions")(c("shield")(this.$NotificationBeeper7,this),t==null?n:t)};s.prototype.handleBeepChanges=function(t){"use strict";__p&&__p();var u=this.state.fading?l.PENDING:l.RENDERED,v=false,w=babelHelpers["extends"]({},this.state.beeps);Object.keys(t).reverse().forEach(function(x){var y=t[x],z=w[x];if(!z||z.notification.alert_id!==y.notification.alert_id||z.notification.creation_time!==y.notification.creation_time){if(z){v=true;delete w[x]}w[x]=babelHelpers["extends"]({},y,{state:u})}});if(v)this.$NotificationBeeper5();this.setState({beeps:w})};s.prototype.render=function(){"use strict";var t=this.state.beeps,u=[];Object.keys(t).reverse().forEach(function(x){var y=t[x];if(y.state==l.PENDING)return;u.push(c("React").createElement(c("NotificationBeeperItem.react"),{key:x,fadingOut:this.state.fading&&y.state==l.FADING_OUT,notification:y.notification,onInserted:this.$NotificationBeeper6,onReadyToHide:this.onReadyToHide,onPreventHide:this.$NotificationBeeper8}))}.bind(this),this);var v=u.length>0,w=(!v?"hidden_elem":"")+" _50d1";return c("React").createElement("ul",{ref:"container",className:w,"data-gt":this.props.tracking,"data-testid":c("NotifTestIDs").BEEPER_LIST,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u)};s.prototype.$NotificationBeeper4=function(t){"use strict";return t.reduce(function(u,v){u[v.alert_id]={notification:v,shouldPlaySound:false};return u},{})};f.exports=s}),null);
__d("NotificationBeeperContainer",["NotificationBeeper.react","React","ReactDOM"],(function a(b,c,d,e,f,g){var h={renderBeeper:function i(j,k){c("ReactDOM").render(c("React").createElement(c("NotificationBeeper.react"),j),k)}};f.exports=h}),null);
__d("LiveVideoBeeperItemContents.react",["BootloadOnRender.react","JSResource","LazyComponent.react","React"],(function a(b,c,d,e,f,g){"use strict";var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;j.prototype.render=function(){return c("React").createElement(c("BootloadOnRender.react"),{loader:c("JSResource")("LiveVideoBeeperItemContentsImpl.react").__setRef("LiveVideoBeeperItemContents.react"),placeholder:c("React").createElement("div",null),component:c("React").createElement(c("LazyComponent.react"),babelHelpers["extends"]({},this.props,{ref:"itemContents"}))})};function j(){h.apply(this,arguments)}f.exports=j}),null);
__d("ConversationNubAddTabSource",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({NOTIFICATION:"notification",PAGE_REFRESH:"page_refresh",USER_PIN:"user_pin",UNSEEN_NOTIFICATION:"unseen_notification",UNKNOWN:"unknown"})}),null);
__d("ConversationNubTabStateListStorage",[],(function a(b,c,d,e,f,g){"use strict";function h(){this.$ConversationNubTabStateListStorage1=[]}h.prototype.modify=function(i){this.$ConversationNubTabStateListStorage1=i(this.$ConversationNubTabStateListStorage1)};h.prototype.getData=function(){return this.$ConversationNubTabStateListStorage1};f.exports=h}),null);
__d("differenceSets",["filterSet"],(function a(b,c,d,e,f,g){"use strict";function h(i){for(var j=arguments.length,k=Array(j>1?j-1:0),l=1;l<j;l++)k[l-1]=arguments[l];return c("filterSet")(i,function(m){return!k.some(function(n){return n.has(m)})})}f.exports=h}),null);
__d("ConversationNubTabStateList",["invariant","ConversationNubTabStateListStorage","differenceSets"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();function i(){this.$ConversationNubTabStateList2=new Set();this.$ConversationNubTabStateList1=new(c("ConversationNubTabStateListStorage"))()}i.prototype.modifyTabState=function(j,k){this.modifyTabs(function(l){var m=l.findIndex(function(n){return n.tabID===j});m!==-1||h(0);k(l[m]);return l})};i.prototype.$ConversationNubTabStateList3=function(j){return new Set(j.map(function(k){return k.tabID}))};i.prototype.modifyTabs=function(j){try{this.$ConversationNubTabStateList1.modify(function(k){var l=this.$ConversationNubTabStateList3(k),m=j(k),n=this.$ConversationNubTabStateList3(m);this.$ConversationNubTabStateList2=c("differenceSets")(l,n);return m}.bind(this))}finally{this.$ConversationNubTabStateList2=new Set()}};i.prototype.getTabs=function(){return this.$ConversationNubTabStateList1.getData()};i.prototype.getTabState=function(j){var k=this.getTabStateIfExists(j);k||h(0);return k};i.prototype.getTabStateIfExists=function(j){return this.getTabs().find(function(k){return k.tabID===j})};i.prototype.push=function(){for(var j=arguments.length,k=Array(j),l=0;l<j;l++)k[l]=arguments[l];this.modifyTabs(function(m){k.forEach(function(n){if(m.find(function(o){return o.tabID===n.tabID}))h(0);else m.push(n)});return m})};i.prototype.remove=function(j){this.modifyTabs(function(k){var l=k.findIndex(function(m){return m.tabID===j});if(l!==-1)k.splice(l,1);return k})};f.exports=i}),null);
__d("ConversationNubTabState",["invariant","ConversationNubTabStateList"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=12;function j(){this.$ConversationNubTabStateClass1=Object.create(null);this.$ConversationNubTabStateClass2=new(c("ConversationNubTabStateList"))();this.$ConversationNubTabStateClass3=Infinity}j.prototype.anyTabHasFocus=function(){return this.getUnsortedLoadedTabs().some(function(k){return k.getIsFocused()})};j.prototype.anyTabHasText=function(){return this.getUnsortedLoadedTabs().some(function(k){return k.getHasText()})};j.prototype.getTabState=function(k){return this.$ConversationNubTabStateClass2.getTabState(k)};j.prototype.getTabStateIfExists=function(k){return this.$ConversationNubTabStateClass2.getTabStateIfExists(k)};j.prototype.getUnloadedTabs=function(){var k=this.$ConversationNubTabStateClass2.getTabs().filter(function(l){return!this.getLoadedTab(l.tabID)}.bind(this));return k};j.prototype.setMaxDockTabs=function(k){this.$ConversationNubTabStateClass3=k};j.prototype.getNumDockTabs=function(){var k=this.$ConversationNubTabStateClass3,l=this.getTotalTabCount();return Math.min(k,l)};j.prototype.getNumMenuTabs=function(){return this.getTotalTabCount()-this.getNumDockTabs()};j.prototype.addTabState=function(k){this.$ConversationNubTabStateClass2.push(k)};j.prototype.addLoadedTab=function(k,l){var m=this.getTabState(k);if(!m)return;var n=this.getLoadedTab(k);if(n)return;this.$ConversationNubTabStateClass1[k]=l;this.$ConversationNubTabStateClass4()};j.prototype.getLoadedTab=function(k){return this.$ConversationNubTabStateClass1[k]};j.prototype.getLoadedTabByFeedbackTarget=function(k){return this.getLoadedTabs().find(function(l){return l.getPersistentState().ftID===k})};j.prototype.isTabInDock=function(k){var l=this.getLoadedTab(k);if(!l)return false;var m=this.$ConversationNubTabStateClass5(l);return 0<=m&&m<this.getNumDockTabs()};j.prototype.clearTabNotifications=function(k){this.$ConversationNubTabStateClass2.modifyTabState(k,function(l){l.unseenCommentsSinceLastCleared={};l.hasFakeInitBadge=false;l.badgeCount=0;l.isBlinkingUnread=false})};j.prototype.deleteTab=function(k){var l=this.getLoadedTab(k);if(l){delete this.$ConversationNubTabStateClass1[k];l.destroy()}this.$ConversationNubTabStateClass2.remove(k);return Boolean(l)};j.prototype.deleteAllTabs=function(){this.getUnsortedLoadedTabs().forEach(function(k){return this.deleteTab(k.getTabID())}.bind(this))};j.prototype.modifyTabState=function(k,l){return this.$ConversationNubTabStateClass2.modifyTabState(k,l)};j.prototype.moveTabToDockLeft=function(k){__p&&__p();var l=this.getLoadedTab(k);if(!l)return;this.$ConversationNubTabStateClass2.modifyTabs(function(m){__p&&__p();var n=m.findIndex(function(l){return l.tabID===k});n!==-1||h(0);var o=m[n],p=this.$ConversationNubTabStateClass5(l),q=this.getLoadedTabs().length,r=this.getNumDockTabs();if(p<0||q===0)return m;else if(r===0){if(p!==0){m.splice(n,1);m.unshift(o)}return m}var s=r-1;if(p===s)return m;m.splice(n,1);if(p<s)s-=1;var t=this.getLoadedTabs()[s],u=this.getTabState(t.getTabID());u||h(0);var v=m.findIndex(function(l){return l.tabID===u.tabID});m.splice(v,0,o);return m}.bind(this))};j.prototype.getLoadedTabs=function(){var k=this.$ConversationNubTabStateClass2.getTabs().map(function(l){return this.getLoadedTab(l.tabID)}.bind(this)).filter(Boolean);return k};j.prototype.getUnsortedLoadedTabs=function(){var k=Object.values(this.$ConversationNubTabStateClass1);return k};j.prototype.getTotalTabCount=function(){return this.getUnsortedLoadedTabs().length};j.prototype.getTabsForDockOldestFirst=function(){return this.getLoadedTabs().slice(0,this.getNumDockTabs())};j.prototype.getTabsForDockNewestFirst=function(){return this.getTabsForDockOldestFirst().slice().reverse()};j.prototype.getTabsForMenuOldestFirst=function(){return this.getLoadedTabs().slice(this.getNumDockTabs())};j.prototype.getTabsForMenuNewestFirst=function(){return this.getLoadedTabs().slice(this.getNumDockTabs()).reverse()};j.prototype.$ConversationNubTabStateClass4=function(){var k=this.getLoadedTabs().length;if(k>i){var l=k-i,m=this.getTabsForMenuOldestFirst().slice(0,l);m.map(function(n){return n.getTabID()}).forEach(function(n){return this.deleteTab(n)}.bind(this))}};j.prototype.$ConversationNubTabStateClass5=function(k){return this.getLoadedTabs().indexOf(k)};f.exports=new j()}),null);
__d("ConversationNubAddCommentSubscription",["Arbiter","ConversationNubTabState","UFIUIEvents"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i){return c("Arbiter").subscribe(c("UFIUIEvents").Comment,function(j,k){var l=k.ft_id,m=k.form;if(!l||!m)return;var n=c("ConversationNubTabState").getLoadedTabByFeedbackTarget(l);if(n&&n.isFormForThisUFI(m))i(n,l)})}f.exports={subscribe:h}}),null);
__d("ConversationNub",["csx","cx","Arbiter","ConversationNubHeader","ConversationNubTabState","ConversationNubTabsUpdateEventController","ConversationNubUtils","CSS","DOM","EventListener","NotificationUserActions","SubscriptionsHandler","UFIComposerIsTypingStore","URI","containsNode","debounce","guid"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("ConversationNubTabsUpdateEventController").minimizeAndInformTabUpdate,k=c("ConversationNubTabsUpdateEventController").popOutAndInformTabUpdate,l=c("ConversationNubTabState"),m=10,n=500,o=100;p.createDefaultState=function(q,r,s,t,u,v){return{tabID:q,permalinkURI:r?new(c("URI"))(r):null,ftID:s,notifAlertID:t,notificationType:u,title:v,keepAtBottom:false,isTabRaised:false,isBlinkingUnread:false,badgeCount:0,allSeenNewComments:{},unseenCommentsSinceLastCleared:{},hasFakeInitBadge:false}};function p(q,r,s,t){__p&&__p();var u=arguments.length<=4||arguments[4]===undefined?false:arguments[4],v=arguments.length<=5||arguments[5]===undefined?false:arguments[5];this.$ConversationNub13=false;this.$ConversationNub14=false;this.$ConversationNub1=q;this.$ConversationNub12=r;this.$ConversationNub5=c("guid")();this.$ConversationNub7=null;this.$ConversationNub8=false;this.$ConversationNub9=null;this.$ConversationNub10=u;this.$ConversationNub11=v;this.$ConversationNub15=t;this.$ConversationNub6=new(c("SubscriptionsHandler"))();this.$ConversationNub16();this.$ConversationNub17();if(s!=null)l.modifyTabState(this.$ConversationNub12,function(w){if(s)w.hasFakeInitBadge=false;else{w.hasFakeInitBadge=true;this.$ConversationNub18(1);this.$ConversationNub19(true)}}.bind(this));this.$ConversationNub20()}p.prototype.$ConversationNub20=function(){this.$ConversationNub21();this.$ConversationNub22();c("ConversationNubUtils").informShouldRecheckTabVisibility(this);this.forceReflow()};p.prototype.getPersistentState=function(){return l.getTabState(this.$ConversationNub12)};p.prototype.getPersistentStateIfExists=function(){return l.getTabStateIfExists(this.$ConversationNub12)};p.prototype.$ConversationNub16=function(){__p&&__p();var q=this.$ConversationNub23();if(q){this.$ConversationNub6.addSubscriptions(c("EventListener").listen(q,"click",this.$ConversationNub24.bind(this)),c("EventListener").listen(q,"mouseenter",this.$ConversationNub25.bind(this)),c("EventListener").listen(q,"mouseleave",this.$ConversationNub26.bind(this)));var r=c("ConversationNubUtils").getCloseButtonElem(q);if(r)c("ConversationNubUtils").addCloseButtonListeners(r,this.$ConversationNub6,this.$ConversationNub27.bind(this))}var s=this.$ConversationNub28();if(s){l.modifyTabState(this.$ConversationNub12,function(u){u.keepAtBottom=true});this.$ConversationNub6.addSubscriptions(c("EventListener").listen(s,"scroll",c("debounce")(this.$ConversationNub29.bind(this),o)),c("Arbiter").subscribe("reflow",this.$ConversationNub30.bind(this)))}var t=this.$ConversationNub31();if(t)this.$ConversationNub6.addSubscriptions(c("EventListener").listen(t,"focusin",this.$ConversationNub32.bind(this,true)),c("EventListener").listen(t,"focusout",this.$ConversationNub32.bind(this,false)))};p.prototype.$ConversationNub17=function(){__p&&__p();var q=this.$ConversationNub33();if(!q){this.$ConversationNub2=null;return}var r=function(){var t=this.getPersistentState();return{permalinkURI:t.permalinkURI,ftID:t.ftID,tabID:t.tabID}}.bind(this),s=new(c("ConversationNubHeader"))(q,r);this.$ConversationNub6.addSubscriptions(s.subscribe("closeButton",this.$ConversationNub27.bind(this)),s.subscribe("showMenu",this.$ConversationNub34.bind(this)),s.subscribe("hideMenu",this.$ConversationNub35.bind(this)),s.subscribe("minimizeButton",this.$ConversationNub36.bind(this,true)),s.subscribe("clickHeader",this.$ConversationNub36.bind(this,true)),s.subscribe("menuPermalinkClick",this.$ConversationNub36.bind(this,false)),c("UFIComposerIsTypingStore").addListener(function(){var t=this.getPersistentStateIfExists();if(!t)return;var u=this.$ConversationNub14,v=c("UFIComposerIsTypingStore").getValueFor(t.ftID);this.$ConversationNub14=v===true;if(u!==this.$ConversationNub14)c("ConversationNubTabsUpdateEventController").informTabsUpdated()}.bind(this)));this.$ConversationNub2=s};p.prototype.$ConversationNub33=function(){return this.$ConversationNub1&&c("DOM").scry(this.$ConversationNub1,".fbNubFlyoutTitlebar")[0]};p.prototype.$ConversationNub23=function(){return this.$ConversationNub1&&c("DOM").scry(this.$ConversationNub1,".fbNubButton")[0]};p.prototype.$ConversationNub28=function(){if(!this.$ConversationNub3&&this.$ConversationNub1)this.$ConversationNub3=c("DOM").scry(this.$ConversationNub1,".uiScrollableAreaWrap")[0];return this.$ConversationNub3};p.prototype.$ConversationNub31=function(){if(!this.$ConversationNub4&&this.$ConversationNub1)this.$ConversationNub4=c("DOM").scry(this.$ConversationNub1,".fbNubFlyoutBodyContent")[0];return this.$ConversationNub4};p.prototype.$ConversationNub37=function(){var q=this.$ConversationNub23();if(q)return c("DOM").scry(q,"._37op")[0];return null};p.prototype.$ConversationNub27=function(){c("ConversationNubUtils").informShouldCloseTab(this.$ConversationNub12,this.getFeedbackTargetID(),c("ConversationNubUtils").CLOSE_REASON_TAB_X_OUT)};p.prototype.$ConversationNub36=function(q){j(this,q)};p.prototype.$ConversationNub34=function(){this.$ConversationNub1&&c("CSS").addClass(this.$ConversationNub1,"_1uw3")};p.prototype.$ConversationNub35=function(){this.$ConversationNub1&&c("CSS").removeClass(this.$ConversationNub1,"_1uw3")};p.prototype.$ConversationNub24=function(){if(this.getPersistentState().isTabRaised)j(this,true);else k(this,true)};p.prototype.$ConversationNub25=function(){if(this.getPersistentState().isBlinkingUnread)this.$ConversationNub9=new Date()};p.prototype.$ConversationNub26=function(){var q=this.$ConversationNub9;if(q&&this.getPersistentState().isBlinkingUnread){var r=new Date();if(r-q>=n)this.$ConversationNub19(false)}this.$ConversationNub9=null};p.prototype.$ConversationNub38=function(){var q=this.$ConversationNub28();if(q){var r=q.scrollHeight;if(r>0&&!this.$ConversationNub39(q)){this.$ConversationNub8=true;q.scrollTop=r}}};p.prototype.$ConversationNub39=function(q){q=q||this.$ConversationNub28();return!!(q&&q.scrollTop>=q.scrollHeight-q.clientHeight-m)};p.prototype.$ConversationNub29=function(){if(!l.getTabStateIfExists(this.$ConversationNub12)||!this.getPersistentState().isTabRaised)return;l.modifyTabState(this.$ConversationNub12,function(q){q.keepAtBottom=this.$ConversationNub39();c("ConversationNubUtils").informShouldRecheckTabVisibility(this)}.bind(this));if(!this.$ConversationNub8)this.clearJewelNotifications();this.$ConversationNub8=false};p.prototype.$ConversationNub32=function(q){if(this.$ConversationNub13===q)return;this.$ConversationNub13=q;if(this.$ConversationNub13)this.clearJewelNotifications();c("ConversationNubTabsUpdateEventController").informTabsUpdated()};p.prototype.getIsFocused=function(){return this.$ConversationNub13};p.prototype.getPageID=function(){return this.$ConversationNub15};p.prototype.getHasText=function(){return this.$ConversationNub14};p.prototype.$ConversationNub30=function(){__p&&__p();var q=this.getPersistentState();if(!q.isTabRaised)return;if(q.keepAtBottom){this.$ConversationNub38();this.$ConversationNub7&&clearTimeout(this.$ConversationNub7);this.$ConversationNub7=setTimeout(function(){if(q.keepAtBottom)this.$ConversationNub38()}.bind(this),100)}};p.prototype.$ConversationNub18=function(q){l.modifyTabState(this.$ConversationNub12,function(r){r.badgeCount=q;this.$ConversationNub21()}.bind(this))};p.prototype.$ConversationNub19=function(q){l.modifyTabState(this.$ConversationNub12,function(r){r.isBlinkingUnread=q;this.$ConversationNub22()}.bind(this))};p.prototype.$ConversationNub21=function(){__p&&__p();var q=this.$ConversationNub37();if(!q)return;var r=this.getPersistentState().badgeCount,s=r>0;if(s){c("DOM").setContent(q,r);c("CSS").show(q)}else{c("CSS").hide(q);c("DOM").setContent(q,r)}};p.prototype.$ConversationNub22=function(){if(this.$ConversationNub1){var q=this.getPersistentState().isBlinkingUnread;if(this.$ConversationNub1)c("CSS").conditionClass(this.$ConversationNub1,"_53tf",q)}};p.prototype.getRootDOM=function(){return this.$ConversationNub1};p.prototype.getShouldShowIntroNux=function(){return this.$ConversationNub10};p.prototype.getShouldShowHideNux=function(){return this.$ConversationNub11};p.prototype.getTabID=function(){return this.$ConversationNub12};p.prototype.getNotificationPayloadAlertID=function(){return this.getPersistentState().notifAlertID};p.prototype.getNotificationType=function(){return this.getPersistentState().notificationType};p.prototype.setNotificationType=function(q){l.modifyTabState(this.$ConversationNub12,function(r){r.notificationType=q})};p.prototype.getFeedbackTargetID=function(){return this.getPersistentState().ftID};p.prototype.getPermalinkURI=function(){return this.getPersistentState().permalinkURI};p.prototype.getTitle=function(){return this.getPersistentState().title};p.prototype.getBadgeCount=function(){return this.getPersistentState().badgeCount};p.prototype.getIsRaised=function(){return this.getPersistentState().isTabRaised};p.prototype.getSessionID=function(){return this.$ConversationNub5};p.prototype.markCommentsAsSeenWithoutBadging=function(q){l.modifyTabState(this.$ConversationNub12,function(r){q.forEach(function(s){r.allSeenNewComments[s]=true})})};p.prototype.attemptAddNewCommentsToBadge=function(q){__p&&__p();l.modifyTabState(this.$ConversationNub12,function(r){__p&&__p();q.forEach(function(u){if(r.allSeenNewComments[u])return;r.allSeenNewComments[u]=true;r.unseenCommentsSinceLastCleared[u]=true});var s=Object.keys(r.unseenCommentsSinceLastCleared).length;if(r.hasFakeInitBadge)s+=1;var t=r.badgeCount;this.$ConversationNub18(s);this.$ConversationNub19(s>0&&s>t)}.bind(this))};p.prototype.clearBadge=function(){l.clearTabNotifications(this.$ConversationNub12);this.$ConversationNub21();this.$ConversationNub22()};p.prototype.clearJewelNotifications=function(){var q=this.getNotificationPayloadAlertID();if(q)c("NotificationUserActions").markNotificationsAsRead([q])};p.prototype.popOutAndInformTabUpdate=function(){this.popOut();c("ConversationNubTabsUpdateEventController").informTabsUpdated()};p.prototype.popOut=function(){l.modifyTabState(this.$ConversationNub12,function(q){if(this.$ConversationNub1)c("CSS").addClass(this.$ConversationNub1,"_5r93");q.isTabRaised=true;this.clearBadge();if(q.keepAtBottom)this.$ConversationNub38()}.bind(this))};p.prototype.minimize=function(){l.modifyTabState(this.$ConversationNub12,function(q){if(this.$ConversationNub1)c("CSS").removeClass(this.$ConversationNub1,"_5r93");q.isTabRaised=false;this.$ConversationNub2&&this.$ConversationNub2.hideMenu();this.clearBadge()}.bind(this))};p.prototype.forceReflow=function(){this.$ConversationNub30()};p.prototype.isFormForThisUFI=function(q){return this.$ConversationNub1&&c("containsNode")(this.$ConversationNub1,q)};p.prototype.destroy=function(){__p&&__p();this.$ConversationNub6.release();this.$ConversationNub2&&this.$ConversationNub2.destroy();this.$ConversationNub2=null;this.$ConversationNub7&&clearTimeout(this.$ConversationNub7);this.minimize();if(this.$ConversationNub1){c("DOM").remove(this.$ConversationNub1);c("Arbiter").inform("ConversationNub/destroy",{root:this.$ConversationNub1});this.$ConversationNub1=null}};f.exports=p}),null);
__d("XConversationNubActionTakenController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/ajax/conversation/nub_story/action_taken/",{})}),null);
__d("ConversationNubActionTakenReporter",["Arbiter","AsyncRequest","ConversationNubAddCommentSubscription","ConversationNubUtils","PinnedConversationNubsActionTaken","SubscriptionsHandler","XConversationNubActionTakenController"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.$ConversationNubActionTakenReporter2=function(i,j){this.$ConversationNubActionTakenReporter4(j,c("PinnedConversationNubsActionTaken").COMMENT_ADDED)}.bind(this);this.$ConversationNubActionTakenReporter3=function(event,i){var j=i.tabID,k=i.ftID,l=i.tabState,m=i.sessionID,n=i.reason;if(n===c("ConversationNubUtils").CLOSE_REASON_TAB_X_OUT||n===c("ConversationNubUtils").CLOSE_REASON_OVERFLOW_X_OUT||n===c("ConversationNubUtils").CLOSE_REASON_UNPIN)this.$ConversationNubActionTakenReporter4(k,c("PinnedConversationNubsActionTaken").TAB_CLOSED_BY_USER)}.bind(this);this.$ConversationNubActionTakenReporter1=new(c("SubscriptionsHandler"))(c("ConversationNubAddCommentSubscription").subscribe(this.$ConversationNubActionTakenReporter2),c("Arbiter").subscribe(c("ConversationNubUtils").CLOSE_TAB_EVENT,this.$ConversationNubActionTakenReporter3))}h.prototype.destroy=function(){this.$ConversationNubActionTakenReporter1.release()};h.prototype.$ConversationNubActionTakenReporter4=function(i,j){var k=c("XConversationNubActionTakenController").getURIBuilder().getURI();new(c("AsyncRequest"))().setURI(k).setMethod("POST").setData({ft_id:i,action:j}).setAllowCrossPageTransition(true).send()};f.exports=h}),null);
__d("ConversationNubHeader",["csx","ArbiterMixin","Bootloader","ConversationNubUtils","DOM","Event","EventListener","Keys","SubscriptionsHandler","ifRequired","mixin"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j;function k(m,n){return c("EventListener").listen(m,"keydown",function(o){if(c("Event").getKeyCode(o)===c("Keys").RETURN)n(o)})}i=babelHelpers.inherits(l,c("mixin")(c("ArbiterMixin")));j=i&&i.prototype;function l(m,n){j.constructor.call(this);this.$ConversationNubHeader6=false;this.$ConversationNubHeader1=m;this.$ConversationNubHeader3=n;this.$ConversationNubHeader4=null;this.$ConversationNubHeader5=false;this.$ConversationNubHeader2=new(c("SubscriptionsHandler"))();this.$ConversationNubHeader7()}l.prototype.$ConversationNubHeader7=function(){__p&&__p();var m=this.$ConversationNubHeader1;this.$ConversationNubHeader2.addSubscriptions(c("EventListener").listen(m,"click",this.$ConversationNubHeader8.bind(this)));var n=c("ConversationNubUtils").getCloseButtonElem(m);if(n)c("ConversationNubUtils").addCloseButtonListeners(n,this.$ConversationNubHeader2,this.$ConversationNubHeader9.bind(this));var o=this.$ConversationNubHeader10();if(o)this.$ConversationNubHeader2.addSubscriptions(c("EventListener").listen(o,"click",this.$ConversationNubHeader11.bind(this)),k(o,this.$ConversationNubHeader11.bind(this)));var p=this.$ConversationNubHeader12();if(p)this.$ConversationNubHeader2.addSubscriptions(c("EventListener").listen(p,"click",this.$ConversationNubHeader13.bind(this)),c("EventListener").listen(p,"mouseover",this.$ConversationNubHeader14.bind(this)),c("EventListener").listen(p,"focus",this.$ConversationNubHeader15.bind(this)),k(p,this.$ConversationNubHeader16.bind(this)))};l.prototype.$ConversationNubHeader12=function(){return c("DOM").scry(this.$ConversationNubHeader1,"._1rf1")[0]};l.prototype.$ConversationNubHeader10=function(){return c("DOM").scry(this.$ConversationNubHeader1,"._4a56")[0]};l.prototype.$ConversationNubHeader17=function(){return c("ConversationNubUtils").getCloseButtonElem(this.$ConversationNubHeader1)};l.prototype.$ConversationNubHeader9=function(){this.inform("closeButton")};l.prototype.$ConversationNubHeader11=function(m){if(m.type==="click")m.kill();this.inform("minimizeButton")};l.prototype.$ConversationNubHeader8=function(){this.inform("clickHeader")};l.prototype.$ConversationNubHeader18=function(){this.inform("showMenu")};l.prototype.$ConversationNubHeader19=function(){this.inform("hideMenu");var m=this.$ConversationNubHeader12();m&&m.blur()};l.prototype.$ConversationNubHeader20=function(){this.inform("menuPermalinkClick")};l.prototype.$ConversationNubHeader21=function(m){__p&&__p();if(this.$ConversationNubHeader4)return;var n=this.$ConversationNubHeader12();if(!n)return;if(m)this.$ConversationNubHeader5=true;c("Bootloader").loadModules(["React","ReactDOM","ConversationNubHeaderMenu.react"],function(o,p,q){if(this.$ConversationNubHeader6)return;var r=babelHelpers["extends"]({},this.$ConversationNubHeader3(),{onMenuShow:this.$ConversationNubHeader18.bind(this),onMenuHide:this.$ConversationNubHeader19.bind(this),onPermalinkClick:this.$ConversationNubHeader20.bind(this),showOnMount:this.$ConversationNubHeader5});this.$ConversationNubHeader4=p.render(o.createElement(q,r),n)}.bind(this),"ConversationNubHeader")};l.prototype.$ConversationNubHeader13=function(m){m.kill();this.$ConversationNubHeader21(true)};l.prototype.$ConversationNubHeader14=function(){this.$ConversationNubHeader21(false)};l.prototype.$ConversationNubHeader15=function(){this.$ConversationNubHeader21(false)};l.prototype.$ConversationNubHeader16=function(){if(this.$ConversationNubHeader4)this.$ConversationNubHeader4.toggle();else this.$ConversationNubHeader21(true)};l.prototype.hideMenu=function(){this.$ConversationNubHeader4&&this.$ConversationNubHeader4.hide()};l.prototype.destroy=function(){this.$ConversationNubHeader6=true;var m=this.$ConversationNubHeader12();if(m&&this.$ConversationNubHeader4)c("ifRequired")("ReactDOM",function(n){n.unmountComponentAtNode(m)});this.$ConversationNubHeader2.release()};f.exports=l}),null);
__d("ConversationNubTabsUpdateEventController",["Arbiter","ConversationNubUtils"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h="ConversationNub/tabsUpdated",i="ConversationNub/minimizedByUser",j="ConversationNub/maximizedByUser",k=false;function l(p){if(!k)c("Arbiter").inform(h,p)}function m(p){return c("Arbiter").subscribe(h,function(q,r){k=true;p(r);k=false})}function n(p,q){q&&c("Arbiter").inform(i,{tab:p});p.minimize();l()}function o(p,q){if(!q&&!c("ConversationNubUtils").allowProgrammaticPopOut())return;q&&c("Arbiter").inform(j,{tab:p});p.popOut();l()}f.exports={TAB_MINIMIZED_BY_USER_EVENT:i,TAB_MAXIMIZED_BY_USER_EVENT:j,informTabsUpdated:l,subscribeToTabsUpdated:m,minimizeAndInformTabUpdate:n,popOutAndInformTabUpdate:o}}),null);
__d("XConversationNubTogglePinController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/ajax/conversation/nub_story/toggle_pin/",{ft_id:{type:"String"},pin:{type:"Bool",defaultValue:false},with_render:{type:"Bool",defaultValue:false},notif_setting:{type:"Enum",enumType:1}})}),null);
__d("XConversationsToggleController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/ajax/conversation/toggle_feature/",{turn_conversations_on:{type:"Bool",defaultValue:false}})}),null);
__d("isBusinessURI",["isFacebookURI"],(function a(b,c,d,e,f,g){"use strict";function h(i){return c("isFacebookURI")(i)&&i.getSubdomain()==="business"}f.exports=h}),null);
__d("isGamesURI",["isFacebookURI"],(function a(b,c,d,e,f,g){"use strict";function h(i){return c("isFacebookURI")(i)&&i.getPath().startsWith("/games")}f.exports=h}),null);
__d("ConversationNubUtils",["csx","Arbiter","AsyncRequest","ConversationNubTabState","DOM","Event","EventListener","Keys","NotificationConversationController","URI","XConversationNubTogglePinController","XConversationsToggleController","isBusinessURI","isCanvasAppURI","isGamesURI"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("ConversationNubTabState"),j=Object.freeze({DISABLE:"disable",ENABLE:"enable"}),k="ConversationNubUtils/closeTab",l="ConversationNubUtils/unpinnedFromHeader",m="ConversationNubUtils/recheckTabVisibility",n="ConversationNubUtils/openPermalinkFromHeader",o="ConversationNubUtils/turnOff",p="ConversationNubUtils/turnOn",q="tab-x-out",r="browser-tab-sync",s="overflow-x-out",t="unpin";function u(O){var P=Object.values(j);return P.find(function(Q){return Q===O})||null}function v(O,P,Q,R){var S=R||{},T=S.notif_setting,U=c("XConversationNubTogglePinController").getURIBuilder().setString("ft_id",String(O)).setBool("pin",P);if(T)U.setEnum("notif_setting",T);var V=U.getURI(),W=new(c("AsyncRequest"))().setURI(V).setMethod("POST");if(Q)W.setAllowCrossPageTransition(true);W.send()}function w(E){var O=c("XConversationsToggleController").getURIBuilder().setBool("turn_conversations_on",E).getURI();E?N():M();var P=new(c("AsyncRequest"))().setURI(O).setAllowCrossPageTransition(true).setHandler(function(Q){if(Q.getPayload().conversationsStatus)N();else M()}).setErrorHandler(function(Q){E?M():N()}).setMethod("POST");P.send()}function x(O,P,Q){v(O,true,P,Q)}function y(O,P,Q){v(O,false,P,Q)}function z(O,P){x(O,false,P)}function A(O,P){y(O,false,P)}function B(O,P){x(O,true,P)}function C(O,P){y(O,true,P)}function D(){w(false);c("NotificationConversationController").deleteAllTabs()}function E(){w(true)}function F(O){return c("DOM").scry(O,"._4iz6")[0]}function G(O,P,Q){var R=function R(){Q()};P.addSubscriptions(c("EventListener").listen(O,"click",R),c("EventListener").listen(O,"keydown",function(S){if(c("Event").getKeyCode(S)===c("Keys").RETURN)R()}))}function H(){var O=c("URI").getRequestURI();return!c("isCanvasAppURI")(O)&&!c("isBusinessURI")(O)&&!c("isGamesURI")(O)}function I(O,P,Q){var R=i.getLoadedTab(O);if(!R)return;var S=R.getPersistentState(),T=R.getSessionID(),U=R.getPageID();c("Arbiter").inform(k,{tabID:O,ftID:P,tabState:S,sessionID:T,reason:Q,pageID:U})}function J(O){var P=i.getLoadedTab(O);if(!P)return;c("Arbiter").inform(l,{tab:P})}function K(O){c("Arbiter").inform(m,{tab:O})}function L(O){var P=i.getLoadedTab(O);if(!P)return;c("Arbiter").inform(n,{tab:P})}function M(){c("Arbiter").inform(o,{})}function N(){c("Arbiter").inform(p,{})}f.exports={CLOSE_TAB_EVENT:k,UNPIN_FROM_HEADER_EVENT:l,OPEN_PERMALINK_FROM_HEADER_EVENT:n,TURN_CONVERSATIONS_OFF_EVENT:o,TURN_CONVERSATIONS_ON_EVENT:p,CLOSE_REASON_TAB_X_OUT:q,CLOSE_REASON_SYNCHRONIZED_FROM_OTHER_TAB:r,CLOSE_REASON_OVERFLOW_X_OUT:s,CLOSE_REASON_UNPIN:t,coerceToPinRequestNotifSetting:u,sendPinRequest:z,sendUnpinRequest:A,sendPinRequestAcrossTransitions:B,sendUnpinRequestAcrossTransitions:C,getCloseButtonElem:F,addCloseButtonListeners:G,informShouldCloseTab:I,informDidUnpinFromHeaderMenu:J,informShouldRecheckTabVisibility:K,informOpenPermalinkFromHeader:L,allowProgrammaticPopOut:H,turnConversationsOff:D,turnConversationsOn:E}}),null);
__d("ConversationNubPermalinkUtils",["URI","isFacebookURI"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(l){return l.substr(-1)==="/"?l.slice(0,-1):l}function i(l,m){var n=l.getPath(),o=m.getPath();return h(n)===h(o)}function j(l,m,n){var o=l.getQueryData(),p=m.getQueryData(),q=o[n],r=p[n];if(q==null&&r==null)return true;return q===r}function k(l){var m=new(c("URI"))(window.location.href);return m&&l&&c("isFacebookURI")(m)&&c("isFacebookURI")(l)&&i(m,l)&&j(m,l,"fbid")&&j(m,l,"story_fbid")}f.exports={isOnPermalink:k}}),null);
__d("DockTabsViewportFantaTabUtils",[],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=269;function i(){return h+1}function j(m){return Math.floor(m/h)}function k(m){if(!m)return null;var n=m.fantaTabModelStateGetter;return n?n():null}function l(m){return m?m.size:0}f.exports={getTabCountToFitWidth:j,getMinRequiredWidthForFirstFantaTab:i,getFantaTabModelFromCallbacks:k,getNumFantaTabsFromModel:l}}),null);
__d("DockTabsViewportPinnedConversationTabUtils",[],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=496+9+2,i=210+9+2,j=52;function k(){return h}function l(){return i}function m(){return j}function n(r){return r.getIsRaised()?k():l()}function o(){return k()+j}function p(r){var s=r||{},t=s.pinnedConvoTabStateGetter;return t?t():null}function q(r){return r?r.getTotalTabCount():0}f.exports={getRaisedPinnedConvoTabWidth:k,getLoweredPinnedConvoTabWidth:l,getPinnedConvoSelectorWidth:m,getPinnedConvoTabWidth:n,getMinRequiredWidthForFirstConvoTab:o,getPinnedConvoTabsStateFromCallbacks:p,getNumPinnedConvoTabsFromModel:q}}),null);
__d("DockTabsViewportCalculator",["csx","Arbiter","DataStore","Dock","DockTabsViewportFantaTabUtils","DockTabsViewportPinnedConversationTabUtils","DOM","Event","FullScreen","SubscriptionsHandler","Vector","ViewportBounds","ge","getViewportDimensions","setImmediate"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=50,j=35,k=j,l="dock-tab-viewport-inst",m=c("DockTabsViewportFantaTabUtils").getMinRequiredWidthForFirstFantaTab,n=c("DockTabsViewportFantaTabUtils").getFantaTabModelFromCallbacks,o=c("DockTabsViewportFantaTabUtils").getNumFantaTabsFromModel,p=c("DockTabsViewportPinnedConversationTabUtils").getMinRequiredWidthForFirstConvoTab,q=c("DockTabsViewportPinnedConversationTabUtils").getNumPinnedConvoTabsFromModel,r=c("DockTabsViewportPinnedConversationTabUtils").getPinnedConvoTabsStateFromCallbacks;function s(u){return u?c("Vector").getElementDimensions(u).x:0}function t(u){__p&&__p();this.$DockTabsViewportCalculatorImpl1=u;this.$DockTabsViewportCalculatorImpl3=0;this.$DockTabsViewportCalculatorImpl4=0;this.$DockTabsViewportCalculatorImpl5=null;this.$DockTabsViewportCalculatorImpl6=null;this.$DockTabsViewportCalculatorImpl7=false;this.$DockTabsViewportCalculatorImpl8=false;this.$DockTabsViewportCalculatorImpl9=false;this.$DockTabsViewportCalculatorImpl2=new(c("SubscriptionsHandler"))();this.$DockTabsViewportCalculatorImpl10();this.$DockTabsViewportCalculatorImpl11()}t.prototype.$DockTabsViewportCalculatorImpl10=function(){__p&&__p();var u=this.$DockTabsViewportCalculatorImpl12.bind(this);this.$DockTabsViewportCalculatorImpl2.addSubscriptions(c("Event").listen(window,"resize",u),c("Dock").subscribe("resize",u),c("Arbiter").subscribeOnce("sidebar/initialized",u,c("Arbiter").SUBSCRIBE_NEW),c("FullScreen").subscribe("changed",function(){__p&&__p();if(c("FullScreen").isFullScreen()){this.$DockTabsViewportCalculatorImpl7=true;this.$DockTabsViewportCalculatorImpl8=false}else{this.$DockTabsViewportCalculatorImpl7=false;if(this.$DockTabsViewportCalculatorImpl8){c("setImmediate")(function(){u()});this.$DockTabsViewportCalculatorImpl8=false}}}.bind(this)))};t.prototype.registerFantaTabCallbacks=function(u){this.$DockTabsViewportCalculatorImpl5=u};t.prototype.registerPinnedConvoTabCallbacks=function(u){this.$DockTabsViewportCalculatorImpl6=u};t.prototype.forceRecalculateFBDockWidth=function(){this.$DockTabsViewportCalculatorImpl11();this.$DockTabsViewportCalculatorImpl13({forceRecalculateChatTabs:false,pinnedConvoUpdateData:null})};t.prototype.forceRecalculateChatTabs=function(){this.$DockTabsViewportCalculatorImpl13({forceRecalculateChatTabs:true,pinnedConvoUpdateData:null})};t.prototype.forceRecalculatePinnedConvoTabs=function(u){this.$DockTabsViewportCalculatorImpl13({forceRecalculateChatTabs:true,pinnedConvoUpdateData:u})};t.prototype.$DockTabsViewportCalculatorImpl12=function(){if(c("FullScreen").isFullScreen()||this.$DockTabsViewportCalculatorImpl7){this.$DockTabsViewportCalculatorImpl8=true;return}this.forceRecalculateFBDockWidth()};t.prototype.$DockTabsViewportCalculatorImpl13=function(u){var v=u.forceRecalculateChatTabs,w=u.pinnedConvoUpdateData,x=this.$DockTabsViewportCalculatorImpl14(),y=x.chatTabAvailableWidth,z=x.pinnedConvoTabAvailableWidth;this.$DockTabsViewportCalculatorImpl15(y,!!v);this.$DockTabsViewportCalculatorImpl16(z,w)};t.prototype.$DockTabsViewportCalculatorImpl16=function(u,v){var w=this.$DockTabsViewportCalculatorImpl6||{},x=w.onAvailableWidthChanged;x&&x(u,v)};t.prototype.$DockTabsViewportCalculatorImpl15=function(u,v){var w=this.$DockTabsViewportCalculatorImpl5||{},x=w.onAvailableWidthChanged;x&&x(u)};t.prototype.$DockTabsViewportCalculatorImpl17=function(){var u=n(this.$DockTabsViewportCalculatorImpl5);return o(u)};t.prototype.$DockTabsViewportCalculatorImpl18=function(){return m()};t.prototype.$DockTabsViewportCalculatorImpl14=function(){__p&&__p();var u=this.$DockTabsViewportCalculatorImpl3,v={chatTabAvailableWidth:u,pinnedConvoTabAvailableWidth:0},w={chatTabAvailableWidth:0,pinnedConvoTabAvailableWidth:u},x=this.$DockTabsViewportCalculatorImpl17(),y=r(this.$DockTabsViewportCalculatorImpl6),z=q(y);if(!y||z===0)return v;else if(x===0)return w;var A=this.$DockTabsViewportCalculatorImpl18();if(u<=A)return v;var B=p(),C=u-A,D=0;if(C<B)return v;else D=B;var E=D,F=Math.max(A,u-D);return{chatTabAvailableWidth:F,pinnedConvoTabAvailableWidth:E}};t.prototype.$DockTabsViewportCalculatorImpl11=function(){this.$DockTabsViewportCalculatorImpl3=this.$DockTabsViewportCalculatorImpl19();this.$DockTabsViewportCalculatorImpl20("DockTabsViewportCalculator/recalcTotalDock_FOR_TEST_ONLY")};t.prototype.$DockTabsViewportCalculatorImpl21=function(){var u=this.$DockTabsViewportCalculatorImpl1;if(!u)return{buddyListNubWidth:0,employeeNubsWidth:0};var v=s(u),w=s(c("DOM").find(u,"._56ox")),x=s(c("DOM").scry(u,"._56oy")[0]),y=s(c("DOM").scry(u,"._ph1")[0]),z=Math.max(v-w-x-y,0);return{buddyListNubWidth:w,employeeNubsWidth:z}};t.prototype.$DockTabsViewportCalculatorImpl19=function(){var u=c("getViewportDimensions").withoutScrollbars().width;u-=c("ViewportBounds").getLeft()+c("ViewportBounds").getRight();u-=i;var v=this.$DockTabsViewportCalculatorImpl21(),w=v.buddyListNubWidth,x=v.employeeNubsWidth;u-=w;this.$DockTabsViewportCalculatorImpl4=Math.max(this.$DockTabsViewportCalculatorImpl4,x);u-=this.$DockTabsViewportCalculatorImpl4;u-=k;return Math.max(u,0)};t.prototype.enableTestInforms_FOR_TEST_ONLY=function(){this.$DockTabsViewportCalculatorImpl9=true};t.prototype.$DockTabsViewportCalculatorImpl20=function(u){if(this.$DockTabsViewportCalculatorImpl9)c("Arbiter").inform(u)};t.prototype.getChatTabAvailableDockWidth_FOR_TEST_ONLY=function(){return this.$DockTabsViewportCalculatorImpl14().chatTabAvailableWidth};t.prototype.getPinnedConvoTabAvailableDockWidth_FOR_TEST_ONLY=function(){return this.$DockTabsViewportCalculatorImpl14().pinnedConvoTabAvailableWidth};t.prototype.getAvailableTotalWidth_FOR_TEST_ONLY=function(){return this.$DockTabsViewportCalculatorImpl3};f.exports={getInstance:function u(v){__p&&__p();var w=c("ge")("pagelet_dock");if(!w||!c("DOM").contains(w,v))return null;var x=c("DataStore").get(w,l);if(x instanceof t)return x;var y=c("DOM").scry(w,".fbDockWrapperRight .fbDock")[0];x=new t(y);c("DataStore").set(w,l,x);return x}}}),null);
__d("ConversationNubViewportManager",["DockTabsViewportCalculator","DockTabsViewportPinnedConversationTabUtils"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("DockTabsViewportPinnedConversationTabUtils").getMinRequiredWidthForFirstConvoTab;function i(j,k,l){this.$ConversationNubViewportManager1=j;this.$ConversationNubViewportManager3=k;this.$ConversationNubViewportManager2=c("DockTabsViewportCalculator").getInstance(this.$ConversationNubViewportManager1);this.$ConversationNubViewportManager2&&this.$ConversationNubViewportManager2.registerPinnedConvoTabCallbacks(babelHelpers["extends"]({},l,{pinnedConvoTabStateGetter:function(){return this.$ConversationNubViewportManager3}.bind(this)}))}i.prototype.getNumDockTabsToShow=function(j){return this.getCouldFitAtLeastOneDockTab(j)?1:0};i.prototype.getCouldFitAtLeastOneDockTab=function(j){var k=h();return k<=j};i.prototype.forceRecalculatePinnedConvoTabs=function(j){this.$ConversationNubViewportManager2&&this.$ConversationNubViewportManager2.forceRecalculatePinnedConvoTabs(j)};f.exports=i}),null);
__d("ConversationNubVisibilityDedupeUtils",["Bootloader","emptyFunction","ifRequired"],(function a(b,c,d,e,f,g){"use strict";function h(j){c("Bootloader").loadModules(["UFICommentVisibilityStore"],j,"ConversationNubVisibilityDedupeUtils")}function i(j){return c("ifRequired")("UFICommentVisibilityStore",function(k){return k.isFeedbackTargetVisible(j)},c("emptyFunction").thatReturnsFalse)}f.exports={bootloadUFIVisibilityModule:h,isFeedbackTargetVisible:i}}),null);
__d("XNotificationNubStoryController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/conversation/nub_story/",{notif_alert_id:{type:"String"},notif_id:{type:"Int"},ft_id:{type:"String"},force_minimized:{type:"Bool",defaultValue:false}})}),null);
__d("NotificationConversationController",["csx","cx","Arbiter","AsyncRequest","Bootloader","ConversationNub","ConversationNubActionTakenReporter","ConversationNubPermalinkUtils","ConversationNubTabState","ConversationNubTabsUpdateEventController","ConversationNubUtils","ConversationNubViewportManager","ConversationNubVisibilityDedupeUtils","CSS","DOM","PinnedConversationNubsConfig","SubscriptionsHandler","URI","XNotificationNubStoryController","ge","ifRequired","nullthrows"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("ConversationNubVisibilityDedupeUtils").isFeedbackTargetVisible,k=1,l=c("ConversationNubTabState"),m=Object.create(null),n=null,o=null,p=null,q=null,r=null,s=null,t=false,u=null,v=null,w=null,x=null,y=Object.create(null);function z(){if(!o)o=c("DOM").scry(c("ge")("pagelet_dock"),"._1mw-")[0];return o}function A(){if(!p){var D=z();if(D)p=c("DOM").scry(D,"._1tvj")[0]}return p}function B(){if(!q){var D=z();if(D)q=c("DOM").scry(D,"._2ikx .fbNubButton")[0]}return q}C.prototype.init=function(){__p&&__p();if(t)return;t=true;var D=new(c("SubscriptionsHandler"))();D.addSubscriptions(c("ConversationNubTabsUpdateEventController").subscribeToTabsUpdated(this.$NotificationConversationController2.bind(this)),c("Arbiter").subscribe(c("ConversationNubUtils").CLOSE_TAB_EVENT,function(E,F){var G=F||{},H=G.tabID;if(H)this.$NotificationConversationController3(H)}.bind(this)));this.$NotificationConversationController1=new(c("ConversationNubActionTakenReporter"))();u=D};C.prototype.$NotificationConversationController4=function(D){var E=n?n.getNumDockTabsToShow(D):k;l.setMaxDockTabs(E)};C.prototype.$NotificationConversationController5=function(D,E){this.$NotificationConversationController4(D);if(E){var F=E.tabToPromote,G=E.tabToOpenIfInDock;if(F&&!l.isTabInDock(F.getTabID()))l.moveTabToDockLeft(F.getTabID());if(c("ConversationNubUtils").allowProgrammaticPopOut()&&G&&l.isTabInDock(G.getTabID()))G.popOut()}this.$NotificationConversationController6(D)};C.prototype.$NotificationConversationController2=function(D){n&&n.forceRecalculatePinnedConvoTabs(D)};C.prototype.$NotificationConversationController6=function(D){__p&&__p();var E=l.getTotalTabCount(),F=l.getNumDockTabs(),G=n?n.getCouldFitAtLeastOneDockTab(D):false,H=E>0&&G,I=F<E&&H,J=z();if(J){c("CSS").conditionClass(J,"_1tvf",H);c("CSS").conditionClass(J,"_1dex",I);c("CSS").conditionClass(J,"_1tvi",I)}var K=c("PinnedConversationNubsConfig").pinnedToLeft?l.getTabsForDockOldestFirst():l.getTabsForDockNewestFirst();K.forEach(function(M){if(M.getIsRaised())M.clearBadge()});var L=l.getTabsForMenuNewestFirst();this.$NotificationConversationController7(K);this.$NotificationConversationController8(L)};C.prototype.handleNotificationsRead=function(D){__p&&__p();this.init();l.getUnsortedLoadedTabs().forEach(function(F){var G=F.getNotificationPayloadAlertID();if(G&&D[G])F.clearBadge()});l.getUnloadedTabs().forEach(function(F){if(F.notifAlertID&&D[F.notifAlertID])l.clearTabNotifications(F.tabID)});var E=l.getTabsForMenuNewestFirst();this.$NotificationConversationController8(E)};C.prototype.handleNewNotificationFromGraphQL=function(D,E){this.init();var F=c("nullthrows")(D),G=F.tab_id,H=F.notification,I=F.feedback_target_id,J=F.permalink_uri,K=c("nullthrows")(H),L=K.notif_id,M=K.alert_id,N=K.notif_type;this.$NotificationConversationController9(c("nullthrows")(G),c("nullthrows")(L),c("nullthrows")(I),c("nullthrows")(M),J?new(c("URI"))(J):null,E,N)};C.prototype.$NotificationConversationController9=function(D,E,F,G,H,I,J){var K=c("XNotificationNubStoryController").getURIBuilder().setString("notif_alert_id",G).setInt("notif_id",E);this.$NotificationConversationController10(F,I);this.$NotificationConversationController11(D,F,J,H,K)};C.prototype.$NotificationConversationController10=function(D,E){if(!y[D])y[D]=E};C.prototype.$NotificationConversationController11=function(D,E,F,G,H){__p&&__p();if(m[D])return;var I=l.getLoadedTab(D);if(I){if(F)I.setNotificationType(F);return}if(c("ConversationNubPermalinkUtils").isOnPermalink(G)||j(E))H.setBool("force_minimized",true);m[D]=true;new(c("AsyncRequest"))().setURI(H.getURI()).setAllowCrossPageTransition(true).setFinallyHandler(function(){delete m[D]}).send()};C.prototype.$NotificationConversationController12=function(D){__p&&__p();var E=true;l.getUnsortedLoadedTabs().forEach(function(F){__p&&__p();var G=F.getFeedbackTargetID(),H=D[G],I=H?Object.keys(H):[];if(I.length){var J=F.getBadgeCount();if(j(G)){F.markCommentsAsSeenWithoutBadging(I);F.clearBadge()}else F.attemptAddNewCommentsToBadge(I);var K=F.getBadgeCount();if(J!==K)E=true}});if(E)c("ConversationNubTabsUpdateEventController").informTabsUpdated()};C.prototype.$NotificationConversationController13=function(D){if(x)return;c("Bootloader").loadModules(["ConversationNubSurveys"],function(E){if(!x)x=new E(D)},"NotificationConversationController")};C.prototype.$NotificationConversationController14=function(D,E,F){__p&&__p();if(w){w.addTab(D,F);delete y[D.getPersistentState().ftID];return}c("Bootloader").loadModules(["ConversationNubLogger"],function(G){if(!w)w=new G(E);w.addTab(D,F);delete y[D.getPersistentState().ftID]},"NotificationConversationController")};C.prototype.$NotificationConversationController15=function(){if(v)return;c("Bootloader").loadModules(["ConversationNubUFICentralUpdateManager"],function(D){if(v)return;v=new D(this.$NotificationConversationController12.bind(this))}.bind(this),"NotificationConversationController")};C.prototype.$NotificationConversationController7=function(D){var E=A();if(!E)return;c("Bootloader").loadModules(["React","ReactDOM","ConversationNubDockedTabGroup.react"],function(F,G,H){s=G.render(F.createElement(H,{dockTabs:D}),E)},"NotificationConversationController")};C.prototype.$NotificationConversationController16=function(D){D.popOut();c("ConversationNubTabsUpdateEventController").informTabsUpdated({tabToPromote:D})};C.prototype.$NotificationConversationController8=function(D){var E=B();if(!E)return;c("Bootloader").loadModules(["React","ReactDOM","ConversationNubCollapsedSelectorMenu.react"],function(F,G,H){r=G.render(F.createElement(H,{menuTabs:D,onTabSelected:this.$NotificationConversationController16}),E)}.bind(this),"NotificationConversationController")};C.prototype.$NotificationConversationController17=function(){if(!n){var D=z();if(D){var E={onAvailableWidthChanged:this.$NotificationConversationController5.bind(this)};n=new(c("ConversationNubViewportManager"))(D,l,E)}}};C.prototype.storyFromServer=function(D,E){__p&&__p();if(!t)this.init();var F=E.attempt_open_on_init,G=E.ft_id,H=E.init_without_badge,I=E.notif_alert_id,J=E.notification_type,K=E.permalink_uri,L=E.promote_on_init,M=E.tab_add_source,N=E.tab_id,O=E.title,P=E.should_show_intro_nux,Q=E.should_show_hide_nux,R=E.page_id,S=l.getLoadedTab(N);if(S){if(L||F)c("ConversationNubTabsUpdateEventController").informTabsUpdated({tabToPromote:L?S:null,tabToOpenIfInDock:F?S:null});return}H=H||j(G);var T=l.getTabStateIfExists(N);if(T)H=null;else{var U=c("ConversationNub").createDefaultState(N,K,G,I,J,O);l.addTabState(U)}var V=new(c("ConversationNub"))(D,N,H,R,Boolean(P),Boolean(Q));l.addLoadedTab(N,V);F=F||V.getPersistentState().isTabRaised;this.$NotificationConversationController15();this.$NotificationConversationController17();c("ConversationNubTabsUpdateEventController").informTabsUpdated({tabToPromote:L?V:null,tabToOpenIfInDock:F?V:null});this.$NotificationConversationController13(l);var W=y[G]||M||"unknown";this.$NotificationConversationController14(V,l,W)};C.prototype.deleteAllTabs=function(){l.deleteAllTabs();c("ConversationNubTabsUpdateEventController").informTabsUpdated()};C.prototype.$NotificationConversationController3=function(D){var E=l.deleteTab(D);if(E)c("ConversationNubTabsUpdateEventController").informTabsUpdated()};C.prototype.unsubscribe=function(){__p&&__p();u&&u.release();u=null;w&&w.destroy();w=null;x&&x.destroy();x=null;v&&v.destroy();v=null;this.$NotificationConversationController1.destroy();c("ifRequired")("ReactDOM",function(D){var E=B();if(r&&E)D.unmountComponentAtNode(E);var F=A();if(s&&F)D.unmountComponentAtNode(F)})};function C(){}f.exports=new C()}),null);
__d("PinnedConversationTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:PinnedConversationLoggerConfig",this.$PinnedConversationTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:PinnedConversationLoggerConfig",this.$PinnedConversationTypedLogger1,c("Banzai").VITAL)};h.prototype.logImmediately=function(){c("GeneratedLoggerUtils").log("logger:PinnedConversationLoggerConfig",this.$PinnedConversationTypedLogger1,{signal:true})};h.prototype.clear=function(){this.$PinnedConversationTypedLogger1={};return this};h.prototype.getData=function(){return babelHelpers["extends"]({},this.$PinnedConversationTypedLogger1)};h.prototype.updateData=function(j){this.$PinnedConversationTypedLogger1=babelHelpers["extends"]({},this.$PinnedConversationTypedLogger1,j);return this};h.prototype.setAttemptOpenOnInit=function(j){this.$PinnedConversationTypedLogger1.attempt_open_on_init=j;return this};h.prototype.setBadgeCount=function(j){this.$PinnedConversationTypedLogger1.badge_count=j;return this};h.prototype.setClientEventTimeMs=function(j){this.$PinnedConversationTypedLogger1.client_event_time_ms=j;return this};h.prototype.setEvent=function(j){this.$PinnedConversationTypedLogger1.event=j;return this};h.prototype.setFtID=function(j){this.$PinnedConversationTypedLogger1.ft_id=j;return this};h.prototype.setIsRaised=function(j){this.$PinnedConversationTypedLogger1.is_raised=j;return this};h.prototype.setNotificationType=function(j){this.$PinnedConversationTypedLogger1.notification_type=j;return this};h.prototype.setPageID=function(j){this.$PinnedConversationTypedLogger1.page_id=j;return this};h.prototype.setPromoteOnInit=function(j){this.$PinnedConversationTypedLogger1.promote_on_init=j;return this};h.prototype.setReason=function(j){this.$PinnedConversationTypedLogger1.reason=j;return this};h.prototype.setTabID=function(j){this.$PinnedConversationTypedLogger1.tab_id=j;return this};h.prototype.setTabSessionID=function(j){this.$PinnedConversationTypedLogger1.tab_session_id=j;return this};h.prototype.setTabsInDock=function(j){this.$PinnedConversationTypedLogger1.tabs_in_dock=j;return this};h.prototype.setTabsInMenu=function(j){this.$PinnedConversationTypedLogger1.tabs_in_menu=j;return this};h.prototype.setVC=function(j){this.$PinnedConversationTypedLogger1.vc=j;return this};h.prototype.setWindowInnerHeight=function(j){this.$PinnedConversationTypedLogger1.window_inner_height=j;return this};h.prototype.setWindowInnerWidth=function(j){this.$PinnedConversationTypedLogger1.window_inner_width=j;return this};var i={attempt_open_on_init:true,badge_count:true,client_event_time_ms:true,event:true,ft_id:true,is_raised:true,notification_type:true,page_id:true,promote_on_init:true,reason:true,tab_id:true,tab_session_id:true,tabs_in_dock:true,tabs_in_menu:true,vc:true,window_inner_height:true,window_inner_width:true};f.exports=h}),null);
__d("ConversationNubLogger",["Arbiter","ConversationNubAddCommentSubscription","ConversationNubTabsUpdateEventController","ConversationNubUtils","PinnedConversationTypedLogger","SubscriptionsHandler","UFIUIEvents"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i){this.$ConversationNubLogger1=new(c("SubscriptionsHandler"))();this.$ConversationNubLogger2=i;this.$ConversationNubLogger3();this.$ConversationNubLogger4()}h.prototype.$ConversationNubLogger4=function(){__p&&__p();this.$ConversationNubLogger1.addSubscriptions(c("ConversationNubAddCommentSubscription").subscribe(function(i){var j=new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_add_comment");this.$ConversationNubLogger5(j,i)}.bind(this)));this.$ConversationNubLogger1.addSubscriptions(c("Arbiter").subscribe(c("UFIUIEvents").ReactionButtonClicked,function(i,j){var k=j.ft_id;if(!k)return;var l=this.$ConversationNubLogger2.getLoadedTabByFeedbackTarget(k);if(!l)return;var m=new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_react_post");this.$ConversationNubLogger5(m,l)}.bind(this)))};h.prototype.$ConversationNubLogger3=function(){__p&&__p();this.$ConversationNubLogger1.addSubscriptions(c("Arbiter").subscribe(c("ConversationNubUtils").CLOSE_TAB_EVENT,function(i,j){var k=j.tabState,l=j.sessionID,m=j.reason,n=new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_close").setReason(m);this.$ConversationNubLogger6(n,k,l)}.bind(this)));this.$ConversationNubLogger1.addSubscriptions(c("Arbiter").subscribe(c("ConversationNubUtils").UNPIN_FROM_HEADER_EVENT,function(i,j){var k=j.tab,l=new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_hide");this.$ConversationNubLogger5(l,k)}.bind(this)));this.$ConversationNubLogger1.addSubscriptions(c("Arbiter").subscribe(c("ConversationNubTabsUpdateEventController").TAB_MAXIMIZED_BY_USER_EVENT,function(i,j){var k=j.tab,l=new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_maximize");this.$ConversationNubLogger5(l,k)}.bind(this)));this.$ConversationNubLogger1.addSubscriptions(c("Arbiter").subscribe(c("ConversationNubTabsUpdateEventController").TAB_MINIMIZED_BY_USER_EVENT,function(i,j){var k=j.tab,l=new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_minimize");this.$ConversationNubLogger5(l,k)}.bind(this)));this.$ConversationNubLogger1.addSubscriptions(c("Arbiter").subscribe(c("ConversationNubUtils").OPEN_PERMALINK_FROM_HEADER_EVENT,function(i,j){var k=j.tab,l=new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_open_permalink_from_header");this.$ConversationNubLogger5(l,k)}.bind(this)))};h.prototype.$ConversationNubLogger5=function(i,j){i.setTabID(j.getTabID()).setPageID(j.getPageID()).setClientEventTimeMs(Date.now()).setTabsInMenu(this.$ConversationNubLogger2.getNumMenuTabs()).setTabsInDock(this.$ConversationNubLogger2.getNumDockTabs()).setWindowInnerWidth(window.innerWidth).setWindowInnerHeight(window.innerHeight);i.setFtID(j.getFeedbackTargetID()).setIsRaised(j.getIsRaised()).setBadgeCount(j.getBadgeCount()).setTabSessionID(j.getSessionID());var k=j.getNotificationType();if(k)i.setNotificationType(k);i.log()};h.prototype.$ConversationNubLogger6=function(i,j,k){i.setTabID(j.tabID).setClientEventTimeMs(Date.now()).setTabsInMenu(this.$ConversationNubLogger2.getNumMenuTabs()).setTabsInDock(this.$ConversationNubLogger2.getNumDockTabs()).setWindowInnerWidth(window.innerWidth).setWindowInnerHeight(window.innerHeight);i.setFtID(j.ftID).setIsRaised(j.isTabRaised).setBadgeCount(j.badgeCount).setTabSessionID(k);if(j.notificationType)i.setNotificationType(j.notificationType);i.log()};h.subscriptionTriggered=function(i){new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_subscription_triggered").setReason(i).log()};h.prototype.addTab=function(i,j){var k=new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_add").setReason(j);this.$ConversationNubLogger5(k,i)};h.prototype.destroy=function(){this.$ConversationNubLogger1.release()};f.exports=h}),null);
__d("ConversationNotificationListeners",["Bootloader","ConversationNubAddTabSource","ConversationNubLogger","FacebookWebNotificationsSubscription","NotificationConstants","NotificationUpdates","once"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("NotificationConstants").PayloadSourceType.LIVE_SEND;function i(){c("NotificationUpdates").subscribe("update-notifications",function(k,l){if(l.payloadsource===h&&l.readState&&Object.keys(l.readState).length)c("Bootloader").loadModules(["NotificationConversationController"],function(m){m.handleNotificationsRead(l.readState)},"ConversationNotificationListeners")})}var j=c("once")(function(){i();c("FacebookWebNotificationsSubscription").subscribe({event:"NEW_PINNED_CONVERSATION",callback:function k(l){c("ConversationNubLogger").subscriptionTriggered("graphql");c("Bootloader").loadModules(["NotificationConversationController"],function(m){m.handleNewNotificationFromGraphQL(l,c("ConversationNubAddTabSource").NOTIFICATION)},"ConversationNotificationListeners")}})});f.exports={initialize:function k(){j()}}}),null);
__d("FBPaymentsDialogContainerMount",["FBPaymentsDialogContainer.react","React","ReactDOM"],(function a(b,c,d,e,f,g){"use strict";var h={mount:function i(j){c("ReactDOM").render(c("React").createElement(c("FBPaymentsDialogContainer.react"),null),j)}};f.exports=h}),null);
__d("ChatActivity",["Arbiter","Event","JSLogger","MercuryConfig","PresenceState","UserActivity"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("MercuryConfig").activity_limit||6e4,i=c("MercuryConfig").idle_limit||18e5,j=c("MercuryConfig").idle_poll_interval||3e5,k=c("JSLogger").create("chat_activity"),l=Date.now(),m=true;function n(){var r=Date.now();return!!(m&&r-l<h)}var o=Object.assign(new(c("Arbiter"))(),{isActive:n});function p(){var r=l;l=Date.now();if(l-r>i){k.debug("idle_to_active",r);c("PresenceState").doSync()}o.inform("activity")}c("Event").listen(window,"focus",function(){m=true;p()});c("Event").listen(window,"blur",function(){m=false});c("UserActivity").subscribe(function(){p()});function q(r){var s=r&&r.at&&c("PresenceState").verifyNumber(r.at);if(typeof s!=="number")s=null;return s||0}setInterval(function(){var r=Date.now(),s=q(c("PresenceState").get()),t=Math.max(l,s);if(r-t>i){k.debug("idle",{cookie:s,local:l});o.inform("idle",r-t)}},j);c("PresenceState").registerStateStorer(function(r){var s=q(r);if(s<l)r.at=l;return r});c("Arbiter").subscribe(c("JSLogger").DUMP_EVENT,function(r,s){s.chat_activity={activity_limit:h,idle_limit:i,idle_poll_interval:j,last_active_time:l}});f.exports=o}),null);
__d("MercuryNotificationRenderer",["fbt","MercuryAssert","MercuryIDs","MercuryMessages","MercuryParticipants","MercuryThreads","MercuryViewer","MessagingGenericAdminTextType"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("MercuryMessages").get(),j=c("MercuryThreads").get(),k="source:messenger_growth:event_upcoming_bump";function l(m,n){__p&&__p();c("MercuryAssert").isThreadID(m);j.getThreadMeta(m,function(o){__p&&__p();i.getThreadMessagesRange(m,0,1,function(p){__p&&__p();var q=p.length&&p[p.length-1],r=[];if(q.tags!==undefined)r=r.concat(q.tags);if(q.log_message_data&&(q.log_message_data.message_type==c("MessagingGenericAdminTextType").CONFIRM_FRIEND_REQUEST||q.log_message_data.message_type==c("MessagingGenericAdminTextType").WORK_INVITE_CLAIMED))n(h._("New contact added"));else if(r.indexOf(k)!==-1)n(h._("You have an upcoming event."));else if(q&&q.author!=c("MercuryViewer").getID())c("MercuryParticipants").get(q.author,function(s){__p&&__p();var t=s.short_name,u=o.custom_nickname;if(u){var v=c("MercuryIDs").getUserIDFromParticipantID(s.id);if(u[v])t=u[v]}if(o.name)n(h._("{senderName} messaged {groupName}",[h._param("senderName",t),h._param("groupName",o.name)]));else if(c("MercuryIDs").isGroupChat(m))n(h._("{name} messaged your group",[h._param("name",t)]));else n(h._("{name} messaged you",[h._param("name",t)]))});else n(h._("New message!"))})})}f.exports={renderDocumentTitle:l}}),null);
__d("MercuryTimestampTracker",["MercuryActionType","MercuryDispatcher","MercuryPayloadSource","MercurySingletonProvider"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();h.getForFBID=function(j){return i.getForFBID(j)};h.get=function(){return i.get()};function h(j){this.$MercuryTimestampTracker1=j;this.$MercuryTimestampTracker3=0;this.$MercuryTimestampTracker2=c("MercuryDispatcher").getForFBID(this.$MercuryTimestampTracker1);this.$MercuryTimestampTracker2.subscribe("update-messages",this.$MercuryTimestampTracker4.bind(this))}h.prototype.$MercuryTimestampTracker4=function(j,k){if(!k.actions||!k.actions.length)return;if(k.payload_source===c("MercuryPayloadSource").CLIENT_SEND_MESSAGE||k.payload_source===c("MercuryPayloadSource").UNKNOWN)return;for(var l=0;l<k.actions.length;l++){var m=k.actions[l],n=m.action_type;if(n==c("MercuryActionType").USER_GENERATED_MESSAGE&&m.thread_id&&m.timestamp>this.$MercuryTimestampTracker3)this.$MercuryTimestampTracker3=m.timestamp}};h.prototype.getLastUserMessageTimestamp=function(){return this.$MercuryTimestampTracker3};var i=new(c("MercurySingletonProvider"))(h);f.exports=h}),null);
__d("ChatTitleBarBlinker",["ChatActivity","DocumentTitle","JSLogger","MercuryThreadInformer","MercuryNotificationRenderer","PresenceState","MercuryTimestampTracker"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("MercuryThreadInformer").get(),i=c("MercuryTimestampTracker").get(),j=c("JSLogger").create("chat_title"),k=null,l=0,m=false;function n(){if(k){k.stop();k=null;return true}return false}function o(u){var v=u||i.getLastUserMessageTimestamp();if(l<=v){l=v;if(n()||m)c("PresenceState").doSync()}}var p={blink:function u(v,w){if(!k&&l<w)c("MercuryNotificationRenderer").renderDocumentTitle(v,function(x){if(!k)k=c("DocumentTitle").blink(x)})},stopBlinking:function u(){o()},blinkingElsewhere:function u(){m=true}};function q(u){var v=c("PresenceState").verifyNumber(u.sb2);if(!v||v<=l)return null;return v}function r(u){var v=u&&q(u);if(v){l=v;j.debug("load",l);n();m=false}}function s(u){var v=q(u);if(!v){j.debug("store",l);u.sb2=l;m=false}return u}c("PresenceState").registerStateStorer(s);c("PresenceState").registerStateLoader(r);h.subscribe("thread-read-changed",function(u,v){var w=i.getLastUserMessageTimestamp(),x=0;for(var y in v)if(v[y].mark_as_read&&v[y].timestamp>=w&&v[y].timestamp>x)x=v[y].timestamp;x&&o(x)});c("ChatActivity").subscribe("activity",function(){return o()});var t=c("PresenceState").getInitial();if(t)l=q(t)||0;f.exports=p}),null);
__d("MercuryIgnoredBlockedParticipants.bs",["bs_caml_obj","MercuryIDs"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(l,m,n){var o=n.participants.filter(function(p){return p!==c("MercuryIDs").getParticipantIDFromUserID(l)});return o.filter(function(p){return m.has(p)!==false})}function i(l,m,n){if(n.is_canonical)return false;else return h(l,m,n).length>0}function j(l,m,n){if(n.is_canonical)return[];else return h(l,m,n)}function k(l,m,n){var o=n.is_canonical;if(o){var p=n.participants.filter(function(q){return c("bs_caml_obj").caml_notequal(q,c("MercuryIDs").getParticipantIDFromUserID(l))});return!p.every(function(q){return!m.has(q)})}else return false}g.findIntersection=h;g.isPresentInGroupThread=i;g.participantsInGroupThread=j;g.qualifiesAs=k}),null);
__d("MercuryBrowserAlerts",["ArbiterMixin","ChatActivity","ChatConfig","ChatOptions","ChatTitleBarBlinker","CurrentUser","Event","MercuryIgnoredBlockedParticipants.bs","MercuryIDs","MercuryThreadInfo","MercuryThreads","MercuryViewer","MessagingTag","MessengerState.bs","Sound","UserActivity"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("MercuryThreads").get(),i=3,j=6e5,k=new Map(),l=null;function m(){return!c("UserActivity").isOnTab()&&!c("UserActivity").hasBeenInactive()}function n(){k=new Map()}function o(q){if(c("ChatOptions").getSetting("sound")&&!m())c("Sound").play([c("ChatConfig").get("sound.notif_ogg_url"),c("ChatConfig").get("sound.notif_mp3_url")],q,false)}var p=Object.assign({init:function q(){c("Event").listen(window,"focus",function(){n();clearInterval(l)});c("Event").listen(window,"blur",function(){l=setInterval(n,j)})},messageReceived:function q(r){__p&&__p();if(r.author&&c("MercuryViewer").isViewer(r.author)||!r.is_unread||r.folder!=c("MessagingTag").INBOX&&r.folder!=c("MessagingTag").ARCHIVED)return;var s=r.thread_id,t=c("ChatActivity").isActive();if(t){var u=false;p.inform("before-alert",{threadID:s,cancelAlert:function v(){u=true}})}h.getThreadMeta(s,function(v){__p&&__p();var w=c("MercuryThreadInfo").isMuted(v),x=c("MercuryIDs").getUserIDFromParticipantID(c("MercuryViewer").getID());if(w)if(!c("MercuryThreadInfo").areMentionsMuted(v)){if(!r.profile_ranges||!r.profile_ranges.some||!r.profile_ranges.some(function(z){return z.id===x}))return}else return;var y=c("CurrentUser").getID();c("MessengerState.bs").compute(y,function(z){__p&&__p();var A=z.blocked_ids;if(c("MercuryIgnoredBlockedParticipants.bs").isPresentInGroupThread(y,A,v))return;var B=r.timestamp;if(t)!u&&o(B);else{c("ChatTitleBarBlinker").blink(s,B);var C=k.get(s)||0;if(C<i){k.set(s,C+1);o(B)}}c("ChatTitleBarBlinker").blinkingElsewhere()})})}},c("ArbiterMixin"));f.exports=p}),null);
__d("ChatAppActionTypes",["keyMirror"],(function a(b,c,d,e,f,g){"use strict";f.exports=c("keyMirror")({INITIAL_DISPLAY_DONE:null,HIDE:null,LOAD:null,TTI:null,UNHIDE:null})}),null);
__d("ChatAppActions",["ChatDispatcher","ChatAppActionTypes"],(function a(b,c,d,e,f,g){"use strict";var h={tti:function i(){c("ChatDispatcher").dispatch({type:c("ChatAppActionTypes").TTI})},hide:function i(){c("ChatDispatcher").dispatch({type:c("ChatAppActionTypes").HIDE})},unhide:function i(){c("ChatDispatcher").dispatch({type:c("ChatAppActionTypes").UNHIDE})},setInitialDisplayDone:function i(){c("ChatDispatcher").dispatch({type:c("ChatAppActionTypes").INITIAL_DISPLAY_DONE})},load:function i(){c("ChatDispatcher").dispatch({type:c("ChatAppActionTypes").LOAD})}};f.exports=h}),null);
__d("ChatAppStore",["ChatAppActionTypes","ChatDispatcher","FluxStore"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("FluxStore"));i=h&&h.prototype;function j(){i.constructor.call(this,c("ChatDispatcher"));this.__moduleID=f.id;this.$ChatAppStore2={initialDisplayDone:false,isHidden:false,isInitialized:false,isLoaded:false};this.$ChatAppStore1=babelHelpers["extends"]({},this.$ChatAppStore2)}j.prototype.__onDispatch=function(k){__p&&__p();var l=k.type;this.$ChatAppStore1=babelHelpers["extends"]({},this.$ChatAppStore2);switch(l){case c("ChatAppActionTypes").INITIAL_DISPLAY_DONE:this.$ChatAppStore2.initialDisplayDone=true;this.__emitChange();break;case c("ChatAppActionTypes").HIDE:this.$ChatAppStore2.isHidden=true;this.__emitChange();break;case c("ChatAppActionTypes").UNHIDE:this.$ChatAppStore2.isHidden=false;this.__emitChange();break;case c("ChatAppActionTypes").TTI:this.$ChatAppStore2.isInitialized=this.$ChatAppStore2.isLoaded=true;this.__emitChange();break;case c("ChatAppActionTypes").LOAD:this.$ChatAppStore2.isLoaded=true;this.__emitChange();break}};j.prototype.getPreviousState=function(){return this.$ChatAppStore1};j.prototype.getState=function(){return this.$ChatAppStore2};f.exports=new j()}),null);
__d("ChatPrivacyActionController",["ChatVisibility","JSLogger","PresencePrivacy"],(function a(b,c,d,e,f,g){__p&&__p();var h=function h(i,j){__p&&__p();this._userID=i;this._logger=c("JSLogger").create("blackbird");this._getState=function(){if(c("ChatVisibility").isOnline())return c("PresencePrivacy").allows(this._userID)?h.NORMAL:h.BLOCKED;return h.OFFLINE};this._togglePrivacy=function(){__p&&__p();var l=this._getState();switch(this._getState()){case h.OFFLINE:if(c("ChatVisibility").isOnline()){this._logger.error("tabs_already_online");break}this._logger.log("tabs_go_online",{tab_id:this._userID});c("ChatVisibility").goOnline(function(){if(!c("PresencePrivacy").allows(this._userID)){if(this._getState()!==h.BLOCKED)this._logger.error("privacy_action_controller_blocked_inconsistency");this._togglePrivacy()}}.bind(this));break;case h.BLOCKED:c("PresencePrivacy").allow(this._userID);this._logger.log("tabs_unblock",{tab_id:this._userID});break;case h.NORMAL:c("PresencePrivacy").disallow(this._userID);this._logger.log("tabs_block",{tab_id:this._userID});break}};var k=function(){j&&j(this._getState())}.bind(this);k();this._subscribeToken=c("PresencePrivacy").subscribe("privacy-changed",k)};h.OFFLINE="offline";h.BLOCKED="blocked";h.NORMAL="normal";Object.assign(h.prototype,{togglePrivacy:function i(){this._logger.log("gear_menu_toggle_privacy",{tab_id:this._userID});this._togglePrivacy()},destroy:function i(){this._subscribeToken&&c("PresencePrivacy").unsubscribe(this._subscribeToken)}});f.exports=h}),null);
__d("ChatTimezoneWarning",["MercuryParticipants","MercuryViewer","MessengerBotIDs"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=1,i={updateUserTimezoneWarning:function j(k,l,m){__p&&__p();c("MercuryParticipants").get(c("MercuryViewer").getID(),function(n){__p&&__p();var o=n.employee,p=n.timezone,q=0;if(k.timezone_warning_dismiss_count!==undefined){var r=k.timezone_warning_dismiss_count;for(var s=Object.entries(r),t=Array.isArray(s),u=0,s=t?s:s[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var v;if(t){if(u>=s.length)break;v=s[u++]}else{u=s.next();if(u.done)break;v=u.value}var w=v,x=w[0],y=w[1];if(x===n.fbid)q=Number(y)}}else return;if(o&&p&&q<h)c("MercuryParticipants").getMulti(k.participants,function(z){__p&&__p();var A={},B=true;for(var C in z){B=B&&z[C].employee;var D=!!c("MessengerBotIDs")[z[C].fbid];if(z[C].timezone!==undefined&&z[C].timezone!==null&&p!==z[C].timezone&&!D){var E=z[C].fbid;A[E]=z[C]}}if(Object.keys(A).length>0&&B){A.self=n;l(A)}else m()})})}};f.exports=i}),null);
__d("FantaAvailableStatus",["AvailableListConstants","ChatVisibility","MercuryIDs","PresenceStatus","ShortProfiles"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();f.exports={isAvailable:function h(i,j){var k=void 0,l=this.getStatus(i,j),m=c("MercuryIDs").getUserIDFromThreadID(j);if(m)k=c("ShortProfiles").getNow(m);return l===c("AvailableListConstants").ACTIVE&&(k===undefined||k===null||!k.is_messenger_only)},getStatus:function h(i,j){__p&&__p();var k=c("AvailableListConstants").OFFLINE,l=c("MercuryIDs").getUserIDFromThreadID(j);if(l)k=c("PresenceStatus").get(l);else if(i){var m=i.participants.map(function(n){return c("MercuryIDs").getUserIDFromParticipantID(n)});k=c("PresenceStatus").getGroup(m)}if(!c("ChatVisibility").isOnline())k=c("AvailableListConstants").OFFLINE;return k}}}),null);
__d("ChatVideoCallButton.react",["cx","fbt","invariant","Bootloader","FantaAvailableStatus","FBIDCheck","FBRTCCallabilityStore","FBRTCCore","immutable","ImmutableObject","Keys","LayerFadeOnHide","Link.react","MercuryIDs","MercuryParticipants","MercuryThreadIDMap","MessengerRTCFunnelLogger","ReactComponentWithPureRenderMixin","React","RTCCallState","StoreAndPropBasedStateMixin","TrackingNodes","FBRTCLogger","VideoCallTypedLogger","XUIAmbientNUX.react"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k=c("MercuryThreadIDMap").get(),l=c("FBRTCLogger").Trigger,m=c("React").PropTypes,n={isCallable:false,shown:false,user:null},o=c("React").createClass({displayName:"ChatVideoCallButton",mixins:[c("ReactComponentWithPureRenderMixin"),c("StoreAndPropBasedStateMixin")(c("FBRTCCallabilityStore"),c("MercuryParticipants"))],propTypes:{isAudio:m.bool,isGroupChat:m.bool,onRTCNuxCloseButtonClick:m.func.isRequired,rtcNuxShown:m.bool.isRequired,threadID:m.string,thread:m.object,viewer:m.string.isRequired,shown:m.bool,rtcCallData:m.object.isRequired},getDefaultProps:function p(){return{shown:true,rtcCallData:{call_state:"NO_ONGOING_CALL"}}},statics:{calculateState:function p(q){__p&&__p();if(!q.threadID)return babelHelpers["extends"]({},n);if(q.isGroupChat)return{isCallable:true,shown:q.shown,user:null};var r=c("MercuryIDs").getUserIDFromThreadID(q.threadID);if(r===q.viewer||!c("FBIDCheck").isUser_deprecated(r))return babelHelpers["extends"]({},n);r&&c("FBIDCheck").isUser_deprecated(r)||j(0);var s=c("MercuryIDs").getParticipantIDFromUserID(r),t=c("MercuryParticipants").getOrFetch(s);return{isCallable:!c("FBRTCCallabilityStore").isBlocked(r,q.thread)&&c("FBRTCCallabilityStore").isCallable(r,q.thread),shown:q.shown,user:t}}},getTooltipLabel:function p(){if(this.props.isGroupChat)return this.props.isAudio?i._("Start a group call"):i._("Start a group video chat");var q=this.state.user;if(!q)return undefined;return this.props.isAudio?c("FBRTCCallabilityStore").voiceCallButtonTooltip(q.fbid,q.short_name,this.state.isCallable,this.props.thread):c("FBRTCCallabilityStore").callButtonTooltip(q.fbid,q.short_name,this.state.isCallable,this.props.thread)},render:function p(){if(!this.state.shown)return null;var q=c("TrackingNodes").getTrackingInfo(this.props.isAudio?c("TrackingNodes").types.VIDEOCHAT:c("TrackingNodes").types.VOICECHAT),r=JSON.stringify({videochat:"call_clicked_bhat_tab"}),s=this.props.threadID&&c("FantaAvailableStatus").isAvailable(this.props.thread,this.props.threadID),t=s&&this.state.isCallable;return c("React").createElement("div",null,c("React").createElement(c("Link.react"),{"aria-label":this.getTooltipLabel(),className:"button _3olv"+(this.props.isAudio?" _2fpc":"")+(!this.props.isAudio?" _2fpd":"")+(this.state.isCallable?" enabled":""),"data-ft":q,"data-gt":r,"data-hover":"tooltip","data-tooltip-content":this.getTooltipLabel(),"data-tooltip-position":"above",onClick:this._handleClick,onKeyUp:this._handleKeyUp,ref:"button"}),c("React").createElement("div",{className:t&&!this.props.isAudio?"_18pe":""}),c("React").createElement(c("XUIAmbientNUX.react"),{alignment:"right",behaviors:{LayerFadeOnHide:c("LayerFadeOnHide")},contextRef:function(){return this.refs.button}.bind(this),onCloseButtonClick:this.props.onRTCNuxCloseButtonClick,shown:this.props.rtcNuxShown,width:"auto"},i._("You can now make a group call.")))},_handleClick:function p(q){q.preventDefault();this._startCall()},_handleKeyUp:function p(q){q.preventDefault();if(q.keyCode!==c("Keys").RETURN)return;if(q.target){q.target instanceof HTMLElement||j(0);q.target.blur()}this._startCall()},_startCall:function p(){c("MessengerRTCFunnelLogger").startFunnel("ChatTab");if(!this.state.isCallable){c("MessengerRTCFunnelLogger").endFunnel("callee_not_callable");return}this.props.onRTCNuxCloseButtonClick();this._initiateCall()},_initiateCall:function p(){__p&&__p();var q=this.props,r=q.isAudio,s=q.isGroupChat,t=q.threadID;!!t||j(0);var u=r?"audio":"video";if(s)if(c("MercuryIDs").isLocalThread(t))k.getServerIDFromClientID(t,function(v){return this._initiateGroupCall(v)}.bind(this));else{c("MessengerRTCFunnelLogger").appendAction("start_in_group_thread");this._initiateGroupCall(c("MercuryIDs").getThreadFBIDFromThreadID(t))}else{c("MessengerRTCFunnelLogger").appendAction("start_in_p2p_thread");c("FBRTCCore").startOutgoingCall(this.state.user.fbid,u,!!r);new(c("VideoCallTypedLogger"))().setEvent("chat_tab_call_click").log()}},_initiateGroupCall:function p(q){__p&&__p();var r=this.props,s=r.isAudio,t=r.rtcCallData,u=t.call_state,v=t.server_info_data;if(u!=="NO_ONGOING_CALL"&&v){c("MessengerRTCFunnelLogger").appendAction("join_existing_call");c("FBRTCCore").startGroupCall({conferenceName:"GROUP:"+q,hasVideo:!s,serverInfoData:v,trigger:u!==c("RTCCallState").AUDIO_GROUP_CALL?s?l.MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_AUDIO_BUTTON:l.MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_VIDEO_BUTTON:s?l.MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_AUDIO_BUTTON:l.MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_VIDEO_BUTTON});return}c("Bootloader").loadModules(["FBRTCSupport","MercuryThreads","MessengerParticipantsFetcher.bs","FBRTCUnsupportedBrowserMessage","MessengerRTCGroupCallParticipantsPickerDialogController"],function(w,x,y,z,A){__p&&__p();if(!w.isGroupCallWebtrcSupported()){c("MessengerRTCFunnelLogger").endFunnel("unsupported_browser");z.showForOutgoingGroupCall();return}x.get().getThreadMeta(this.props.threadID,function(B){var C=B.participants?B.participants.filter(function(D){return D!==c("MercuryIDs").getParticipantIDFromUserID(this.props.viewer)}.bind(this)).map(function(D){return c("MercuryIDs").getUserIDFromParticipantID(D)}):[];if(C.length>0)y.fetch({ids:C}).done(function(C){c("MessengerRTCFunnelLogger").appendAction("render_participant_picker");A.render({participants:c("immutable").Map(C.map(function(D){return[D.id,new(c("ImmutableObject"))(D)]})),thread:B,viewerID:this.props.viewer,trigger:this.props.isAudio?l.MULTIWAY_THREAD_HEADER_AUDIO_BUTTON:l.MULTIWAY_THREAD_HEADER_VIDEO_BUTTON,conferenceName:"GROUP:"+q,hasVideo:!this.props.isAudio})}.bind(this))}.bind(this))}.bind(this),"ChatVideoCallButton.react")}});f.exports=o}),null);
__d("MercuryTypeaheadDataSource",["CurrentUser","DataSource","MercuryParticipantTypes","MercuryTypeaheadConstants","OrderedFriendsList","ShortProfiles","WorkModeConfig"],(function a(b,c,d,e,f,g){__p&&__p();var h,i,j=[],k={},l={},m={},n=[],o=false,p=false;h=babelHelpers.inherits(q,c("DataSource"));i=h&&h.prototype;function q(r){"use strict";r=r||{};r.kanaNormalization=true;i.constructor.call(this,r);this.showDefaultList=r.showDefaultList||false}q.prototype.dirty=function(){"use strict";this.$MercuryTypeaheadDataSource1=j;this.localCache=l;this.queryCache=k;this.queryIDs=m;this.defaultList=n;return this};q.prototype.bootstrap=function(){"use strict";__p&&__p();if(o||p)return false;p=true;c("ShortProfiles").fetchAll().then(function(){this.updateBootstrapData();p=false;o=true;if(this.showDefaultList)this.inform("show-default")}.bind(this),function(){}.bind(this));return true};q.prototype.updateBootstrapData=function(){"use strict";__p&&__p();var r=this.getCachedShortProfileIDs(),s=c("WorkModeConfig").is_work_user?c("MercuryParticipantTypes").FB4C:c("MercuryParticipantTypes").FRIEND,t=r.map(function(v){var w=c("ShortProfiles").getNow(v),x=v==c("CurrentUser").getID()?s:w.type,y=[w.additionalName,w.alternateName].concat(w.searchTokens||[]).join(" "),z=w.name,A=null;return{uid:v,index:c("OrderedFriendsList").getActiveRank(v),text:z,subtext:A,tokens:y,localized_text:w.name,additional_text:w.additionalName,photo:w.thumbSrc,render_type:x,type:c("MercuryTypeaheadConstants").USER_TYPE}});if(t.length)this.addEntries(t);if(!this.showDefaultList)return;var u=t.sort(function(v,w){return v.index-w.index}).slice(0,5);n=this.buildData(u.map(function(v){return v.uid}));this.defaultList=n};q.prototype.query=function(r,s,t,u){"use strict";var v=s||r.length===1;return i.query.call(this,r,v,t,u)};q.prototype.getQueryData=function(r,s){"use strict";return babelHelpers["extends"]({},i.getQueryData.call(this,r,s))};q.prototype.setEntry=function(r,s){"use strict";this.$MercuryTypeaheadDataSource1[r]=s};q.prototype.getEntry=function(r){"use strict";return this.$MercuryTypeaheadDataSource1[r]||null};q.prototype.getCachedShortProfileIDs=function(){"use strict";var r=c("ShortProfiles").getCachedProfileIDs(),s=r.filter(function(t){var u=c("ShortProfiles").getNow(t);return t==c("CurrentUser").getID()||u.type===c("MercuryParticipantTypes").FRIEND||u.type===c("MercuryParticipantTypes").FB4C});return s};q.prototype.isBootstrapped=function(){"use strict";return o};q.prototype.isBootstrapping=function(){"use strict";return p};q.prototype.processEntries=function(r,s){"use strict";r=r.map(function(t){if(t.index==null&&(t.render_type===c("MercuryParticipantTypes").FRIEND||t.render_type===c("MercuryParticipantTypes").FB4C))t.index=c("OrderedFriendsList").getActiveRank(t.uid);return t});return i.processEntries.call(this,r)};q.prototype.mergeUids=function(r,s,t,u){"use strict";var v=s.sort(function(w,x){return this.getEntry(w).index-this.getEntry(x).index}.bind(this));return i.mergeUids.call(this,r,v,t,u)};q.prototype.setShowDefaultList=function(r){"use strict";this.showDefaultList=r};f.exports=q}),null);
__d("ChatTabTypeaheadDataSource",["MercuryTypeaheadConstants","MercuryTypeaheadDataSource"],(function a(b,c,d,e,f,g){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("MercuryTypeaheadDataSource"));i=h&&h.prototype;function j(k){"use strict";k=k||{};k.maxResults=c("MercuryTypeaheadConstants").COMPOSER_CHATTAB_MAX;i.constructor.call(this,k);this.$ChatTabTypeaheadDataSource1=true}j.prototype.buildData=function(k){"use strict";__p&&__p();var l=[],m=[],n=[],o=[],p=[],q=[],r=[];k.forEach(function(t){__p&&__p();var u=i.getEntry.call(this,t);switch(u.render_type){case c("MercuryTypeaheadConstants").FRIEND_TYPE:l.push(t);break;case c("MercuryTypeaheadConstants").THREAD_TYPE:if(this.$ChatTabTypeaheadDataSource1)m.push(t);break;case c("MercuryTypeaheadConstants").NON_FRIEND_TYPE:n.push(t);break;case c("MercuryTypeaheadConstants").FB4C_TYPE:o.push(t);break;case c("MercuryTypeaheadConstants").PAGE_TYPE:if(this.$ChatTabTypeaheadDataSource1)p.push(t);break;case c("MercuryTypeaheadConstants").INTERNAL_BOT_PAGE_TYPE:r.push(t);break;default:break}}.bind(this),this);var s=q.concat(l,o,m,p,n,r);return i.buildData.call(this,s)};j.prototype.query=function(k,l,m,n){"use strict";return i.query.call(this,k,l,m,n)};j.prototype.respond=function(k,l,m){"use strict";return i.respond.call(this,k,l,m)};j.prototype.setShowThreads=function(k){"use strict";this.$ChatTabTypeaheadDataSource1=k};f.exports=j}),null);
__d("DisplayGenderConst",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({UNKNOWN:"UNKNOWN",FEMALE:"FEMALE",MALE:"MALE",NEUTER:"NEUTER"})}),null);
__d("MessengerGroupsSyncStatus.bs",["MessengerGroupsSyncStatus"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i){__p&&__p();if(i==null)return null;else switch(i){case"OPT_IN":return c("MessengerGroupsSyncStatus").OPT_IN;case"OPT_OUT":return c("MessengerGroupsSyncStatus").OPT_OUT;case"PENDING_OPT_IN":return c("MessengerGroupsSyncStatus").PENDING_OPT_IN;case"PENDING_OPT_OUT":return c("MessengerGroupsSyncStatus").PENDING_OPT_OUT;case"UNSET":return c("MessengerGroupsSyncStatus").UNSET;case"UNSUPPORTED":return c("MessengerGroupsSyncStatus").UNSUPPORTED;default:return null}}g.fromNullableString=h}),null);
__d("MessengerServerPayloadTransformer.bs",["URI","FBID.bs","bs_array","Utils.bs","bs_string","getByPath","bs_caml_array","MercuryIDs","bs_caml_format","GenderConst","bs_js_primitive","WorkModeConfig","bs_js_null_undefined","DisplayGenderConst","MessagingThreadType","MessengerGroupsSyncStatus.bs","MessengerMessageTransformer.bs","MessengerAttachmentTransformer.bs","MessengerThreadCannotReplyReason"],(function aa(ba,a,ca,da,ea,b){"use strict";__p&&__p();function fa(d){__p&&__p();var e=d.location_coordinates,f=e==null?[null,null]:[e.latitude,e.longitude],g=d.location_page,h;if(g==null)h=null;else{var i=g.address;h=i==null?null:i.full_address}var j=d.allows_rsvp,k=j?1:0,l=a("bs_array").fold_left(function(n,o){n[o.node.id]=o.guest_list_state;return n},{},d.event_reminder_members.edges),m=d.lightweight_event_creator;return{creator_id:m==null?null:m.id,event_members:l,event_time:d.time,event_type:d.lightweight_event_type,latitude:f[0],longitude:f[1],location_address:h,location_name:d.location_name,note:d.note,oid:d.id,related_event:d.related_event,repeat_mode:d.repeat_mode,seconds_to_notify_before:d.seconds_to_notify_before,status:d.lightweight_event_status,title:d.event_title,track_rsvp:k}}function ga(d){__p&&__p();var e=d.associated_object;if(e==null)return null;else{var f=e.action_link,g;if(f==null)g=null;else{var h=a("WorkModeConfig").is_work_user,i=h?a("WorkModeConfig").company_subdomain+".facebook.com":"www.facebook.com";g=new(a("URI"))(f).setDomain(i)}var j=e.profile_picture;return{id:e.id,name:e.name,action_link:g,profile_picture:j==null?null:{uri:j.uri},room_type:e.room_type,privacy_mode:e.privacy_mode,approval_mode_toggleable:e.approval_mode_toggleable,start_timestamp:e.start_timestamp,event_place:e.event_place,mentorship_program:e.mentorship_program}}}function ha(d){var e=d.related_page_thread;if(e==null)return null;else{var f=a("bs_array").map(function(i){return i.name},e.custom_thread_tags.nodes),g=e.page,h=g==null?null:g.id;return{flagged:e.is_flagged,pageID:h,customTagNames:f}}}function ia(d){__p&&__p();var e=d.thread_key.other_user_id;if(e==null)return false;else{var f=d.all_participants.nodes;return a("bs_array").fold_left(function(g,h){var i=h.messaging_actor;if(i.id===e)return i.__typename==="User";else return g},false,f)}}function ja(d){__p&&__p();if(d.length===0)return null;else{var e={};a("bs_array").iter(function(f){var g=f.nickname;if(g==null)return 0;else{e[f.participant_id]=g;return 0}},d);return e}}function ka(d){if(!(d==null)&&d!=="")return"#"+a("bs_string").sub(d,2,d.length-2|0);else return null}function la(d){return d.thread_key.thread_fbid}function ma(d){return d.thread_key.other_user_id}function na(d){return a("bs_js_primitive").null_undefined_to_opt(a("getByPath")(d,["messages","page_info"]))}function c(d){__p&&__p();var e=d.gender,f=d.url,g;if(f==null)g=null;else{var h=a("WorkModeConfig").is_work_user,i=h?a("WorkModeConfig").company_subdomain+".facebook.com":"www.facebook.com";g=new(a("URI"))(f).getUnqualifiedURI().setDomain(i).setProtocol("https").toString()}var j=d.big_image_src,k=d.big_image_src,l=d.__typename,m;switch(l){case"Page":m="page";break;case"User":m="user";break;default:m=null}var n=d.accepts_messenger_user_feedback,o=d.is_viewer_friend,p=d.is_messenger_user,q=d.is_verified,r=d.is_messenger_platform_bot,s=d.is_message_blocked_by_viewer,t=d.is_blocked_by_viewer,u=d.is_viewer_subscribed_to_message_updates,v=d.is_viewer_coworker,w=d.scim_company_user,x;if(w==null)x=null;else{var y=w.company_title;if(y==="")x=null;else{var z=a("bs_js_null_undefined").bind(d.work_info,function(D){return a("bs_js_null_undefined").bind(D.work_community,function(E){return E.name})}),A=a("Utils.bs").nullUndefinedBooleanToOptionBool(d.is_viewer_coworker);x=!(z==null)&&A&&!A[0]?""+(String(y)+(" \u2022 "+(String(z)+""))):y}}var B=d.work_info,C=d.is_employee;return{id:"fbid:"+d.id,fbid:d.id,gender:e==null?a("GenderConst").NOT_A_PERSON:e===a("DisplayGenderConst").MALE?a("GenderConst").MALE_SINGULAR:e===a("DisplayGenderConst").FEMALE?a("GenderConst").FEMALE_SINGULAR:a("GenderConst").NOT_A_PERSON,href:g,image_src:j==null?null:j.uri,big_image_src:k==null?null:k.uri,name:d.name,short_name:a("Utils.bs").$pipe$unknown(a("bs_js_primitive").null_undefined_to_opt(d.short_name),d.name),type:m,vanity:d.username,accepts_messenger_user_feedback:n==null?false:n,is_friend:o==null?false:o,is_messenger_user:p==null?false:p,is_business_enabled:d.__typename==="Page"?true:false,is_verified:q==null?false:q,is_messenger_platform_bot:r==null?false:r,is_messenger_ignored:null,is_messenger_blocked:s==null?false:s,is_facebook_blocked:t==null?false:t,is_subscribed_to_page_updates:u==null?true:u,is_coworker:v==null?true:v,title:x,availability_status:B==null?null:B.availability_status,employee:C==null?false:C,instant_game_channel:d.__typename==="Page"?d.instant_game_channel:null}}function oa(d){return a("bs_array").map(function(e){return c(e.messaging_actor)},d.all_participants.nodes)}function pa(d,e){__p&&__p();var f=e.read_receipts;if(f==null)return 0;else{var g={};a("bs_array").iter(function(h){var f=h.actor;if(!(f==null)&&d!==f.id){g[f.id]={action:a("bs_caml_format").caml_float_of_string(h.action),watermark:a("bs_caml_format").caml_float_of_string(h.watermark)};return 0}else return 0},f.nodes);return[g]}}function qa(d){__p&&__p();var e=d.delivery_receipts;if(e==null)return[];else return e.nodes.sort(function(f,g){var h=a("bs_caml_format").caml_float_of_string(f.timestamp_precise),i=a("bs_caml_format").caml_float_of_string(g.timestamp_precise);if(h>i)return-1;else if(h===i)return 0;else return 1})}function ra(d,e,f){var g=e.messages;if(g==null)return 0;else return[a("bs_array").map(function(h){return a("MessengerMessageTransformer.bs").transformMessage(d,h,{thread_id:null,thread_fbid:e.thread_key.thread_fbid,other_user_fbid:e.thread_key.other_user_id,folder:a("bs_string").lowercase(e.folder)},f)},g.nodes)]}function sa(d,e,f){__p&&__p();var g=a("bs_array").map(function(Z){var ua=a("MessengerMessageTransformer.bs").unsafeCastBlobAttachments(Z),i=Z.extensible_attachment,$;if(i==null)$=null;else{var j=i.story_attachment;$={legacy_attachment_id:i.legacy_attachment_id,story_attachment:j==null?null:a("MessengerMessageTransformer.bs").unsafeCastExtensibleAttachment(j)}}return{snippet:Z.snippet,message_sender:Z.message_sender,timestamp_precise:Z.timestamp_precise,commerce_message_type:Z.commerce_message_type,extensible_attachment:$,blob_attachments:ua,sticker:Z.sticker,extensible_message_admin_text:Z.extensible_message_admin_text}},e.last_message.nodes),h={thread_key:e.thread_key,name:e.name,all_participants:e.all_participants,last_message:{nodes:g},unread_count:e.unread_count,message_count:e.messages_count,image:e.image,updated_time_precise:e.updated_time_precise,mute_until:e.mute_until,is_pin_protected:e.is_pin_protected,is_viewer_subscribed:e.is_viewer_subscribed,is_canonical_neo_user:e.is_canonical_neo_user,thread_queue_enabled:e.thread_queue_enabled,folder:e.folder,has_viewer_archived:e.has_viewer_archived,is_page_follow_up:e.is_page_follow_up,cannot_reply_reason:e.cannot_reply_reason,ephemeral_ttl_mode:e.ephemeral_ttl_mode,customization_info:e.customization_info,thread_admins:e.thread_admins,approval_mode:e.approval_mode,joinable_mode:e.joinable_mode,thread_queue_metadata:e.thread_queue_metadata,event_reminders:e.event_reminders,montage_thread:e.montage_thread,last_read_receipt:e.last_read_receipt,related_page_thread:e.related_page_thread,rtc_call_data:e.rtc_call_data,associated_object:e.associated_object,reactions_mute_mode:e.reactions_mute_mode,mentions_mute_mode:e.mentions_mute_mode,privacy_mode:e.privacy_mode,customization_enabled:e.customization_enabled,thread_type:e.thread_type,participant_add_mode_as_string:e.participant_add_mode_as_string,participants_event_status:e.participants_event_status,marketplace_thread_data:e.marketplace_thread_data,page_comm_item:e.page_comm_item,group_approval_queue:e.group_approval_queue,admin_model_status_string:e.admin_model_status_string,groups_sync_status_string:e.groups_sync_status_string,groups_sync_metadata:e.groups_sync_metadata},i=h.customization_info,j;if(i==null)j=[null,null,null];else{var k=i.emoji;j=[ka(i.outgoing_bubble_color),k==null?null:{emoji:k},ja(i.participant_customizations)]}var l=h.page_comm_item,m=l==null?[null,null,null,null,null]:[l.comm_status,l.comm_source_id,l.id,l.subtitle,l.comm_item_owners],n=h.last_message.nodes.length!==0?[a("bs_caml_array").caml_array_get(h.last_message.nodes,0)]:0,o=h.last_read_receipt.nodes.length!==0?[a("bs_caml_array").caml_array_get(h.last_read_receipt.nodes,0)]:0,p;if(n){var q=n[0];p=a("MessengerAttachmentTransformer.bs").transformAttachment(d,{extensible_attachment:q.extensible_attachment,blob_attachments:q.blob_attachments,sticker:q.sticker},f)}else p=[];var r;if(n){var s=n[0].extensible_message_admin_text;if(s==null)r=null;else{var t=s.game;r=t==null?null:t.id}}else r=null;var u=h.cannot_reply_reason,v=h.thread_queue_metadata,w=h.thread_type,x=h.montage_thread,y=h.image,z=h.thread_key.other_user_id,A=h.thread_queue_metadata,B=h.name,C=h.thread_key.other_user_id,D;if(C==null){var E=h.thread_key.thread_fbid;D=E==null?null:E}else D=C;var F=h.rtc_call_data,G;if(F==null)G=null;else{var H=F.initiator;G={call_state:F.call_state,server_info_data:F.server_info_data,initiator_fbid:H==null?0:a("bs_caml_format").caml_float_of_string(H.id)}}var I=h.marketplace_thread_data,J;if(I==null)J=null;else{var K=I.for_sale_item,L;if(K==null)L=null;else{var M=K.id,N=K.formatted_price,O=K.location,P;if(O==null)P=null;else{var Q=O.reverse_geocode;P={reverse_geocode:Q==null?null:{city:Q.city,state:Q.state}}}var R=K.primary_photo,S;if(R==null)S=null;else{var T=R.image;S=T==null?null:T.uri}L={id:M==null?0:a("bs_caml_format").caml_float_of_string(M),story_id:K.story_id,title:K.group_commerce_item_title,price:N==null?null:N.text,location:P,is_sold:K.is_sold,image_uri:S,url:K.url}}var U=I.buyer,V=I.seller;J={for_sale_item:L,buyer_fbid:U==null?0:a("bs_caml_format").caml_float_of_string(U.id),seller_fbid:V==null?0:a("bs_caml_format").caml_float_of_string(V.id)}}var W=h.group_approval_queue,X=h.groups_sync_metadata,Y;if(X==null)Y=null;else{var ta=X.fb_group;Y=ta==null?null:ta.url}return{admin_ids:a("bs_array").map(function(Z){return Z.id},h.thread_admins),approval_mode:h.approval_mode,approval_queue_ids:v==null?[]:a("bs_array").map(function(Z){return a("MercuryIDs").getParticipantIDFromUserID(a("FBID.bs").ofStringExn(Z.id))},v.approval_requests.nodes),can_reply:u==null?true:false,cannot_reply_reason:h.cannot_reply_reason,custom_color:j[0],custom_like_icon:j[1],custom_nickname:j[2],customization_enabled:h.customization_enabled,thread_type:w==null?null:a("bs_js_null_undefined").fromOption(a("bs_js_primitive").undefined_to_opt(a("MessagingThreadType")[w])),participant_add_mode:h.participant_add_mode_as_string,ephemeral_ttl_mode:h.ephemeral_ttl_mode,folder:a("bs_string").lowercase(h.folder),has_email_participant:u==null?false:u===a("MessengerThreadCannotReplyReason").HAS_EMAIL_PARTICIPANT,has_montage:x==null?false:true,image_src:y==null?null:y.uri,is_archived:h.has_viewer_archived,is_page_follow_up:h.is_page_follow_up,is_canonical_user:ia(h),is_canonical:z==null?false:true,is_pin_protected:h.is_pin_protected,is_subscribed:h.is_viewer_subscribed,is_canonical_neo_user:h.is_canonical_neo_user,is_thread_queue_enabled:A==null?false:true,joinable_mode:{mode:a("bs_caml_format").caml_int_of_string(h.joinable_mode.mode),link:h.joinable_mode.link},last_message_timestamp:n?a("bs_caml_format").caml_float_of_string(n[0].timestamp_precise):0,last_message_type:n?n[0].commerce_message_type:null,last_read_timestamp:o?a("bs_caml_format").caml_float_of_string(o[0].timestamp_precise):0,lightweight_event:h.event_reminders.nodes.length===0?null:fa(a("bs_caml_array").caml_array_get(h.event_reminders.nodes,0)),message_count:h.message_count,mute_until:h.mute_until,name:B==null?"":B,other_user_fbid:h.thread_key.other_user_id,page_thread_info:ha(h),participants:a("bs_array").map(function(Z){return a("MercuryIDs").getParticipantIDFromUserID(Z.messaging_actor.id)},h.all_participants.nodes),participants_event_status:h.participants_event_status,read_only:u==null?false:u===a("MessengerThreadCannotReplyReason").READ_ONLY,recipients_loadable:u==null?true:u!==a("MessengerThreadCannotReplyReason").RECIPIENTS_NOT_LOADABLE,server_timestamp:a("bs_caml_format").caml_float_of_string(h.updated_time_precise),snippet_attachments:p,snippet_sender:n?a("MercuryIDs").getParticipantIDFromUserID(n[0].message_sender.messaging_actor.id):null,snippet:n?n[0].snippet:null,thread_fbid:D,thread_id:"",timestamp:a("bs_caml_format").caml_float_of_string(h.updated_time_precise),unread_count:h.unread_count,rtc_call_data:G,marketplace_thread_data:J,associated_object:ga(h),reactions_mute_mode:h.reactions_mute_mode==="REACTIONS_NOT_MUTED"?0:1,mentions_mute_mode:h.mentions_mute_mode==="MENTIONS_NOT_MUTED"?0:1,comm_status:m[0],page_comm_item_id:m[2],comm_source_id:m[1],subtitle:m[3],comm_item_owners:m[4],group_approval_queue:W==null?null:W.nodes,game_id:r,admin_model_status:h.admin_model_status_string,groups_sync_status:a("MessengerGroupsSyncStatus.bs").fromNullableString(h.groups_sync_status_string),groups_sync_fb_url:Y}}b.getThreadFBID=la;b.getOtherUserID=ma;b.getMessagePageInfo=na;b.transformParticipant=c;b.transformParticipants=oa;b.transformReadReceipts=pa;b.transformDeliveryReceipts=qa;b.transformMessages=ra;b.transformThread=sa}),null);
__d("MercuryCanonicalGroupThreadManager",["Bootloader","KeyedCallbackManager","MercuryIDs","MercuryPayloadSource","MercuryServerPayloadPreprocessor","MercurySingletonProvider","MercuryThreads","MessengerServerPayloadTransformer.bs","MercuryServerDispatcher","SubscriptionsHandler"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(j){this.$MercuryCanonicalGroupThreadManager1=j;this.$MercuryCanonicalGroupThreadManager2=new(c("KeyedCallbackManager"))();this.$MercuryCanonicalGroupThreadManager3=c("MercuryServerPayloadPreprocessor").getForFBID(this.$MercuryCanonicalGroupThreadManager1);this.$MercuryCanonicalGroupThreadManager6=c("MercuryThreads").getForFBID(this.$MercuryCanonicalGroupThreadManager1);this.$MercuryCanonicalGroupThreadManager4={};this.$MercuryCanonicalGroupThreadManager8();this.$MercuryCanonicalGroupThreadManager9();this.$MercuryCanonicalGroupThreadManager7={}}h.getForFBID=function(j){return i.getForFBID(j)};h.get=function(){return i.get()};h.prototype.getCanonicalGroupThreadIDForParticipants=function(j,k){j=this.$MercuryCanonicalGroupThreadManager10(j);var l=this.$MercuryCanonicalGroupThreadManager11(j),m=this.$MercuryCanonicalGroupThreadManager2.executeOrEnqueue(l,k);this.$MercuryCanonicalGroupThreadManager12(j);return m};h.prototype.unsubscribe=function(j){if(j)this.$MercuryCanonicalGroupThreadManager2.unsubscribe(j)};h.prototype.$MercuryCanonicalGroupThreadManager11=function(j){return j.sort().join(",")};h.prototype.$MercuryCanonicalGroupThreadManager13=function(j,k){var l=c("MercuryIDs").getThreadIDFromThreadFBID(k);this.$MercuryCanonicalGroupThreadManager2.setResource(j,l);this.$MercuryCanonicalGroupThreadManager4[l]=j};h.prototype.$MercuryCanonicalGroupThreadManager12=function(j){var k=this.$MercuryCanonicalGroupThreadManager11(j),l={canonical_group_key:k,participants:j};c("MercuryServerDispatcher").trySend("/ajax/mercury/search_canonical_groups.php",l,null,this.$MercuryCanonicalGroupThreadManager1)};h.prototype.$MercuryCanonicalGroupThreadManager8=function(){c("MercuryServerDispatcher").registerEndpoints({"/ajax/mercury/search_canonical_groups.php":{request_user_id:this.$MercuryCanonicalGroupThreadManager1,mode:c("MercuryServerDispatcher").IMMEDIATE,handler:function(j){this.handleUpdate(j)}.bind(this)}})};h.prototype.$MercuryCanonicalGroupThreadManager10=function(j){if(j.indexOf(this.$MercuryCanonicalGroupThreadManager1)===-1)j.push(this.$MercuryCanonicalGroupThreadManager1);return j};h.prototype.handleUpdate=function(j){if(j.graphql_payload){var k=c("MessengerServerPayloadTransformer.bs").transformThread(j.viewer,j.graphql_payload,j.for_page);this.$MercuryCanonicalGroupThreadManager3.handleUpdate({threads:[k],payload_source:c("MercuryPayloadSource").SERVER_SEARCH})}var l=j.canonical_group;if(l)for(var m in l)this.$MercuryCanonicalGroupThreadManager13(m,l[m])};h.prototype.getNow=function(j){var k=this.$MercuryCanonicalGroupThreadManager11(this.$MercuryCanonicalGroupThreadManager10(j));return this.$MercuryCanonicalGroupThreadManager2.getResource(k)};h.prototype.$MercuryCanonicalGroupThreadManager9=function(){c("Bootloader").loadModules(["MercuryThreadInformer"],function(j){var k=j.getForFBID(this.$MercuryCanonicalGroupThreadManager1),l=new(c("SubscriptionsHandler"))();l.addSubscriptions(k.subscribe("threads-deleted",function(m,n){for(var o in n)if(this.$MercuryCanonicalGroupThreadManager4[o]){this.$MercuryCanonicalGroupThreadManager2.setResource(this.$MercuryCanonicalGroupThreadManager4[o],undefined);delete this.$MercuryCanonicalGroupThreadManager4[o]}}.bind(this)));this.$MercuryCanonicalGroupThreadManager5=l}.bind(this),"MercuryCanonicalGroupThreadManager")};var i=new(c("MercurySingletonProvider"))(h);f.exports=h}),null);
__d("FantaGetMessageActions",["FantaDispatcher","MercuryCanonicalGroupThreadManager","MercuryIDs","MercuryTypeaheadConstants","keyMirror"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("keyMirror")({ADD_PARTICIPANTS:null,CLEAR_PARTICIPANTS:null,CLEAR_PREVIEW:null,FETCH_MORE_MESSAGES:null,ON_BOOTLOAD_TYPEAHEAD:null,ON_GET_APPROVAL_QUEUE_RESPONSE:null,ON_GET_THREAD_PREVIEW_RESPONSE:null,ON_GET_THREAD_RESPONSE:null,ON_MESSAGE_STORE_RESPONSE:null,ON_PAGE_NULL_RESPONSE:null,ON_PRIVACY_STATE_CHANGE:null,ON_SHOW_CONTEXT_BANNER_TIMER:null,REFRESH_THREAD:null,THREADS_UPDATED:null}),i={Types:h,addParticipants:function j(k,l){__p&&__p();var m,n=l.length===1&&l[0].getInfo().render_type===c("MercuryTypeaheadConstants").THREAD_TYPE,o=void 0;if(n){var p=l[0].getInfo().mercury_thread;if(p)o=c("MercuryIDs").getThreadIDFromThreadFBID(p.thread_fbid)}else if(l.length===1){var q=l[0].info&&l[0].info.uid;if(q)o=c("MercuryIDs").getThreadIDFromUserID(q)}else if(l.length===0){c("FantaDispatcher").dispatch({type:h.CLEAR_PARTICIPANTS,tabID:k});return}else(function(){var r=c("MercuryCanonicalGroupThreadManager").get(),s=l.map(function(u){return u.info.uid});c("FantaDispatcher").dispatch({type:h.CLEAR_PREVIEW,tabID:k,tokens:l});var t=r.getCanonicalGroupThreadIDForParticipants(Array.from(s),function(o){r.unsubscribe(t);if(o)c("FantaDispatcher").dispatch({type:h.ADD_PARTICIPANTS,previewTabID:o,tabID:k,tokens:l})})})();if(o)c("FantaDispatcher").dispatch({type:h.ADD_PARTICIPANTS,previewTabID:o,tabID:k,tokens:l})},onBootloadTypeahead:function j(k,l){c("FantaDispatcher").dispatch({type:h.ON_BOOTLOAD_TYPEAHEAD,tabID:k,thread:l})},fetchMoreMessages:function j(k){c("FantaDispatcher").dispatch({type:h.FETCH_MORE_MESSAGES,threadID:k})},refreshThread:function j(k){c("FantaDispatcher").dispatch({type:h.REFRESH_THREAD,threadID:k})},onGetThreadResponse:function j(k){c("FantaDispatcher").dispatch({type:h.ON_GET_THREAD_RESPONSE,thread:k})},onGetThreadPreviewResponse:function j(k,l){c("FantaDispatcher").dispatch({type:h.ON_GET_THREAD_PREVIEW_RESPONSE,tabID:k,thread:l})},onApprovalQueueResponse:function j(k,l){c("FantaDispatcher").dispatch({type:h.ON_GET_APPROVAL_QUEUE_RESPONSE,membershipParticipants:l,tabID:k})},onShowContextBannerTimer:function j(k){c("FantaDispatcher").dispatch({type:h.ON_SHOW_CONTEXT_BANNER_TIMER,threadID:k})},onMessageStoreResponse:function j(k,l){c("FantaDispatcher").dispatch({type:h.ON_MESSAGE_STORE_RESPONSE,messages:k,tabID:l})},threadsUpdated:function j(k){c("FantaDispatcher").dispatch({type:h.THREADS_UPDATED,threads:k})},onPrivacyStateChange:function j(k,l){c("FantaDispatcher").dispatch({type:h.ON_PRIVACY_STATE_CHANGE,threadID:k,privacyState:l})},onPageNullResponse:function j(k,l){c("FantaDispatcher").dispatch({type:h.ON_PAGE_NULL_RESPONSE,threadID:k,nullStateCTA:l})}};f.exports=i}),null);
__d("FantaTabSheetActions",["FantaDispatcher","LogHistory","keyMirror"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("keyMirror")({CLOSE_ADD_FRIENDS_SHEET:null,CLOSE_ADD_MORE_FRIENDS_SHEET:null,CLOSE_EMPLOYEE_PERSONAL_USER_SHEET:null,CLOSE_EMPLOYEE_WORK_USER_SHEET:null,CLOSE_NAME_CONVERSATION_TAB_SHEET:null,CLOSE_PAGE_INDICATOR_SHEET:null,CLOSE_READ_ONLY_PERMANENT_SHEET:null,CLOSE_READ_ONLY_SHEET:null,CLOSE_USER_FOCUS_AND_BYPASS_SHEET:null,CLOSE_USER_TIMEZONE_SHEET:null,ON_BOOTLOAD_EVENT_REMINDER:null,ON_WORK_DO_NOT_DISTURB_RESPONSE:null,ON_MENTORSHIP_PROGRAM_RESPONSE:null,ON_IS_PAGE_TAB:null,OPEN_ADD_MORE_FRIENDS_SHEET:null,OPEN_APPOINTMENT_SHEET:null,OPEN_BYPASS_FOCUS_SHEET:null,OPEN_EMPLOYEE_AWAY_SHEET:null,OPEN_EMPLOYEE_PERSONAL_USER_SHEET:null,OPEN_EMPLOYEE_WORK_USER_SHEET:null,OPEN_NAME_CONVERSATION_TAB_SHEET:null,OPEN_PAGE_INDICATOR_SHEET:null,OPEN_READ_ONLY_PERMANENT_SHEET:null,OPEN_READ_ONLY_SHEET:null,OPEN_USER_FOCUS_SHEET:null,OPEN_USER_TIMEZONE_SHEET:null,OPEN_WORK_DO_NOT_DISTURB_SHEET:null,OPEN_MENTORSHIP_PROGRAM_SHEET:null}),i=c("LogHistory").getInstance("fanta_sheets");function j(l){c("FantaDispatcher").dispatch(l);i.log(l.type,l.tabID)}var k={Types:h,openUserFocusSheet:function l(m){j({type:h.OPEN_USER_FOCUS_SHEET,tabID:m})},openBypassFocusSheet:function l(m){j({type:h.OPEN_BYPASS_FOCUS_SHEET,tabID:m})},closeUserFocusAndBypassSheet:function l(m){j({type:h.CLOSE_USER_FOCUS_AND_BYPASS_SHEET,tabID:m})},openUserTimezoneSheet:function l(m,n){j({type:h.OPEN_USER_TIMEZONE_SHEET,tabID:m,timezoneInfo:n})},closeUserTimezoneSheet:function l(m){j({type:h.CLOSE_USER_TIMEZONE_SHEET,tabID:m})},openAddMoreFriendsSheet:function l(m){j({type:h.OPEN_ADD_MORE_FRIENDS_SHEET,tabID:m})},closeAddMoreFriendsSheet:function l(m){j({type:h.CLOSE_ADD_MORE_FRIENDS_SHEET,tabID:m})},closeAddFriendsSheet:function l(m){j({type:h.CLOSE_ADD_FRIENDS_SHEET,tabID:m})},openNameConversationSheet:function l(m){j({type:h.OPEN_NAME_CONVERSATION_TAB_SHEET,tabID:m})},closeNameConversationSheet:function l(m){j({type:h.CLOSE_NAME_CONVERSATION_TAB_SHEET,tabID:m})},openReadOnlySheet:function l(m){j({type:h.OPEN_READ_ONLY_SHEET,tabID:m})},closeReadOnlySheet:function l(m){j({type:h.CLOSE_READ_ONLY_SHEET,tabID:m})},openReadOnlyPermanentSheet:function l(m){j({type:h.OPEN_READ_ONLY_PERMANENT_SHEET,tabID:m})},closeReadOnlyPermanentSheet:function l(m){j({type:h.CLOSE_READ_ONLY_PERMANENT_SHEET,tabID:m})},openEmployeeAwaySheet:function l(m){j({type:h.OPEN_EMPLOYEE_AWAY_SHEET,tabID:m})},openEmployeePersonalUserSheet:function l(m){j({type:h.OPEN_EMPLOYEE_PERSONAL_USER_SHEET,tabID:m})},closeEmployeePersonalUserSheet:function l(m){j({type:h.CLOSE_EMPLOYEE_PERSONAL_USER_SHEET,tabID:m})},openEmployeeWorkUserSheet:function l(m){j({type:h.OPEN_EMPLOYEE_WORK_USER_SHEET,tabID:m})},closeEmployeeWorkUserSheet:function l(m){j({type:h.CLOSE_EMPLOYEE_WORK_USER_SHEET,tabID:m})},openPageIndicatorSheet:function l(m,n){j({type:h.OPEN_PAGE_INDICATOR_SHEET,description:n,tabID:m})},closePageIndicatorSheet:function l(m){j({type:h.CLOSE_PAGE_INDICATOR_SHEET,tabID:m})},openWorkDoNotDisturbSheet:function l(m,n){j({type:h.OPEN_WORK_DO_NOT_DISTURB_SHEET,description:n,tabID:m})},openMentorshipProgramSheet:function l(m){j({type:h.OPEN_MENTORSHIP_PROGRAM_SHEET,tabID:m})},onIsPageTab:function l(m,n){j({type:h.ON_IS_PAGE_TAB,pageIndicator:n,tabID:m})},onBootloadEventReminder:function l(m){j({type:h.ON_BOOTLOAD_EVENT_REMINDER,tabID:m})},openAppointmentBannerSheet:function l(m){j({type:h.OPEN_APPOINTMENT_SHEET,tabID:m})},onWorkDoNotDisturbResponse:function l(m,n,o){j({type:h.ON_WORK_DO_NOT_DISTURB_RESPONSE,tabID:m,status:n,description:o})},onMentorshipProgramResponse:function l(m,n,o){j({type:h.ON_MENTORSHIP_PROGRAM_RESPONSE,tabID:m,groupID:o,programName:n})}};f.exports=k}),null);
__d("MercurySheetPolicy",["keyMirror"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={ChatThreadIsMutedTabSheet:{isPermanent:false,isSheetWithInput:false},ChatUserFocusSheet:{isPermanent:true,isSheetWithInput:true},ChatUserFocusBypassSheet:{isPermanent:true,isSheetWithInput:true},ChatUserTimezoneSheet:{isPermanent:true,isSheetWithInput:true},ChatUserBlockedTabSheet:{isPermanent:true,isSheetWithInput:false},ChatUploadWarningTabSheet:{isPermanent:false,isSheetWithInput:false},ChatThreadIsMessageBlockedSheet:{isPermanent:true,isSheetWithInput:false},ChatReadOnlyTabSheet:{isPermanent:false,isSheetWithInput:false},ChatReadOnlyPermanentTabSheet:{isPermanent:true,isSheetWithInput:false},ChatOfflineTabSheet:{isPermanent:true,isSheetWithInput:false},ChatNoRecipientsTabSheet:{isPermanent:true,isSheetWithInput:false},ChatNewMessagesTabSheet:{isPermanent:true,isSheetWithInput:true},ChatNameConversationTabSheet:{isPermanent:true,isSheetWithInput:true},ChatEmployeeAwaySheet:{isPermanent:true,isSheetWithInput:false},ChatEventReminderTabSheet:{isPermanent:true,isSheetWithInput:false},ChatAppointmentBanner:{isPermanent:true,isSheetWithInput:false},ChatMontageSheet:{isPermanent:false,isSheetWithInput:false},ChatJoinCallSheet:{isPermanent:true,isSheetWithInput:false},FantaAddFriendsSheet:{isPermanent:true,isSheetWithInput:true},FantaAddMoreFriendsSheet:{isPermanent:true,isSheetWithInput:true},ChatRoomAssociatedObjectSheet:{isPermanent:false,isSheetWithInput:false},ChatWorkDoNotDisturbSheet:{isPermanent:false,isSheetWithInput:false},ChatMentorshipProgramSheet:{isPermanent:false,isSheetWithInput:false}},i={canReplaceOpenSheet:function j(k,l){var m=this.getType(l),n=this.isPermanent(l),o=this.isSheetWithInput(l),p=this.getType(k),q=this.isPermanent(k),r=this.isSheetWithInput(k);if(r)return!!(m!==p&&o);if(q&&!n)return false;if(p===this.sheets.ChatThreadIsMessageBlockedSheet)return false;return true},getType:function j(k){var l=k.getType||k.type&&k.type.getType||function(){return k},m=l.call(k);return m},isPermanent:function j(k){if(typeof k==="string"&&h[k])return h[k].isPermanent;var l=k.isPermanent||k.type&&k.type.isPermanent||function(){return false},j=l.call(k);return j},isSheetWithInput:function j(k){if(typeof k==="string"&&h[k])return h[k].isSheetWithInput;var l=k.isSheetWithInput||k.type&&k.type.isSheetWithInput||function(){return false},j=l.call(k);return j},sheets:c("keyMirror")(h)};f.exports=i}),null);
__d("MessageRequestUtils",["MessagingTag"],(function a(b,c,d,e,f,g){"use strict";var h={isMessageRequest:function i(j){return(j.folder===c("MessagingTag").PENDING||j.folder===c("MessagingTag").OTHER)&&j.can_reply},isFiltered:function i(j){return j.folder===c("MessagingTag").OTHER}};f.exports=h}),null);
__d("TimeSpentRoomTypeEnum",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({GROUP:"GROUP",EVENT:"EVENT"})}),null);
__d("MessageThreadAssociatedObjectUtils",["TimeSpentRoomTypeEnum"],(function a(b,c,d,e,f,g){"use strict";var h={shouldRender:function i(j){return j&&j.room_type===c("TimeSpentRoomTypeEnum").GROUP&&!j.is_workplace_community},isLinkedToGroupChat:function i(j){return j&&j.room_type===c("TimeSpentRoomTypeEnum").GROUP&&!j.is_workplace_community}};f.exports=h}),null);
__d("MessengerGroupAdminModelStatus",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({REQUIRED:"required",OPTIONAL:"optional",NOT_SUPPORTED:"not_supported"})}),null);
__d("MessengerParticipantAddModeTypes",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ADD:"ADD",INVITE:"INVITE",ADD_INVITE:"ADD_INVITE"})}),null);
__d("MessengerAdminGroupUtils",["fbt","CurrentUser","MercuryConfig","MercuryIDs","MessageThreadAssociatedObjectUtils","MessagingSourceEnum","MessageRequestUtils","MessengerApprovalModeTypes","MessengerGroupAdminModelStatus","MessengerJoinableModeType","MessengerParticipantAddModeTypes","QE2Logger","WorkModeConfig","gkx"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i="messenger_use_new_group_participant_suggestion_ranking",j="show_nullstate_chat_tab_composer",k="show_nullstate_chat_tab_group_chat",l={isJoinableAndOpenThread:function m(n){return this.isJoinableThread(n)&&this.isApprovalOpenThread(n)},isJoinableAndApprovalRequiredThread:function m(n){return!!(this.isJoinableThread(n)&&n&&n.approval_mode===c("MessengerApprovalModeTypes").APPROVALS)},isWorkGroupSyncedChat:function m(n){return!!(c("gkx")("AT7fEWlWLwzcomQ12uRE_cG5HZJE7FbXXRCfPurxhw8vIpN6D0E7mGAi-hDkDV8fg1mjxj-jQMaCESDTVOkEzzqV")&&n&&n.is_thread_queue_enabled===true&&n.joinable_mode&&n.joinable_mode.mode===c("MessengerJoinableModeType").JOINABLE&&c("MessageThreadAssociatedObjectUtils").isLinkedToGroupChat(n.associated_object))},isWorkSyncedChatThreadCreationMessage:function m(n){return!!(n.log_message_data&&n.log_message_data.name&&n.tags&&n.tags.indexOf(c("MessagingSourceEnum").WORK_GROUP_SYNCED_CHAT_CREATION)!==-1)},shouldAddToApprovalQueue:function m(n,o){return!!(this.isJoinableAndApprovalRequiredThread(n)&&n&&!l.isAdmin(n.admin_ids,o))},isJoinableThread:function m(n){return!!(c("gkx")("AT5xrCi08i7kM3hip_Bf4sUgmdKPV1QphRx_J6kDVSso_LwnuXnsPyhq98JRQV_MqHjleZ_pelk8UHK4mDklEDU4gdH-DgPi3glxyQ2_7CHTgw")&&n&&n.is_thread_queue_enabled===true&&n.joinable_mode&&n.joinable_mode.mode===c("MessengerJoinableModeType").JOINABLE)},isGroupChat:function m(n){return!!(n&&c("MessageThreadAssociatedObjectUtils").isLinkedToGroupChat(n.associated_object))},shouldInvite:function m(n){return!!(c("gkx")("AT5xrCi08i7kM3hip_Bf4sUgmdKPV1QphRx_J6kDVSso_LwnuXnsPyhq98JRQV_MqHjleZ_pelk8UHK4mDklEDU4gdH-DgPi3glxyQ2_7CHTgw")&&n&&n.participant_add_mode===c("MessengerParticipantAddModeTypes").INVITE)},isApprovalOpenThread:function m(n){return!!(c("gkx")("AT5xrCi08i7kM3hip_Bf4sUgmdKPV1QphRx_J6kDVSso_LwnuXnsPyhq98JRQV_MqHjleZ_pelk8UHK4mDklEDU4gdH-DgPi3glxyQ2_7CHTgw")&&n&&n.approval_mode===c("MessengerApprovalModeTypes").OPEN)},isAdminRequired:function m(n){return!!(n&&n.admin_model_status===c("MessengerGroupAdminModelStatus").REQUIRED)},isOwner:function m(n,o){return n&&(this.isJoinableThread(o)||this.canSeeAdminV2Feature(o))},canSeeAdminV2Feature:function m(n){return c("gkx")("AT40OYqleZgx4_fLMr8MfXL_p194P9S4sUc6KbJKgvwElmT2Aj8TCRUAE4QBlOnOrqktka6w0qRv70XxEE3mR93T57P4MxmwmjYSU_ecGje_hg")&&this.isAdminRequired(n)},canSeeJoinableGroupOptions:function m(n){var o=c("WorkModeConfig").is_work_user;return!o&&this.isJoinableThread(n)},canSeeGroupOptionsSection:function m(n,o){var p=c("WorkModeConfig").is_work_user,q=this.isAdmin(n.admin_ids,o);return!p&&(this.isJoinableThread(n)||q&&this.canSeeAdminV2Feature(n))},canSeeBotsInGroupTypeahead:function m(){var n=c("CurrentUser").isWorkUser();return n&&c("gkx")("AT5GhC4rylRpYKpnZf2oEtsedOSc0WCJLB5V8z6-mqCNieSKORSJnqenUlgYVRpQaRNASrJq2SeIYY3m4QNhPBlK")},canMakeOthersAdmins:function m(n,o,p){return this.isOwner(n,p)&&!o},canMakeSelfAdmin:function m(n,o){return(this.isJoinableThread(o)||this.isAdminRequired(o))&&o.admin_ids.length===0&&n},canRemoveAdmin:function m(n,o,p){if(this.isAdminRequired(p)&&p.admin_ids.length===1)return false;return this.isOwner(n,p)&&o},canRemoveFromGroup:function m(n,o){if(this.isAdminRequired(o))return n;return this.isOwner(n,o)||!this.isJoinableThread(o)},showJoinableLink:function m(n){var o=!!(n&&n.joinable_mode&&n.joinable_mode.link),p=l.isJoinableThread(n);return p&&o},showJoinableApprovalToggle:function m(n,o){if(n.associated_object&&!n.associated_object.approval_mode_toggleable)return false;var p=l.isAdmin(n.admin_ids,o);return l.isOwner(p,n)},showApprovalQueue:function m(n,o){var p=l.isAdmin(n.admin_ids,o),q=l.isOwner(p,n),r=this.getPendingRequestNumber(n);if(n&&this.isAdminRequired(n))return this.isAdminRequired(n)&&q&&r>0;else{var s=l.isJoinableAndApprovalRequiredThread(n);return s&&q&&r>0}},showParticipantsModal:function m(n,o,p){return this.isJoinableThread(p)&&!n&&!o},useNewGroupMemberSuggestionRanking:function m(){c("QE2Logger").logExposureForUser(i);return c("MercuryConfig").MessengerNewGroupParticipantSuggestionQE},showDefaultListForNewPersonAddChatTab:function m(){c("QE2Logger").logExposureForUser(k);return c("MercuryConfig").ChatGroupChat},showDefaultListForNewChatTab:function m(){c("QE2Logger").logExposureForUser(j);return c("MercuryConfig").ChatComposer},canUpdateThreadCustomization:function m(n,o){var p=l.isJoinableThread(n),q=l.isAdmin(n.admin_ids,o),r=c("MessageRequestUtils").isMessageRequest(n);return n.is_subscribed&&!r&&(!p||q)},isAdmin:function m(n,o){if(!n)return false;if(c("MercuryIDs").isValid(o))return n.indexOf(c("MercuryIDs").getUserIDFromParticipantID(o))!==-1;return n.indexOf(o)!==-1},getLeaveGroupBodyText:function m(n,o){return this.isOwner(n,o)?h._("Leaving this group will remove you as an owner and allow other members to manage the group. You will no longer be able to send or receive new messages."):h._("You will stop receiving messages from this conversation and people will see that you left.")},getLeaveGroupTitleText:function m(n,o){return this.isOwner(n,o)?h._("Leave this conversation?"):h._("Leave Conversation?")},getLeaveGroupButtonText:function m(n,o){return this.isOwner(n,o)?h._("Leave conversation"):h._("Leave")},getMakeOwnerBodyText:function m(n,o,p){if(n)return o?h._("As a group admin, you will be able to manage who can join and customise this conversation."):h._("As a group admin, \"{owner's name}\" will be able to manage who can join and customise this conversation.",[h._param("owner's name",p)]);else return o?h._("As a group owner, you will be able to manage group ownership and remove members from the conversation. Only owners will be able to add other owners."):h._("As a group owner, \"{owner's name}\" will be able to manage group ownership and remove members from the conversation. They will be able to remove ownership from other owners.",[h._param("owner's name",p)])},getMakeOwnerTitleText:function m(n,o){if(n)return o?h._("Become group admin?"):h._("Add group admin?");else return o?h._("Become group owner?"):h._("Add group owner?")},getMakeOwnerButtonText:function m(n,o){if(n)return o?h._("Become Admin"):h._("Make Admin");else return o?h._("Become owner"):h._("Make owner")},getRemoveOwnerBodyText:function m(n,o,p,q){if(o&&p)return n?null:h._("You will no longer manage group ownership and remove members from this conversation. You will still be a participant in the group. Any other member will be able to own the group.");else if(o&&!p)return n?h._("You will no longer be able to manage who can join and customise this conversation."):h._("You will no longer manage group ownership and remove members from this conversation. You will still be a participant in the group.");else return n?h._("\"{owner's name}\" will no longer be able to manage who can join and customise this conversation.",[h._param("owner's name",q)]):h._("\"{owner's name}\" will no longer manage group ownership and remove members from the conversation. They will still be a participant in the group.",[h._param("owner's name",q)])},getRemoveOwnerTitleText:function m(n){return n?h._("Remove as group admin?"):h._("Remove as group owner?")},getRemoveOwnerButtonText:function m(n){return n?h._("Remove"):h._("Remove Owner")},getPendingRequestNumber:function m(n){if(n&&n.approval_queue_ids&&n.approval_queue_ids.length)return n.approval_queue_ids.length;else if(n&&this.isAdminRequired(n)&&n.group_approval_queue&&n.group_approval_queue.length)return n.group_approval_queue.length;return 0}};f.exports=l}),null);
__d("MessengerRoomPrivacyMode",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({WHITELISTED_MODE:0,PUBLIC_MODE:1})}),null);
__d("FantaComposeViewReducers",["Bootloader","FantaGetMessageActions","FantaTabSheetActions","MercuryDataSourceWrapper","MercurySheetPolicy","MercuryTypeaheadConstants","MessengerRoomPrivacyMode","MessengerAdminGroupUtils","ifRequired"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("FantaGetMessageActions").Types,i=c("FantaTabSheetActions").Types;function j(r,s){switch(s.type){case h.ON_GET_THREAD_RESPONSE:case h.ON_GET_THREAD_PREVIEW_RESPONSE:var t=s.thread,u=s.tabID||t.thread_id;r=k(r,t,u)}return r}function k(r,s,t){if(s.participants.length===0){r=m(r,t,s);r=p(r,t,c("MercurySheetPolicy").sheets.FantaAddFriendsSheet)}return r}function l(r,s){switch(s.type){case h.ON_BOOTLOAD_TYPEAHEAD:var t=s.thread,u=t.thread_id;r=m(r,u,t)}return r}function m(r,s,t){__p&&__p();var u=r.mercury.tabContents.get(s);if(!u||u.typeahead)return r;c("ifRequired")("ChatTabTypeaheadRenderer",function(v){__p&&__p();c("ifRequired")("ContextualTypeaheadView",function(w){__p&&__p();c("ifRequired")("MercuryTypeahead",function(x){__p&&__p();if(!r.mercury.tabContents.get(s))return;var y=!!(t&&t.participants&&t.participants.length===0),z=!!(t&&t.associated_object&&t.associated_object.privacy_mode===c("MessengerRoomPrivacyMode").WHITELISTED_MODE),A=y?c("MercuryDataSourceWrapper").chat_typeahead_source:z?c("MercuryDataSourceWrapper").chat_add_people_froup_source:c("MercuryDataSourceWrapper").chat_add_people_source;A.setShowThreads(y);if(y)A.setShowDefaultList(c("MessengerAdminGroupUtils").showDefaultListForNewChatTab());else if(!z)A.setShowDefaultList(c("MessengerAdminGroupUtils").showDefaultListForNewPersonAddChatTab());if(z)A.setQueryData({thread_id:t.thread_fbid});var B=new x(A,w);B.setViewOption("renderer",v);B.setExcludedParticipantsFromThreadMeta(t);u=u.merge({typeahead:B});r=r.setIn(["mercury","tabContents",s],u)},function(){return o(s,t)})},function(){return o(s,t)})},function(){return o(s,t)});return r}function n(r,s){switch(s.type){case i.OPEN_ADD_MORE_FRIENDS_SHEET:var t=s.tabID,u=r.mercury.tabContents.get(t).thread;if(u){r=m(r,t,u);return p(r,s.tabID,c("MercurySheetPolicy").sheets.FantaAddMoreFriendsSheet)}}return r}function o(r,s){c("Bootloader").loadModules(["ChatTabTypeaheadRenderer","ContextualTypeaheadView","MercuryTypeahead"],function(t,u,v){c("FantaGetMessageActions").onBootloadTypeahead(r,s)},"FantaComposeViewReducers")}function p(r,s,t){var u=r.mercury.tabContents.get(s),v=r.tabGroup.tabs.get(s);if(!v||!u)return r;var w=u,x=w.openSheet;if(x&&!c("MercurySheetPolicy").canReplaceOpenSheet(x,t))return r;u=u.merge({openSheet:t});r=r.setIn(["mercury","tabContents",s],u);return r}function q(r,s){switch(s.type){case h.ADD_PARTICIPANTS:var t=s.tokens,u=s.tabID,v=t.length===1&&t[0].getInfo().render_type===c("MercuryTypeaheadConstants").THREAD_TYPE;if(!v)return p(r,u,c("MercurySheetPolicy").sheets.FantaAddFriendsSheet)}return r}f.exports={addParticipants:q,onBootloadTypeahead:l,onGetThreadResponse:j,openAddMoreFriends:n}}),null);
__d("FantaTypeFileUploader",["immutable"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=Object.freeze({ANIMATED_IMAGE:"animated_image",AUDIO:"audio",FILE:"file",GENERIC_ATTACHMENT:"generic_attachment",IMAGE:"image",VIDEO:"video"}),k={uploadedFiles:c("immutable").Map(),uploadingFiles:c("immutable").Map()};h=babelHelpers.inherits(l,c("immutable").Record(k));i=h&&h.prototype;l.prototype.getTypeIDs=function(m){return this.uploadedFiles.reduce(function(n,o){if(o.type===m&&o.uploadedID)n=n.concat(o.uploadedID);return n},[])};function l(){h.apply(this,arguments)}l.fileTypes=j;f.exports=l}),null);
__d("FantaTypeSharePreview",["immutable"],(function a(b,c,d,e,f,g){"use strict";var h,i,j={isLoading:false,params:null,type:null,uri:null};h=babelHelpers.inherits(k,c("immutable").Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments)}f.exports=k}),null);
__d("FantaTypeComposer",["FantaTypeFileUploader","FantaTypeSharePreview","immutable"],(function a(b,c,d,e,f,g){"use strict";var h,i,j=0,k={fileUploader:new(c("FantaTypeFileUploader"))(),sharePreview:new(c("FantaTypeSharePreview"))(),text:"",version:j};h=babelHelpers.inherits(l,c("immutable").Record(k));i=h&&h.prototype;function l(){i.constructor.call(this,{version:++j})}f.exports=l}),null);
__d("FantaMessageActions",["Bootloader","FantaDispatcher","FantaTypeComposer","MercuryConfig","ifRequired","keyMirror","emptyFunction","setImmediate"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("keyMirror")({CANCEL_FILE_UPLOAD:null,COMPOSER_TEXT_UPDATE:null,LINK_PREVIEW:null,LOADED_SHARE_DATA:null,LOADING_SHARE_DATA:null,PREPARE_FILES_FOR_SEND:null,RECEIVED_NEW_MESSAGE:null,REMOVE_SHARE_PREVIEW:null,SEND_GROUP_MESSAGE:null,SEND_HOT_LIKE:null,SEND_MESSAGE:null,SEND_PHOTO:null,SEND_STICKER:null,UPDATE_GROUP_NAME:null,UPLOAD_FILE_FAILED:null,UPLOADED_FILE:null});function i(){var l=document.createElement("form");l.action=c("MercuryConfig").upload_url;l.method="post";return l}function j(l,m){var n=document.createElement("input");n.type="file";n.name="attachment[]";n.multiple=true;if(m)n.onchange=m;l.appendChild(n);return n}var k={Types:h,prepareFilesForSend:function l(m,n,o,p){this.dispatchOrBootloadUploader(function(){c("FantaDispatcher").dispatch({type:h.PREPARE_FILES_FOR_SEND,tabID:m,files:n,composer:o});p&&p()})},openUploadFilePicker:function l(m,n){var o=i(),p=j(o,function(){k.prepareFilesForSend(m,this.files,n)});p.click()},uploadedFile:function l(m,n,o){this.dispatchOrBootloadUploader(function(){c("FantaDispatcher").dispatch({type:h.UPLOADED_FILE,tabID:m,uploadID:n,payload:o})})},uploadFileFailed:function l(m,n){this.dispatchOrBootloadUploader(function(){c("FantaDispatcher").dispatch({type:h.UPLOAD_FILE_FAILED,tabID:m,uploadID:n})})},cancelFileUpload:function l(m,n){this.dispatchOrBootloadUploader(function(){c("FantaDispatcher").dispatch({type:h.CANCEL_FILE_UPLOAD,tabID:m,uploadID:n})})},linkPreview:function l(m,n){this.dispatchOrBootloadSharePreview(function(){c("FantaDispatcher").dispatch({type:h.LINK_PREVIEW,tabID:m,uri:n})})},loadedShareData:function l(m,n,o){this.dispatchOrBootloadSharePreview(function(){c("FantaDispatcher").dispatch({type:h.LOADED_SHARE_DATA,tabID:m,attachmentData:n,composer:o})})},loadingShareData:function l(m,n){this.dispatchOrBootloadSharePreview(function(){c("FantaDispatcher").dispatch({type:h.LOADING_SHARE_DATA,composer:n,tabID:m})})},removeSharePreview:function l(m,n){this.dispatchOrBootloadSharePreview(function(){c("FantaDispatcher").dispatch({type:h.REMOVE_SHARE_PREVIEW,tabID:m,composer:n})})},receivedNewMessage:function l(m,n){c("FantaDispatcher").dispatch({type:h.RECEIVED_NEW_MESSAGE,tabID:m,message:n})},updateGroupName:function l(m,n){this.dispatchOrBootloadSendMessages(function(){c("FantaDispatcher").dispatch({type:h.UPDATE_GROUP_NAME,threadID:m,newName:n})})},sendGroupMessage:function l(m,n){this.dispatchOrBootloadSendMessages(function(){c("FantaDispatcher").dispatch({type:h.SEND_GROUP_MESSAGE,threadID:m,onSendSuccess:n})})},sendMessage:function l(m,n,o,p){this.dispatchOrBootloadSendMessages(function(){c("FantaDispatcher").dispatch({type:h.SEND_MESSAGE,threadID:m,message:n,composer:o,onSendSuccess:p})})},sendPhoto:function l(m,n,o){this.dispatchOrBootloadSendMessages(function(){c("FantaDispatcher").dispatch({type:h.SEND_PHOTO,onSendSuccess:o,photoData:n,threadID:m})})},sendHotLike:function l(m,n,o,p,q){this.dispatchOrBootloadSendMessages(function(){c("FantaDispatcher").dispatch({type:h.SEND_HOT_LIKE,emoji:n,onSendSuccess:q,size:o,source:p,threadID:m})})},sendSticker:function l(m,n,o){this.dispatchOrBootloadSendMessages(function(){c("FantaDispatcher").dispatch({type:h.SEND_STICKER,threadID:m,stickerID:n,onSendSuccess:o})})},composerTextUpdate:function l(m,n,o){if(n.length>0)c("ifRequired")("FantaReducersSendMessages",c("emptyFunction"),function(){return this.dispatchOrBootloadSendMessages(c("emptyFunction"))}.bind(this));this.dispatchOrBootloadSharePreview(function(){c("FantaDispatcher").dispatch({type:h.COMPOSER_TEXT_UPDATE,composer:o,message:n,threadID:m})})},dispatchOrBootloadSendMessages:function l(m){c("ifRequired")("FantaReducersSendMessages",function(){c("setImmediate")(m)},function(){c("Bootloader").loadModules(["FantaAppStore","FantaReducersSendMessages"],function(n,o){n.addReducers(o);c("setImmediate")(m)},"FantaMessageActions")})},dispatchOrBootloadUploader:function l(m){c("ifRequired")("FantaReducersFileUploader",function(){m()},function(){c("Bootloader").loadModules(["FantaAppStore","FantaReducersFileUploader"],function(n,o){n.addReducers(o);m()},"FantaMessageActions")})},dispatchOrBootloadSharePreview:function l(m){c("ifRequired")("FantaReducersSharePreview",function(){m()},function(){c("Bootloader").loadModules(["FantaAppStore","FantaReducersSharePreview"],function(n,o){n.addReducers(o);m()},"FantaMessageActions")})}};f.exports=k}),null);
__d("FantaReducersCookie",["FantaMessageActions","FantaTabActions","PresenceState","throttle"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("FantaMessageActions").Types,i=c("FantaTabActions").Types,j=c("throttle").acrossTransitions(c("PresenceState").doSync,500);function k(n,o){switch(o.type){case h.RECEIVED_NEW_MESSAGE:case i.CLOSE_ALL_TABS:case i.CLOSE_AND_TAB_NEXT:case i.CLOSE_TAB:case i.DELETE_TAB:case i.MINIMIZE_ALL_TABS:case i.MINIMIZE_TAB:case i.OPEN_TAB:case i.OPEN_TAB_WITH_INTERSTITIAL_DATA:case i.REPLACE_TAB:case i.UNMINIMIZE_TAB:j();return m(n)}return n}function l(n,o){switch(o.type){case i.LOAD_FROM_DATA:var p=n.tabGroup,q=o.tabData,r=p.updatedTime,s=r>=q.updatedTime||q.updatedTime===undefined?r:q.updatedTime;return n.mergeIn(["tabGroup"],{updatedTime:s})}return n}function m(n){return n.mergeIn(["tabGroup"],{updatedTime:Date.now()})}f.exports={updateCookie:k,loadFromData:l}}),null);
__d("FantaReducersDockCalculator",["Arbiter","FantaTabActions","FantaMessageActions","setImmediate"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("FantaTabActions").Types,i=c("FantaMessageActions").Types,j=null;function k(n){j=n;c("setImmediate")(function(){c("Arbiter").inform("FantaReducersDockCalculator/shouldRecalculate")})}function l(n){__p&&__p();if(!j||n.size!==j.size)k(n);else{var o=false;n.forEach(function(p){var q=j&&j.get(p.id);if(!q||p.isMinimized!==q.isMinimized)o=true});if(o)k(n)}}function m(n,o){var p=n.tabGroup.tabs;switch(o.type){case h.CLOSE_ALL_TABS:case h.CLOSE_AND_TAB_NEXT:case h.CLOSE_TAB:case h.DELETE_TAB:case h.MINIMIZE_ALL_TABS:case h.MINIMIZE_TAB:case h.OPEN_TAB:case h.OPEN_TAB_WITH_INTERSTITIAL_DATA:case h.UNMINIMIZE_TAB:k(p);break;case h.LOAD_FROM_DATA:case i.RECEIVED_NEW_MESSAGE:l(p);break}return n}f.exports={recalculateDock:m}}),null);
__d("FantaReducersLogging",["Bootloader","FantaTabActions","FantaTabSheetActions"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("FantaTabActions").Types,i=c("FantaTabSheetActions").Types;function j(l,m){__p&&__p();switch(m.type){case i.OPEN_ADD_MORE_FRIENDS_SHEET:case h.OPEN_TAB:if(m.type===h.OPEN_TAB&&m.entryPoint!=="compose_link"&&m.entryPoint!=="jewel_new_message")return l;var n=l.mercury.tabContents.get(m.tabID);if(n)c("Bootloader").loadModules(["MessengerSecondarySearchFunnelLogger","MessengerSecondarySearchFunnelConstants"],function(o,p){var q="";switch(m.entryPoint){case"compose_link":q=p.TAGS.SIDEBAR;break;case"jewel_new_message":q=p.TAGS.JEWEL;break}o.startFunnel(p.TAGS.WWW,p.TAGS.OMNIPICKER,q,m.type===i.OPEN_ADD_MORE_FRIENDS_SHEET?n.id:null,n.loggingID)},"FantaReducersLogging");break}return l}function k(l,m){switch(m.type){case h.CLOSE_ALL_TABS:case h.CLOSE_AND_TAB_NEXT:case h.CLOSE_TAB:case h.DELETE_TAB:case h.OPEN_TAB:case h.OPEN_TAB_WITH_INTERSTITIAL_DATA:var n=l.tabGroup.allowedRaisedTabs,o=l.tabGroup.getRaisedandUnraisedTabs(),p=o.raisedTabs,q=o.unraisedTabs,r=p.count(),s=r+q.count();c("Bootloader").loadModules(["FantaTabsVisibleTypedLogger"],function(t){new t().setAllowedRaisedTabs(n).setOpenTabs(s).setVisibleTabs(r).log()},"FantaReducersLogging")}return l}f.exports={updateVisibleTabs:k,logSearchEventsAfterAction:j}}),null);
__d("FantaTypeJoinableThread",["immutable"],(function a(b,c,d,e,f,g){"use strict";var h,i,j={admins:[],approvalMode:0,associatedObject:null,description:null,friendsInParticipants:[],imageURL:null,isViewerSubscribed:false,isWorkpaceChat:false,joinableMode:{mode:0,link:""},linkHash:"",participants:[],threadID:null,threadFBID:null,threadName:null};h=babelHelpers.inherits(k,c("immutable").Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments)}f.exports=k}),null);
__d("FantaTypeTabContents",["ChatPrivacyActionController","FantaGetMessageActions","FantaTypeComposer","immutable","ImmutableObject","MercuryIDs","emptyFunction","setImmediate"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j={composer:new(c("FantaTypeComposer"))(),hasFetchedAll:false,id:"",isMultiCompany:null,isScrolledToBottom:true,joinableInterstitialData:null,membershipParticipants:null,mentorship:null,messages:c("immutable").List(),messageStore:null,nullStateCTA:null,openSheet:null,pageIndicator:null,pageIndicatorDescription:null,privacyController:null,showContextBanner:false,showUnseenMessages:c("emptyFunction"),signatureID:null,thread:null,threadPreviewID:null,threadPreviewRecipients:null,timezoneInfo:null,typeahead:null,workAvailabilityHumanReadable:null,workAvailabilityStatus:null,loggingID:null};h=babelHelpers.inherits(k,c("immutable").Record(j));i=h&&h.prototype;function k(l){var m=void 0,n=c("MercuryIDs").getUserIDFromThreadID(l.id);if(n)m=new(c("ChatPrivacyActionController"))(n,function(o){c("setImmediate")(function(){c("FantaGetMessageActions").onPrivacyStateChange(l.id,o)})});i.constructor.call(this,babelHelpers["extends"]({privacyController:m},l))}f.exports=k}),null);
__d("FantaReducersMercury",["Arbiter","AsyncSignal","AvailableList","AvailableListConstants","Bootloader","FantaAvailableStatus","FantaGetMessageActions","FantaMessageActions","FantaTabActions","FantaTabSheetActions","FantaTypeJoinableThread","FantaTypeTabContents","JSLogger","MercuryIDs","MercuryThreadIDMap","TimeSlice","getPageIDFromThreadID","ifRequired","setImmediate"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("MercuryThreadIDMap").get(),i=c("JSLogger").create("FantaReducersMercury"),j=c("FantaMessageActions").Types,k=c("FantaTabActions").Types,l=c("FantaGetMessageActions").Types,m=1;function n(){return Math.floor(Math.random()*2147483648).toString(16)}function o(H,I){__p&&__p();switch(I.type){case k.OPEN_TAB:case k.OPEN_TAB_WITH_INTERSTITIAL_DATA:var J=I.tabID;c("ifRequired")("FantaTabsReactApp",function(N){if(!c("MercuryIDs").isValidThreadID(J)){H=H.deleteIn(["tabGroup","tabs",J]);w(J)}else E(H,J)},function(){return H=p(H,I.tabID)});H=r(H,J);var K=n(),L=H.mercury.tabContents.get(J);L=L.merge({signatureID:K,loggingID:m++});H=H.setIn(["mercury","tabContents",J],L);new(c("AsyncSignal"))("/ajax/chat/opentab_tracking.php",{threadID:J,userID:c("MercuryIDs").getUserIDFromThreadID(J),signatureID:K}).send();if(I.interstitialData){var M=new(c("FantaTypeJoinableThread"))(I.interstitialData);L=L.merge({joinableInterstitialData:M});H=H.setIn(["mercury","tabContents",J],L)}c("Arbiter").inform("jewel/hide");return H}return H}function p(H,I){c("ifRequired")("FantaTabsSlimApp",function(J){if(!c("MercuryIDs").isValidThreadID(I)){H=H.deleteIn(["tabGroup","tabs",I]);w(I)}else E(H,I)},function(){E(H,I)});return H}function q(H,I){switch(I.type){case j.RECEIVED_NEW_MESSAGE:H=r(H,I.tabID)}return H}function r(H,I){__p&&__p();var J,K=H.mercury.tabContents.get(I);if(!K){var J=function(){__p&&__p();var L=c("getPageIDFromThreadID")(I);if(L)c("Bootloader").loadModules(["PagesMercuryChatTabIndicatorHandler"],function(M){var N=c("AvailableListConstants").OFFLINE,O=new M(L,N,function(P){c("setImmediate")(function(){c("FantaTabSheetActions").openPageIndicatorSheet(I,P)})},function(){c("setImmediate")(function(){return c("FantaTabSheetActions").closePageIndicatorSheet(I)})});c("setImmediate")(function(){c("FantaTabSheetActions").onIsPageTab(I,O)});O.checkResponsiveness()},"FantaReducersMercury");return{v:H.setIn(["mercury","tabContents",I],new(c("FantaTypeTabContents"))({id:I}))}}();if(typeof J==="object")return J.v}return H}function s(H,I){switch(I.type){case k.REPLACE_TAB:H=v(H,I.newTabID);H=r(H,I.newTabID);return H}return H}function t(H,I){switch(I.type){case l.ADD_PARTICIPANTS:var J=I.tabID,K=I.previewTabID,L=H.mercury.tabContents.get(J);if(!L)return H;L=L.merge({threadPreviewID:K});H=H.setIn(["mercury","tabContents",J],L);return H}return H}function u(H,I){switch(I.type){case l.CLEAR_PARTICIPANTS:var J=I.tabID,K=H.mercury.tabContents.get(J),L=K?K.loggingID:null;H=H.setIn(["mercury","tabContents",J],new(c("FantaTypeTabContents"))({id:J,loggingID:L}))}return H}function v(H,I){__p&&__p();c("ifRequired")("FantaTabsReactApp",function(J){if(!c("MercuryIDs").isValidThreadID(I)){H=H.deleteIn(["tabGroup","tabs",I]);w(I)}},function(){c("ifRequired")("FantaTabsSlimApp",function(J){if(!c("MercuryIDs").isValidThreadID(I)){H=H.deleteIn(["tabGroup","tabs",I]);w(I)}})});return H}function w(H){h.getClientIDFromServerID(H,function(I){return c("setImmediate")(function(){if(c("MercuryIDs").isValidThreadID(I))c("FantaTabActions").openTab(I);else i.error("invalid id",H)})})}function x(H,I){switch(I.type){case k.FOCUS_TAB:E(H,I.tabID)}return H}function y(H,I){switch(I.type){case k.CLOSE_TAB:var J=I.tabID;H=A(H,J)}return H}function z(H,I){switch(I.type){case k.DELETE_TAB:var J=I.tabID;H=A(H,J);H=H.deleteIn(["mercury","tabContents",J])}return H}function A(H,I){c("ifRequired")("MessengerVideoAutoplayActions",function(J){J.deleteThread(I)});return H}function B(H,I){switch(I.type){case k.CLOSE_ALL_TABS:c("ifRequired")("MessengerVideoAutoplayActions",function(J){J.deleteAllThreads()});return H}return H}function C(H,I){switch(I.type){case k.FOCUS_NEXT_TAB:case k.FOCUS_PREVIOUS_TAB:case k.CLOSE_AND_TAB_NEXT:var J=H.tabGroup.focusedTabID;if(J)E(H,J)}return H}function D(H,I){switch(I.type){case k.CLOSE_AND_TAB_NEXT:var J=I.tabID}return H}function E(H,I){__p&&__p();var J=c("MercuryIDs").getUserIDFromThreadID(I);if(J){var K=function K(){c("AvailableList").updateForID(J)};c("TimeSlice").guard(K,"superfluous request to first open DD",{propagationType:c("TimeSlice").PropagationType.ORPHAN})()}var L=H.mercury.tabContents.get(I);if(L){var M=L.thread,N=L.pageIndicator;if(N)N.notifyPageOnlineStatusChanged(c("FantaAvailableStatus").getStatus(M,I))}}function F(H,I){switch(I.type){case k.UNMINIMIZE_TAB:E(H,I.tabID)}return H}function G(H,I){__p&&__p();switch(I.type){case k.LOAD_FROM_DATA:for(var J=H.tabGroup.tabs.keys(),K=Array.isArray(J),L=0,J=K?J:J[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var M;if(K){if(L>=J.length)break;M=J[L++]}else{L=J.next();if(L.done)break;M=L.value}var N=M;H=r(H,N)}}return H}f.exports={addParticipants:t,clearParticipants:u,closeAllTabs:B,closeAndTabNext:D,closeTab:y,deleteTab:z,focusTab:x,focusTabEvents:C,loadFromData:G,openTab:o,receivedNewMessage:q,replaceTab:s,unminimizeTab:F}}),null);
__d("FantaReducersMessages",["CurrentUser","FantaGetMessageActions","FantaMessageActions","FantaTabActions","FantaTypeComposer","MercuryBrowserAlerts","MercuryParticipants"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("FantaMessageActions").Types,i=c("FantaTabActions").Types,j=c("FantaGetMessageActions").Types;function k(r,s){switch(s.type){case h.RECEIVED_NEW_MESSAGE:var t=s.message;c("MercuryBrowserAlerts").messageReceived(t);return r}return r}function l(r,s){switch(s.type){case h.COMPOSER_TEXT_UPDATE:var t=s.composer,u=s.message,v=s.threadID,w=r.mercury.tabContents.get(v);if(!w||w&&w.composer.version!==t.version)return r;return r.mergeIn(["mercury","tabContents",v,"composer"],{text:u})}return r}function m(r,s){switch(s.type){case i.CLOSE_TAB:case i.CLOSE_AND_TAB_NEXT:if(!r.mercury.tabContents.get(s.tabID))return r;return r.setIn(["mercury","tabContents",s.tabID,"composer"],new(c("FantaTypeComposer"))())}return r}function n(r,s){switch(s.type){case i.CLOSE_ALL_TABS:var t=r.mercury.tabContents;t.forEach(function(u){var v=u.id;r=r.setIn(["mercury","tabContents",v,"composer"],new(c("FantaTypeComposer"))())});return r}return r}function o(r,s){switch(s.type){case i.SCROLL_BOTTOM_CHANGED:var t=s.tabID,u=s.isScrolledToBottom,p=s.showUnseenMessages,v=r.mercury.tabContents.get(t);if(!v)return r;v=v.merge({isScrolledToBottom:u,showUnseenMessages:p});r=r.setIn(["mercury","tabContents",t],v)}return r}function p(r,s){switch(s.type){case i.SHOW_UNSEEN_MESSAGES:var t=s.tabID,u=r.mercury.tabContents.get(t);if(u)u.showUnseenMessages()}return r}function q(r,s){__p&&__p();switch(s.type){case j.ON_GET_THREAD_RESPONSE:var t=s.thread,u=t.thread_id,v=r.mercury.tabContents.get(u);if(!v)return r;var w=null;if(c("CurrentUser").isWorkUser()&&t.participants)w=t.participants.map(c("MercuryParticipants").getOrFetch,c("MercuryParticipants")).find(function(x){return x&&x.is_coworker===false})!==undefined;v=v.merge({thread:t,isMultiCompany:w});r=r.setIn(["mercury","tabContents",u],v);break}return r}f.exports={closeAllTabs:n,closeTab:m,composerTextUpdate:l,onGetThreadResponse:q,receivedNewMessage:k,scrollBottomChanged:o,showUnseenMessages:p}}),null);
__d("FantaReducersPreLogging",["Bootloader","FantaMessageActions","FantaTabActions","FantaTabSheetActions","MessengerSecondarySearchFunnelConstants"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("FantaTabActions").Types,i=c("FantaTabSheetActions").Types,j=c("FantaMessageActions").Types,k=c("MessengerSecondarySearchFunnelConstants").TAGS,l=k.ABANDON,m=k.SEND,n=k.ACTION;function o(q,r){__p&&__p();switch(r.type){case h.CLOSE_TAB:case h.CLOSE_AND_TAB_NEXT:case i.CLOSE_ADD_FRIENDS_SHEET:case i.CLOSE_ADD_MORE_FRIENDS_SHEET:q=p(q,r.tabID,n,l);break;case h.CLOSE_ALL_TABS:q.mercury.tabContents.forEach(function(s){q=p(q,s.id,n,l)});break;case j.SEND_GROUP_MESSAGE:q=p(q,r.threadID,n,m,true);break;case j.SEND_HOT_LIKE:case j.SEND_MESSAGE:case j.SEND_PHOTO:case j.SEND_STICKER:q=p(q,r.threadID,n,m);break}return q}function p(q,r,s,t,u){__p&&__p();var v=q.mercury.tabContents.get(r),w=v?v.loggingID:null,x=v?v.threadPreviewID:null;if(w)c("Bootloader").loadModules(["MessengerSecondarySearchFunnelLogger"],function(y){q=q.setIn(["mercury","tabContents",r],v.merge({loggingID:null}));var z=void 0;if(t===m&&(u===null||u===undefined))z=v&&v.messages.size===0;else z=u;y.endFunnel(s,t,w,x?x.split(":")[1]:null,z)},"FantaReducersPreLogging");return q}f.exports={logSearchEvents:o}}),null);
__d("FantaTypeTab",["immutable"],(function a(b,c,d,e,f,g){"use strict";var h,i,j={focusCounter:0,id:"",isHovered:false,isMinimized:false,openCounter:0,entryPoint:"unknown"};h=babelHelpers.inherits(k,c("immutable").Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments)}f.exports=k}),null);
__d("FantaTypeTabGroup",["FantaConst","immutable"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j={allowedRaisedTabs:c("FantaConst").DEFAULT_ALLOWED_RAISED_TABS,focusedTabID:null,tabs:c("immutable").Map({}),updatedTime:0},k=function k(n){return n.openCounter*-1},l=function l(n){return n.focusCounter*-1};h=babelHelpers.inherits(m,c("immutable").Record(j));i=h&&h.prototype;m.prototype.getRaisedandUnraisedTabs=function(){var n=this.tabs.sortBy(l),o=n.slice(this.allowedRaisedTabs),p=n.take(this.allowedRaisedTabs).sortBy(k);return{raisedTabs:p,unraisedTabs:o}};function m(){h.apply(this,arguments)}f.exports=m}),null);
__d("isWebMessengerURI",[],(function a(b,c,d,e,f,g){function h(i){return/^(\/messages)/.test(i.getPath())}f.exports=h}),null);
__d("FantaReducersTabs",["Bootloader","EventProfiler","FantaConst","FantaMessageActions","FantaTabActions","FantaTypeTab","FantaTypeTabGroup","LogHistory","MercuryThreads","PinnedConversationNubsConfig","TimeSlice","URI","isWebMessengerURI"],(function a(b,c,d,e,f,aa){"use strict";__p&&__p();var g=c("MercuryThreads").get(),h=c("FantaMessageActions").Types,i=c("FantaTabActions").Types,j="tab_",k=c("LogHistory").getInstance("fanta_tabs"),l=1,m=1,n=1;function o(O,P){switch(P.type){case i.OPEN_TAB:case i.OPEN_TAB_WITH_INTERSTITIAL_DATA:k.debug(P.type,JSON.stringify({id:P.tabID}));if(m===1)c("EventProfiler").tagCurrentActiveInteractionsAs("FirstChatTabOpen");return v(O,P.tabID||j+n++,true,P.entryPoint)}return O}function p(O,P){__p&&__p();switch(P.type){case i.REPLACE_TAB:var Q=P.tabID,R=P.newTabID,S=O.tabGroup,T=S.tabs,U=T.get(Q);k.debug(P.type,JSON.stringify({id:Q,isExisting:!!U,newID:R}));if(U){var V=U.id===O.tabGroup.focusedTabID;O=O.setIn(["tabGroup","tabs",R],U.merge({id:R})).deleteIn(["tabGroup","tabs",Q]);return v(O,R,V,"replace_tab")}return v(O,R,false,"replace_tab")}return O}function q(O,P){switch(P.type){case i.MINIMIZE_TAB:return w(O,P.tabID,true)}return O}function r(O,P){switch(P.type){case i.UNMINIMIZE_TAB:return w(O,P.tabID,false)}return O}function s(O,P){switch(P.type){case i.FOCUS_TAB:var Q=P.tabID;return D(O,Q)}return O}function t(O,P){switch(P.type){case i.BLUR_TAB:return E(O,P.tabID)}return O}function u(O,P){__p&&__p();var Q;switch(P.type){case h.RECEIVED_NEW_MESSAGE:var R=P.tabID,o=O.tabGroup.tabs.get(R);k.debug(P.type,JSON.stringify({id:R,isOpen:!!o}));if(!o){var Q=function(){__p&&__p();var S=O.tabGroup.focusedTabID;O=v(O,R,false,"message_received");var T=O.tabGroup.allowedRaisedTabs,U=O.tabGroup.getRaisedandUnraisedTabs(),V=U.raisedTabs,W=U.unraisedTabs,X=V.count(),Y=X+W.count();c("TimeSlice").guard(function(){c("Bootloader").loadModules(["FantaTabsVisibleTypedLogger"],function($){new $().setAllowedRaisedTabs(T).setOpenTabs(Y).setVisibleTabs(X).log()},"FantaReducersTabs")},"name",{propagationType:c("TimeSlice").PropagationType.ORPHAN})();var Z=c("URI").getNextURI();if(c("isWebMessengerURI")(Z))return{v:O=w(O,R,true)};else if(S)return{v:D(O,S)}}();if(typeof Q==="object")return Q.v}}return O}function v(O,P,Q){__p&&__p();var R=arguments.length<=3||arguments[3]===undefined?"unknown":arguments[3],S=O.tabGroup,T=S.tabs,U=T.get(P);if(!U){U=new(c("FantaTypeTab"))({id:P,focusCounter:l,openCounter:m++,entryPoint:R});O=O.setIn(["tabGroup","tabs",P],U)}else if(U.isMinimized&&Q)O=w(O,P,false);if(Q)return D(O,P);return O}function w(O,P,Q){var R=O.tabGroup,S=R.tabs.get(P);if(S)O=O.mergeIn(["tabGroup","tabs",P],{isMinimized:Q});return O}function x(O,P){__p&&__p();switch(P.type){case i.MINIMIZE_ALL_TABS:for(var Q=O.tabGroup.tabs.keys(),R=Array.isArray(Q),S=0,Q=R?Q:Q[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var T;if(R){if(S>=Q.length)break;T=Q[S++]}else{S=Q.next();if(S.done)break;T=S.value}var U=T;O=w(O,U,true)}return O}return O}function y(O,P){switch(P.type){case i.CLOSE_TAB:case i.DELETE_TAB:var Q=P.tabID;k.debug(P.type,JSON.stringify({id:Q}));return A(O,Q)}return O}function z(O,P){switch(P.type){case h.SEND_GROUP_MESSAGE:var Q=P.threadID,R=g.isEmptyLocalThread(Q);if(R)return A(O,Q)}return O}function A(O,P){O=E(O,P);return O.deleteIn(["tabGroup","tabs",P])}function B(O,P){switch(P.type){case i.CLOSE_ALL_TABS:k.debug(P.type);O=E(O,O.tabGroup.focusedTabID);return O.setIn(["tabGroup","tabs"],O.tabGroup.tabs.clear())}return O}function C(O,P){switch(P.type){case i.CLOSE_AND_TAB_NEXT:k.debug(P.type,JSON.stringify({id:P.tabID}));O=A(O,P.tabID);return M(O)}return O}function D(O,P){var Q=arguments.length<=2||arguments[2]===undefined?false:arguments[2],R=O.tabGroup,S=R.tabs.get(P);if(S)O=O.mergeIn(["tabGroup","tabs",P],{focusCounter:l++});var T=Q?null:P;O=O.mergeIn(["tabGroup"],{focusedTabID:T});return O}function E(O,P){if(O.tabGroup.focusedTabID===P)return O.mergeIn(["tabGroup"],{focusedTabID:null});return O}function F(O,P){switch(P.type){case i.HOVERED_TAB:var Q=P.tabID;return H(O,Q,true)}return O}function G(O,P){switch(P.type){case i.UNHOVERED_TAB:var Q=P.tabID;return H(O,Q,false)}return O}function H(O,P,Q){var R=O.tabGroup,S=R.tabs.get(P);if(S)O=O.mergeIn(["tabGroup","tabs",P],{isHovered:Q});return O}function I(O,P){__p&&__p();var Q;switch(P.type){case i.SET_ALLOWED_RAISED_TABS:var R=P.allowedRaisedTabs,S=O.tabGroup.allowedRaisedTabs;if(R!==S)(function(){k.debug(P.type,JSON.stringify({count:R}));if(!c("PinnedConversationNubsConfig").chatTabTypingPriority)R=Math.max(1,R);var T=O.tabGroup.tabs.count(),U=T>R?R:T,V=R>S&&T>S,W=R<S&&T>R;if(V||W)c("Bootloader").loadModules(["FantaTabsVisibleTypedLogger"],function(X){new X().setAllowedRaisedTabs(R).setOpenTabs(T).setVisibleTabs(U).log()},"FantaReducersTabs")})();return J(O,R)}return O}function J(O){var P=arguments.length<=1||arguments[1]===undefined?c("FantaConst").DEFAULT_ALLOWED_RAISED_TABS:arguments[1];if(P===O.tabGroup.allowedRaisedTabs)return O;if(!c("PinnedConversationNubsConfig").chatTabTypingPriority)P=Math.max(1,P);return O.mergeIn(["tabGroup"],{allowedRaisedTabs:P})}function K(O,P){__p&&__p();switch(P.type){case i.LOAD_FROM_DATA:var Q=O.tabGroup,R=P.tabData,S=Q.updatedTime;if(S>=R.updatedTime||R.updatedTime===undefined)return O;O=J(O.set("tabGroup",new(c("FantaTypeTabGroup"))()),Q.allowedRaisedTabs);var T=[];R.tabs.sort(function(U,V){return U.openCounter-V.openCounter}).forEach(function(U){T.push(U.id);O=v(O,U.id,false,"loaded_from_data");if(U.isMinimized)O=w(O,U.id,U.isMinimized)});R.tabs.sort(function(U,V){return U.focusCounter-V.focusCounter}).forEach(function(U){O=D(O,U.id,true)});k.debug(P.type,JSON.stringify({updatedTime:S,newerTime:R.updatedTime,opened:T}));O=R.focusedTabID?D(O,R.focusedTabID,true):E(O)}return O}function L(O,P){switch(P.type){case i.FOCUS_NEXT_TAB:return M(O)}return O}function M(O){__p&&__p();var P=O.tabGroup.focusedTabID,Q=O.tabGroup.getRaisedandUnraisedTabs(),R=Q.raisedTabs,S=R.count();if(S===0)return O;else if(R.count()===1)return D(O,R.first().id);var T=R.skipUntil(function(U){return U.id===P}).rest();if(T.count()===0)return D(O,R.first().id);else return D(O,T.first().id)}function N(O,P){__p&&__p();switch(P.type){case i.FOCUS_PREVIOUS_TAB:var Q=O.tabGroup.focusedTabID,R=O.tabGroup.getRaisedandUnraisedTabs(),S=R.raisedTabs;if(S.count()<2)return O;var T=S.reverse().skipUntil(function(U){return U.id===Q}).rest();if(T.count()===0)return D(O,S.last().id);else return D(O,T.first().id)}return O}f.exports={addParticipantsToLocalGroup:z,blurTab:t,closeAllTabs:B,closeAndTabNext:C,closeTab:y,focusNextTab:L,focusPreviousTab:N,focusTab:s,hoveredTab:F,loadFromData:K,minimizAllTabs:x,minimizeTab:q,openTab:o,receivedNewMessage:u,replaceTab:p,setAllowedRaisedTabs:I,unhoveredTab:G,unminimizeTab:r}}),null);
__d("FantaTypeMercuryState",["immutable"],(function a(b,c,d,e,f,g){"use strict";var h,i,j={tabContents:c("immutable").Map({})};h=babelHelpers.inherits(k,c("immutable").Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments)}f.exports=k}),null);
__d("FantaTypeAppState",["FantaTypeMercuryState","FantaTypeTabGroup","immutable"],(function a(b,c,d,e,f,g){"use strict";var h,i,j={tabGroup:new(c("FantaTypeTabGroup"))(),mercury:new(c("FantaTypeMercuryState"))()};h=babelHelpers.inherits(k,c("immutable").Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments)}f.exports=k}),null);
__d("FantaAppStore",["FantaComposeViewReducers","FantaDispatcher","FantaReducersCookie","FantaReducersDockCalculator","FantaReducersLogging","FantaReducersMercury","FantaReducersMessages","FantaReducersPreLogging","FantaReducersTabs","FantaTypeAppState","FluxReduceStore"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=[].concat(Object.values(c("FantaReducersPreLogging")),Object.values(c("FantaReducersTabs")),Object.values(c("FantaReducersMercury")),Object.values(c("FantaReducersMessages")),Object.values(c("FantaReducersDockCalculator")),Object.values(c("FantaReducersCookie")),Object.values(c("FantaComposeViewReducers")),Object.values(c("FantaReducersLogging")));h=babelHelpers.inherits(k,c("FluxReduceStore"));i=h&&h.prototype;function k(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=i.constructor).call.apply(m,[this].concat(p)),this.__moduleID=f.id,n}k.prototype.getInitialState=function(){return new(c("FantaTypeAppState"))()};k.prototype.ignoreReducer=function(m){var n=Object.values(m);j=j.filter(function(o){return!n.find(function(p){return p===o})})};k.prototype.addReducers=function(m){this.ignoreReducer(m);j=j.concat(Object.values(m))};k.prototype.reduce=function(m,n){return j.reduce(function(m,o){return o(m,n)},m)};var l=new k(c("FantaDispatcher"));f.exports=l}),null);
__d("FantaCookieUtil",["CurrentUser","FantaConst","MercuryIDs","MercuryThreads","MessengerDiscoveryEntryPoint","MercuryMessages","WorkModeConfig","gkx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("MercuryThreads").get(),i={convertCookieData:function j(k,l,m){__p&&__p();var n={tabs:[],focusedTabID:null,updatedTime:0,interstitialData:m},o=[],p=this._getCookieKeys();k=k||{};if(k[p.tabs])o=k[p.tabs];o.forEach(function(u){n.tabs.push({id:u.i,isMinimized:!u.r,openCounter:u.o,focusCounter:u.f})});if(l)for(var q=l.tabs.values(),r=Array.isArray(q),s=0,q=r?q:q[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var t;if(r){if(s>=q.length)break;t=q[s++]}else{s=q.next();if(s.done)break;t=s.value}var u=t;if(h.isEmptyLocalThread(u.id))n.tabs.push({id:u.id,isMinimized:u.isMinimized,openCounter:u.openCounter,focusCounter:u.focusCounter})}n.focusedTabID=k[p.focusedTabID];n.updatedTime=k[p.updatedTime];return n},createCookieData:function j(k,l){__p&&__p();var m=[],n=this._getCookieKeys();if(l[n.updatedTime]>k.updatedTime)return l;for(var o=k.tabs.values(),p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var r;if(p){if(q>=o.length)break;r=o[q++]}else{q=o.next();if(q.done)break;r=q.value}var s=r;if(!c("MercuryIDs").isLocalThread(s.id)&&!this._shouldDisableForCookie(s.id,s.entryPoint))m.push({i:s.id,r:s.isMinimized?undefined:1,o:s.openCounter,f:s.focusCounter})}l[n.tabs]=m;l[n.focusedTabID]=k.focusedTabID;l[n.updatedTime]=k.updatedTime;return l},_shouldDisableForCookie:function j(k,l){if(!l.includes(c("MessengerDiscoveryEntryPoint").FB_PAGE_USER_MESSAGE_PROMPT))return false;var m=c("MercuryMessages").getForFBID(c("CurrentUser").getID()),n=m.getThreadMessagesRangeNow(k,0,1)[0];return n===undefined&&c("gkx")("AT5yvaIVlO2OHqFIDWWRhRABINJAcxCp1ro66bHRcO0eEaLcqpagLVIr-zqdMYZpNoEnM0j8G8evTFI0zml2LudFjHJmYlaU_Y6yQ26Iu3tDvgUsS-yP2Aotk3FJ2AWnq4g")},_getCookieKeys:function j(){var k=c("WorkModeConfig").is_work_user;return{tabs:k?c("FantaConst").cookieIDs.WORK_COOKIE_ID:c("FantaConst").cookieIDs.PERSONAL_COOKIE_ID,focusedTabID:k?c("FantaConst").cookieIDs.WORK_FOCUS_COOKIE_ID:c("FantaConst").cookieIDs.PERSONAL_FOCUS_COOKIE_ID,updatedTime:k?c("FantaConst").cookieIDs.WORK_TIME_COOKIE_ID:c("FantaConst").cookieIDs.PERSONAL_TIME_COOKIE_ID}}};f.exports=i}),null);
__d("FantaMercuryThreadEventsBootloaded",["Bootloader","MercuryThreadInformer","MercuryThreads","MercuryViewer","WorkplaceChatHelper"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("MercuryThreadInformer").get(),i=c("MercuryThreads").get(),j={onMessagesReceived:function k(l){__p&&__p();if(c("WorkplaceChatHelper").suppressChatIfActiveOnDesktop())return;h.subscribe("messages-received",function(m,n){__p&&__p();var o,p=function p(q){__p&&__p();var r,s=n[q],t=function t(u){var v=s[u];if(v.author!=c("MercuryViewer").getID()){if(!v.is_unread)return"continue";i.getThreadMeta(q,function(w){c("Bootloader").loadModules(["ChatTabPolicy"],function(x){x.messageIsAllowed(w,v,function(){l(q,v)})},"FantaMercuryThreadEventsBootloaded")})}};for(var u=0;u<s.length;u++){var r=t(u);if(r==="continue")continue}};for(var q in n)p(q)})}};f.exports=j}),null);
__d("FantaTabMainPlaceholder.react",["cx","React","XUISpinner.react"],(function a(b,c,d,e,f,g,h){"use strict";var i=function i(){return c("React").createElement("div",{className:"_59v1"},c("React").createElement("div",{className:"_5qi9 _5qib"},c("React").createElement("div",{className:"_3_9e _s0f _50mz _50m_ fbNub _50-v opened _27_3"},c("React").createElement("div",{className:"fbNubFlyout fbDockChatTabFlyout uiContextualLayerParent"},c("React").createElement("div",{className:"fbNubFlyoutOuter"},c("React").createElement("div",{className:"fbNubFlyoutInner"},c("React").createElement("div",{className:"_5-kq"},c("React").createElement(c("XUISpinner.react"),null))))))))};f.exports=i}),null);
__d("FantaTabViewportManager",["Arbiter","DockTabsViewportCalculator","DockTabsViewportFantaTabUtils","FantaTabActions","immutable","ifRequired","isWebMessengerURI","setImmediate"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i){__p&&__p();var j=c("DockTabsViewportCalculator").getInstance(i);if(!j)return;j.registerFantaTabCallbacks({fantaTabModelStateGetter:function k(){var l=c("immutable").Map({});c("ifRequired")("FantaAppStore",function(m){l=m.getState().tabGroup.tabs});return l},onAvailableWidthChanged:function k(l){c("setImmediate")(function(){c("FantaTabActions").setAllowedRaisedTabs(c("DockTabsViewportFantaTabUtils").getTabCountToFitWidth(l))})}});c("Arbiter").subscribe("FantaReducersDockCalculator/shouldRecalculate",function(){j.forceRecalculateChatTabs()});j.forceRecalculateFBDockWidth();c("Arbiter").subscribe("page_transition",function(k,l){if(c("isWebMessengerURI")(l.uri))c("setImmediate")(function(){return c("FantaTabActions").minimizeAllTabs()})})}f.exports={init:h}}),null);
__d("HotLikeSound",["MercurySoundsConfig","SoundPlayer","StickerConstants"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=[c("MercurySoundsConfig").hot_like_grow_mp3_url,c("MercurySoundsConfig").hot_like_grow_ogg_url],i=[c("MercurySoundsConfig").hot_like_pop_mp3_url,c("MercurySoundsConfig").hot_like_pop_ogg_url],j=[c("MercurySoundsConfig").hot_like_outgoing_small_mp3_url,c("MercurySoundsConfig").hot_like_outgoing_small_ogg_url],k=[c("MercurySoundsConfig").hot_like_outgoing_medium_mp3_url,c("MercurySoundsConfig").hot_like_outgoing_medium_ogg_url],l=[c("MercurySoundsConfig").hot_like_outgoing_large_mp3_url,c("MercurySoundsConfig").hot_like_outgoing_large_ogg_url],m=function m(){return false},n={setCheckSoundEnabledFunc:function o(p){m=p},start:function o(){this._play(h)},stop:function o(){c("SoundPlayer").stop(h)},pop:function o(){this.stop();this._play(i)},snap:function o(p){this.stop();if(p===c("StickerConstants").HOT_LIKE_SMALL_STICKER_ID)this._play(j);if(p===c("StickerConstants").HOT_LIKE_MEDIUM_STICKER_ID)this._play(k);if(p===c("StickerConstants").HOT_LIKE_LARGE_STICKER_ID)this._play(l)},_play:function o(p){if(m())c("SoundPlayer").play(p)}};f.exports=n}),null);
__d("MercuryDeliveryState",["MercuryConfig","MercuryIDs","MercuryServerRequests","MercurySingletonProvider","MercuryThreadIDMap","MercuryThreadInformer","PresencePrivacy","UserActivity","debounceAcrossTransitions","gkx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("MercuryConfig").delivery_timeout||12e4;i.getForFBID=function(k){return j.getForFBID(k)};i.get=function(){return j.get()};function i(k){__p&&__p();this.$MercuryDeliveryState8=function(){if(this.$MercuryDeliveryState5.length===0&&Object.keys(this.$MercuryDeliveryState6).length===0)return;var l=this.$MercuryDeliveryState5.map(function(m){return m.message_id});if(l)this.$MercuryDeliveryState2.sendDeliveryReceipts(l,this.$MercuryDeliveryState6);this.$MercuryDeliveryState6={};this.$MercuryDeliveryState5=[]}.bind(this);this.$MercuryDeliveryState1=k;this.$MercuryDeliveryState2=c("MercuryServerRequests").getForFBID(this.$MercuryDeliveryState1);this.$MercuryDeliveryState3=c("MercuryThreadInformer").getForFBID(this.$MercuryDeliveryState1);this.$MercuryDeliveryState4=c("MercuryThreadIDMap").getForFBID(this.$MercuryDeliveryState1);this.$MercuryDeliveryState5=[];this.$MercuryDeliveryState6={};this.$MercuryDeliveryState3.subscribe("messages-received",this.$MercuryDeliveryState7.bind(this));c("UserActivity").subscribe(c("debounceAcrossTransitions")(this.$MercuryDeliveryState8,300,this))}i.prototype.$MercuryDeliveryState7=function(k,l){__p&&__p();for(var m in l){var n=l[m];n.forEach(function(o){if(this.$MercuryDeliveryState9(o)){this.$MercuryDeliveryState5.push(o);this.$MercuryDeliveryState4.getServerIDFromClientID(m,function(p){if(!this.$MercuryDeliveryState6[p])this.$MercuryDeliveryState6[p]=[];this.$MercuryDeliveryState6[p].push(o.message_id)}.bind(this))}}.bind(this))}if(c("UserActivity").isActive(h)||c("gkx")("AT6QldQ637XMvCyugHEhjQqDDf2-wtP50HTiWZ1Ww9U3TKMTy-LCSwNJff4SK8McDFogXyIPPHKCxhkz9mFRLCX-m6fUBuF8qkM5EElKo4EzDw"))this.$MercuryDeliveryState8()};i.prototype.$MercuryDeliveryState9=function(k){var l=k.author?c("MercuryIDs").getUserIDFromParticipantID(k.author):null;if(l===this.$MercuryDeliveryState1)return false;if(!k.is_unread)return false;return true};var j=new(c("MercurySingletonProvider"))(i);f.exports=i}),null);
__d("MercurySyncEnvironment",["Arbiter","ChannelInitialData","CurrentUser","MercurySyncDeltaHandler"],(function a(b,c,d,e,f,g){"use strict";function h(){if(!c("ChannelInitialData").channelConfig)return;c("MercurySyncDeltaHandler").get();c("Arbiter").inform("MercurySyncDeltaHandler/initSeqID",{fbid:c("CurrentUser").getAccountID(),seqID:c("ChannelInitialData").channelConfig.sequenceId})}f.exports={setUp:h}}),null);
__d("MercuryFolders",["MercuryFoldersConfig","MessagingTag"],(function a(b,c,d,e,f,g){__p&&__p();var h=[c("MessagingTag").INBOX,c("MessagingTag").PENDING,c("MessagingTag").OTHER,c("MessagingTag").ACTION_ARCHIVED],i={getSupportedFolders:function j(){return h.filter(function(k){if(k===c("MessagingTag").PENDING)return!c("MercuryFoldersConfig").hide_message_filtered;else if(k===c("MessagingTag").OTHER)return!c("MercuryFoldersConfig").hide_message_requests;return true}).concat()},getFromMeta:function j(k){var l=k.folder;if(k.is_archived)l=c("MessagingTag").ACTION_ARCHIVED;return l}};f.exports=i}),null);
__d("MercuryUnreadState",["invariant","MercuryFolders","LogHistory","KeyedCallbackManager","MercuryActionType","MercuryConfig","MercuryDispatcher","MercuryGlobalActionType","MercurySingletonProvider","MercuryThreadlistConstants","MercuryThreadIDMap","MessagingTag","MercuryServerRequests","MercuryThreadInformer","MercuryThreads","createObjectFrom"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=(c("MercuryFolders").getSupportedFolders()||[]).filter(function(p){return p!==c("MessagingTag").ACTION_ARCHIVED}),j="unread_thread_hash",k="unseen_thread_list",l=c("MercuryThreadlistConstants").MAX_UNREAD_COUNT,m=c("LogHistory").getInstance("mercury_unread_state");n.getForFBID=function(p){return o.getForFBID(p)};n.get=function(){return o.get()};function n(p){__p&&__p();this.$MercuryUnreadState1=p;this.$MercuryUnreadState2=c("MercuryServerRequests").getForFBID(this.$MercuryUnreadState1);this.$MercuryUnreadState3=c("MercuryThreadIDMap").getForFBID(this.$MercuryUnreadState1);this.$MercuryUnreadState4=c("MercuryThreadInformer").getForFBID(this.$MercuryUnreadState1);this.$MercuryUnreadState5=c("MercuryThreads").getForFBID(this.$MercuryUnreadState1);this.$MercuryUnreadState6=c("MercuryDispatcher").getForFBID(this.$MercuryUnreadState1);this.$MercuryUnreadState7={};this.$MercuryUnreadState8={};this.$MercuryUnreadState9={};this.$MercuryUnreadState10={};this.$MercuryUnreadState11={};i.forEach(function(q){this.$MercuryUnreadState9[q]=0;this.$MercuryUnreadState10[q]=false;this.$MercuryUnreadState11[q]=new(c("KeyedCallbackManager"))()}.bind(this));this.$MercuryUnreadState6.subscribe("update-unread",this.$MercuryUnreadState12.bind(this));this.$MercuryUnreadState6.subscribe("update-thread-ids",function(q,r){this.$MercuryUnreadState13(r)}.bind(this))}n.prototype.getUnreadCount=function(p){if(this.exceedsMaxCount(p)){m.error("unguarded_unread_count_fetch","{}");return 0}return this.$MercuryUnreadState14(p)};n.prototype.exceedsMaxCount=function(p){return this.$MercuryUnreadState10[p]||this.$MercuryUnreadState14(p)>l};n.prototype.markFolderAsRead=function(p){if(this.$MercuryUnreadState10[p]||this.$MercuryUnreadState14(p)>0)this.$MercuryUnreadState2.markFolderAsRead(p);if(c("MercuryConfig").MessengerInboxRequests&&p===c("MessagingTag").INBOX&&this.$MercuryUnreadState14(c("MessagingTag").PENDING)>0)this.$MercuryUnreadState2.markFolderAsRead(c("MessagingTag").PENDING)};n.prototype.getIsThreadUnread=function(p,q){var r=q||c("MessagingTag").INBOX,s=this.$MercuryUnreadState15(r);return!!(s&&s[p])};n.prototype.$MercuryUnreadState16=function(p,q){this.$MercuryUnreadState11[p].setResource(j,q);this.$MercuryUnreadState11[p].setResource(k,Object.keys(q))};n.prototype.$MercuryUnreadState17=function(p,q){var r=this.$MercuryUnreadState11[p].executeOrEnqueue(j,q),s=this.$MercuryUnreadState11[p].getUnavailableResources(r);if(s.length)this.$MercuryUnreadState2.fetchUnreadThreadIDs(p)};n.prototype.$MercuryUnreadState15=function(p){return this.$MercuryUnreadState11[p].getResource(j)};n.prototype.$MercuryUnreadState14=function(p){var q=this.$MercuryUnreadState11[p].getResource(k);if(q)return q.length;else return this.$MercuryUnreadState9[p]};n.prototype.$MercuryUnreadState12=function(p,q){__p&&__p();var r=void 0;(q.unread_thread_fbids||[]).forEach(function(s){__p&&__p();r=s.folder;if(!this.$MercuryUnreadState18(r))return;var t=s.thread_fbids||[];t=t.concat(s.other_user_fbids||[]);var u=this.$MercuryUnreadState19(t);this.$MercuryUnreadState16(r,c("createObjectFrom")(u,true));if(u.length>l)this.$MercuryUnreadState10[r]=true;this.$MercuryUnreadState4.updatedUnreadState()}.bind(this));(q.message_counts||[]).forEach(function(s){__p&&__p();if(s.unread_count===undefined)return;r=s.folder;if(s.unread_count>l){this.$MercuryUnreadState10[r]=true;this.$MercuryUnreadState16(r,{});this.$MercuryUnreadState4.updatedUnreadState()}else{this.$MercuryUnreadState9[r]=s.unread_count;if(this.$MercuryUnreadState9[r]===0)this.$MercuryUnreadState16(r,{});this.$MercuryUnreadState4.updatedUnreadState()}}.bind(this));(q.global_actions||[]).forEach(function(s){if(s.action_type===c("MercuryGlobalActionType").MARK_ALL_READ)this.$MercuryUnreadState20(s.folder,s.timestamp)}.bind(this));(q.actions||[]).forEach(function(s){__p&&__p();var t=c("MercuryActionType"),u=s.other_user_fbid?s.other_user_fbid:s.thread_fbid,v=s.thread_id?s.thread_id:u;if(s.action_type==t.DELETE_THREAD)i.forEach(function(x){this.$MercuryUnreadState21(x,v)}.bind(this));else if(s.action_type==t.CHANGE_ARCHIVED_STATUS||s.action_type==t.CHANGE_FOLDER){var w=this.$MercuryUnreadState5.getThreadMetaNow(s.thread_id);!!w||h(0);r=c("MercuryFolders").getFromMeta(w);if(this.$MercuryUnreadState18(r)&&w.unread_count>0)this.$MercuryUnreadState22(r,v);i.forEach(function(x){if(x!=r)this.$MercuryUnreadState21(x,v)}.bind(this))}else{r=this.$MercuryUnreadState23(s);if(!this.$MercuryUnreadState18(r))return;if(s.action_type==t.CHANGE_READ_STATUS)if(s.mark_as_read)this.$MercuryUnreadState21(r,v,s.timestamp);else this.$MercuryUnreadState22(r,v,s.timestamp);else if(s.action_type==t.USER_GENERATED_MESSAGE||s.action_type==t.LOG_MESSAGE)if(s.is_unread)this.$MercuryUnreadState22(r,v,s.timestamp)}}.bind(this))};n.prototype.$MercuryUnreadState22=function(p,q,r){if(this.$MercuryUnreadState10[p])return;this.$MercuryUnreadState17(p,function(s){var t=this.$MercuryUnreadState7[p]||0,u=this.$MercuryUnreadState8[q]||0,v=r||Number.POSITIVE_INFINITY;if(v>=t&&v>=u&&!s[q]){s[q]=r||0;this.$MercuryUnreadState16(p,s);this.$MercuryUnreadState4.updatedUnreadState()}}.bind(this))};n.prototype.$MercuryUnreadState21=function(p,q,r){__p&&__p();if(this.$MercuryUnreadState10[p])return;this.$MercuryUnreadState17(p,function(s){__p&&__p();if(r){var t=this.$MercuryUnreadState8[q];if(!t||t<r)this.$MercuryUnreadState8[q]=r}var u=s[q];if(r&&typeof u=="number"&&r<u)return;if(q in s){delete s[q];this.$MercuryUnreadState16(p,s);this.$MercuryUnreadState4.updatedUnreadState()}}.bind(this))};n.prototype.$MercuryUnreadState20=function(p,q){this.$MercuryUnreadState10[p]=false;this.$MercuryUnreadState16(p,{});this.$MercuryUnreadState7[p]=Math.max(this.$MercuryUnreadState7[p]||0,q||0);this.$MercuryUnreadState4.updatedUnreadState()};n.prototype.$MercuryUnreadState19=function(p){return p.map(this.$MercuryUnreadState3.convertThreadIDIfAvailable,this.$MercuryUnreadState3)};n.prototype.$MercuryUnreadState13=function(p){__p&&__p();i.forEach(function(q){__p&&__p();var r=this.$MercuryUnreadState15(q);if(!r)return;for(var s in p){var t=p[s];if(r[s]){r[t]=r[s];delete r[s]}}this.$MercuryUnreadState16(q,r)}.bind(this))};n.prototype.$MercuryUnreadState23=function(p){var q=p.thread_id?this.$MercuryUnreadState5.getThreadMetaNow(p.thread_id):null;return q?c("MercuryFolders").getFromMeta(q):p.folder?p.folder:""};n.prototype.$MercuryUnreadState18=function(p){return!!p&&i.includes(p)};var o=new(c("MercurySingletonProvider"))(n);f.exports=n}),null);
__d("MercuryUnseenState",["MessageThreadReadStateEffect","MercuryFolders","KeyedCallbackManager","LogHistory","MercuryActionType","MercuryDispatcher","MercuryGlobalActionType","MercurySingletonProvider","MercuryThreadIDMap","MercuryThreadInfo","MercuryThreadlistConstants","MessagingTag","MercuryServerRequests","MercuryThreadInformer","MercuryThreads","createObjectFrom","isEmpty"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("MessageThreadReadStateEffect").MessageThreadReadStateEffectType,i=c("MercuryThreadlistConstants").MAX_UNSEEN_COUNT,j="unseen_thread_hash",k="unseen_thread_list",l=c("LogHistory").getInstance("mercury_unseen_state");m.getForFBID=function(o){return n.getForFBID(o)};m.get=function(){return n.get()};function m(o){__p&&__p();this.$MercuryUnseenState2=o;this.$MercuryUnseenState7=c("MercuryServerRequests").getForFBID(this.$MercuryUnseenState2);this.$MercuryUnseenState8=c("MercuryThreadIDMap").getForFBID(this.$MercuryUnseenState2);this.$MercuryUnseenState10=c("MercuryThreads").getForFBID(this.$MercuryUnseenState2);this.$MercuryUnseenState9=c("MercuryThreadInformer").getForFBID(this.$MercuryUnseenState2);this.$MercuryUnseenState1=c("MercuryDispatcher").getForFBID(this.$MercuryUnseenState2);this.$MercuryUnseenState3=0;this.$MercuryUnseenState4=0;this.$MercuryUnseenState5=false;this.$MercuryUnseenState6=false;this.$MercuryUnseenState11=new(c("KeyedCallbackManager"))();this.$MercuryUnseenState1.subscribe("update-unseen",function(p,q){this.$MercuryUnseenState12(q)}.bind(this));this.$MercuryUnseenState1.subscribe("update-thread-ids",function(p,q){this.$MercuryUnseenState13(q)}.bind(this))}m.prototype.getUnseenCount=function(){if(this.exceedsMaxCount()){l.error("unguarded_unseen_count_fetch","{}");return 0}return this.$MercuryUnseenState14()};m.prototype.exceedsMaxCount=function(){return this.$MercuryUnseenState5||this.$MercuryUnseenState14()>i};m.prototype.markAsSeen=function(){var o=this.$MercuryUnseenState14();if(o===null)this.$MercuryUnseenState6=true;else if(o>0||this.$MercuryUnseenState5){this.$MercuryUnseenState7.markSeen();this.$MercuryUnseenState15(this.$MercuryUnseenState7.getLastActionTimestamp(),[])}};m.prototype.$MercuryUnseenState16=function(o,p){var q;this.$MercuryUnseenState17((q={},q[o]=0,q),p)};m.prototype.$MercuryUnseenState18=function(o){this.$MercuryUnseenState11.setResource(j,o);this.$MercuryUnseenState11.setResource(k,Object.keys(o))};m.prototype.$MercuryUnseenState19=function(o){var p=this.$MercuryUnseenState11.executeOrEnqueue(j,o),q=this.$MercuryUnseenState11.getUnavailableResources(p);if(q.length)this.$MercuryUnseenState7.fetchUnseenThreadIDs()};m.prototype.$MercuryUnseenState20=function(){return this.$MercuryUnseenState11.getResource(j)};m.prototype.$MercuryUnseenState14=function(){var o=this.$MercuryUnseenState11.getResource(k);if(o)return o.length;else return this.$MercuryUnseenState3};m.prototype.$MercuryUnseenState12=function(o){__p&&__p();var p,q=this,r=this.$MercuryUnseenState21(o);if(o.unseen_thread_fbids)o.unseen_thread_fbids.forEach(function(s){if(s.folder!=c("MessagingTag").INBOX)return;var t=(s.thread_fbids||[]).concat(s.other_user_fbids||[]),u=this.$MercuryUnseenState22(t),v=r.seen_timestamp?r.seen_timestamp:this.$MercuryUnseenState4;this.$MercuryUnseenState15(v,u);if(r.unseen_count>i)this.$MercuryUnseenState5=true}.bind(this));else if(r.seen_timestamp!==undefined){this.$MercuryUnseenState4=r.seen_timestamp;if(r.unseen_count>i){this.$MercuryUnseenState5=true;this.$MercuryUnseenState18({})}else{this.$MercuryUnseenState3=r.unseen_count;if(this.$MercuryUnseenState3===0)this.$MercuryUnseenState18({})}}else{var p=function(){__p&&__p();var s;(o.global_actions||[]).forEach(function(y){if(y.action_type===c("MercuryGlobalActionType").MARK_ALL_SEEN)this.$MercuryUnseenState15(y.timestamp,[])}.bind(q));if(q.$MercuryUnseenState5)return{v:void 0};var t=o.actions;if(!t||!t.length)return{v:void 0};var u={},v={},w=function w(x){__p&&__p();var y=t[x],z=y.action_type,A=y.other_user_fbid?y.other_user_fbid:y.thread_fbid,B=y.thread_id?y.thread_id:A;if(z===c("MercuryActionType").MARK_THREAD_SEEN){q.$MercuryUnseenState16(B,y.persistent);return"continue"}if(!q.$MercuryUnseenState23(y))return"continue";if(y.thread_read_state_effect&&y.thread_read_state_effect!==h.MARK_UNREAD)return"continue";if(z===c("MercuryActionType").USER_GENERATED_MESSAGE||z===c("MercuryActionType").LOG_MESSAGE){var C=u[B]?y.timestamp>u[B]:false,D=C||!u[B];if(y.is_unread&&D)q.$MercuryUnseenState10.getThreadMeta(B,function(E){if(!c("MercuryThreadInfo").isMuted(E)&&!(E&&E.last_read_timestamp>=y.timestamp))u[B]=y.timestamp})}else if(z===c("MercuryActionType").CHANGE_READ_STATUS&&y.mark_as_read)v[B]=y.timestamp};for(var x=0;x<t.length;x++){var s=w(x);if(s==="continue")continue}q.$MercuryUnseenState24(u);q.$MercuryUnseenState17(v)}();if(typeof p==="object")return p.v}if(this.$MercuryUnseenState6){this.$MercuryUnseenState6=false;this.markAsSeen()}};m.prototype.$MercuryUnseenState15=function(o,p){__p&&__p();var q=this.$MercuryUnseenState20();if(q===undefined||o>this.$MercuryUnseenState4||this.$MercuryUnseenState5){this.$MercuryUnseenState4=o;p=p||[];if(p.length<=i)this.$MercuryUnseenState5=false;var r={},s=this.$MercuryUnseenState20();for(var t in s)if(s[t]!==true){var u=s[t];if(this.$MercuryUnseenState25(u))r[t]=u}var v=Object.assign(c("createObjectFrom")(p,true),r);this.$MercuryUnseenState18(v);this.$MercuryUnseenState9.updatedUnseenState()}};m.prototype.$MercuryUnseenState24=function(o){__p&&__p();if(this.$MercuryUnseenState5)return;var p={},q=false;for(var r in o){var s=o[r];if(this.$MercuryUnseenState25(s)){p[r]=s;q=true}}if(!q)return;this.$MercuryUnseenState19(function(t){for(var u in p){var v=p[u];if(!t[u]&&this.$MercuryUnseenState25(v))t[u]=p[u]}this.$MercuryUnseenState18(t);this.$MercuryUnseenState9.updatedUnseenState()}.bind(this))};m.prototype.$MercuryUnseenState17=function(o,p){__p&&__p();if(!c("isEmpty")(o))this.$MercuryUnseenState19(function(q){__p&&__p();var r=false;for(var s in o){var t=o[s],u=t>=q[s];if(q[s]&&(!t||u)){delete q[s];r=true}}if(r){this.$MercuryUnseenState18(q);this.$MercuryUnseenState9.updatedUnseenState();if(p&&this.$MercuryUnseenState14()===0)this.$MercuryUnseenState7.markSeen()}}.bind(this))};m.prototype.$MercuryUnseenState25=function(o){return o>this.$MercuryUnseenState4};m.prototype.$MercuryUnseenState22=function(o){return o.map(this.$MercuryUnseenState8.convertThreadIDIfAvailable,this.$MercuryUnseenState8)};m.prototype.$MercuryUnseenState13=function(o){__p&&__p();var p=this.$MercuryUnseenState20();if(!p)return;for(var q in o){var r=o[q];if(p[q]){p[r]=p[q];delete p[q]}}this.$MercuryUnseenState18(p)};m.prototype.$MercuryUnseenState23=function(o){var p=o.thread_id?this.$MercuryUnseenState10.getThreadMetaNow(o.thread_id):null,q=p?c("MercuryFolders").getFromMeta(p):o.folder;return q===c("MessagingTag").INBOX||q===undefined};m.prototype.$MercuryUnseenState21=function(o){var p=o.message_counts||[];for(var q=0;q<p.length;q++)if(p[q].folder===c("MessagingTag").INBOX)return p[q];return{}};var n=new(c("MercurySingletonProvider"))(m);f.exports=m}),null);
__d("P2PSendMoneyDialogStore",["P2PActionConstants","EventEmitter","P2PDispatcher"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=36,k=void 0,l=void 0;h=babelHelpers.inherits(m,c("EventEmitter"));i=h&&h.prototype;function m(){i.constructor.call(this);l=new Map();k=c("P2PDispatcher").register(this.onEventDispatched.bind(this))}m.prototype.onEventDispatched=function(n){var o=n.data,p=n.type;switch(p){case c("P2PActionConstants").CHAT_SEND_VIEW_OPENED:this.handleChatSendViewOpened(o);this.emit("change");break;case c("P2PActionConstants").CHAT_SEND_VIEW_CLOSED:this.handleChatSendViewClosed(o);this.emit("change");break}};m.prototype.getStateByThreadID=function(n){return l.get(n)};m.prototype.handleChatSendViewOpened=function(n){l.set(n.threadID,{amount:n.amount,groupSendRecipientUserIDs:n.groupSendRecipientUserIDs,groupSendReceiptDetails:n.groupSendReceiptDetails,groupThreadFBID:n.groupThreadFBID,onCompletion:n.onCompletion,openRequestTab:n.openRequestTab,memoText:n.memoText&&n.memoText.substr(0,j),platformData:n.platformData,referrer:n.referrer,paymentRequestID:n.paymentRequestID,sendMoneyDialogShown:true,sendMoneyNUXDismissed:n.sendMoneyNUXDismissed,useModal:n.useModal})};m.prototype.handleChatSendViewClosed=function(n){l.set(n.threadID,{amount:"",groupSendRecipientUserIDs:[],groupSendReceiptDetails:null,groupThreadFBID:"",onCompletion:null,openRequestTab:false,memoText:null,platformData:null,referrer:null,paymentRequestID:null,sendMoneyDialogShown:false,sendMoneyNUXDismissed:false,useModal:false})};m.prototype.isAnyChatSendViewOpen=function(){__p&&__p();for(var n=l.values(),o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var q;if(o){if(p>=n.length)break;q=n[p++]}else{p=n.next();if(p.done)break;q=p.value}var r=q;if(r.sendMoneyDialogShown)return true}return false};f.exports=new m()}),null);
__d("FantaTabsAppBase",["Bootloader","ChatAppActions","ChatAppStore","ChatPerfInstrumentation","CSS","JSLogger"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();h.prototype.init=function(i,j,k){__p&&__p();if(this.isInitialized()){c("JSLogger").create("chat_app").error("repeated_init");return}this.$FantaTabsAppBase1=i;this.tabsElem=j;var l=c("ChatAppStore").addListener(function(){var m=c("ChatAppStore").getPreviousState(),n=c("ChatAppStore").getState();if(m.initialDisplayDone===false&&n.initialDisplayDone===true){c("ChatPerfInstrumentation").logDisplayDone();l.remove()}});c("ChatPerfInstrumentation").init();this.$FantaTabsAppBase2(k);this.initializeFantaData(k.interstitial_data);this.initializeFantaUI();this.$FantaTabsAppBase3();c("ChatAppActions").tti();c("ChatPerfInstrumentation").logTTI()};h.prototype.isInitialized=function(){return!!c("ChatAppStore").getState().isInitialized};h.prototype.isHidden=function(){var i=c("ChatAppStore").getState();return!!(!i.isInitialized||i.isHidden)};h.prototype.hide=function(){if(this.isHidden())return;c("CSS").hide(this.$FantaTabsAppBase1);c("ChatAppActions").hide()};h.prototype.unhide=function(){__p&&__p();var i=c("ChatAppStore").getState();if(i.isInitialized){if(i.isHidden){c("CSS").show(this.$FantaTabsAppBase1);e(["Dock"],function(j){j.resizeAllFlyouts()});c("ChatAppActions").unhide()}}else if(!i.isLoaded){e(["UIPagelet"],function(j){j.loadFromEndpoint("ChatTabsPagelet","ChatTabsPagelet");j.loadFromEndpoint("BuddylistPagelet","BuddylistPagelet")});c("ChatAppActions").load()}};h.prototype.initializeFantaData=function(i){};h.prototype.initializeFantaUI=function(){};h.prototype.$FantaTabsAppBase2=function(i){__p&&__p();e(["MercuryDeliveryState","MercuryParticipants","MercuryServerPayloadPreprocessor","MercuryThreads","MercuryUnreadState","MercuryUnseenState","MercurySyncEnvironment","P2PSendMoneyDialogStore"],function(j,k,l,m,n,o,p,q){__p&&__p();j.get();k;m.get();o.get();n.get();p.setUp();c("ChatPerfInstrumentation").logInitStores();if(i.graphql_payload)c("Bootloader").loadModules(["ChatInitialDataTransformer.bs"],function(r){var s=i.graphql_payload,t=r.transform(s);t.message_blocked_ids=s.message_blocked_ids;t.message_ignored_ids=s.message_ignored_ids;t.payload_source=s.payload_source;l.get().handleUpdate(t)},"FantaTabsAppBase");else l.get().handleUpdate(i.initial_data)})};h.prototype.$FantaTabsAppBase3=function(){e(["HotLikeSound","ChatOptions"],function(i,j){i.setCheckSoundEnabledFunc(function(){return j.getSetting("sound")});c("ChatPerfInstrumentation").logInitSound()})};function h(){}f.exports=h}),null);
__d("FantaTabsEagerBootloader",["Bootloader","emptyFunction","ifRequired"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=function j(k){c("ifRequired")("FantaAppStore",function(l){return l.addReducers(k)});h=c("emptyFunction")},i={bootload:function j(){c("ifRequired")("FantaTabsSlimApp",function(k){k.silentPumpUp()});c("Bootloader").loadModules(["FantaReducersGetMessages","FantaTabsReactApp","MessengerGraphQLThreadFetcher.bs"],function(k){h(k)},"FantaTabsEagerBootloader")}};f.exports=i}),null);
__d("FBRTCLocalMessageQueue",["CacheStorage","FBRTCConsoleLogger"],(function a(b,c,d,e,f,g){__p&&__p();var h="localstorage",i="RTC_",j="offer",k="offer_msg",l="data_",m=30*1e3,n=15*1e3,o=500,p=new Map();function q(){"use strict";this.$FBRTCLocalMessageQueue1=c("FBRTCConsoleLogger").getInstance()}q.prototype.enqueueOffer=function(r,s){"use strict";var t=this.$FBRTCLocalMessageQueue2(r,k);this.$FBRTCLocalMessageQueue3(t,j,s)};q.prototype.getOffer=function(r){"use strict";var s=this.$FBRTCLocalMessageQueue2(r,k);return this.$FBRTCLocalMessageQueue4(s,j)};q.prototype.removeOffer=function(r){"use strict";var s=this.$FBRTCLocalMessageQueue2(r,k);s.remove(j)};q.prototype.enqueueMessage=function(r,s,t,u){"use strict";var v=l+t.toString(),w=p.get(r)||new Map();w.set(v,u);p.set(r,w);this.$FBRTCLocalMessageQueue1.log("Queued "+v)};q.prototype.drainQueue=function(r,s){"use strict";__p&&__p();var t=p.get(r)||new Map(),u=void 0,v=void 0;for(var w=t,x=Array.isArray(w),y=0,w=x?w:w[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var z;if(x){if(y>=w.length)break;z=w[y++]}else{y=w.next();if(y.done)break;z=y.value}var A=z,u=A[0],v=A[1];void u;s(v)}p.set(r,new Map())};q.prototype.enableDequeuing=function(r,s,t,u){"use strict";if(u===undefined)u=n;this.$FBRTCLocalMessageQueue5(r,s,t,u)};q.prototype.$FBRTCLocalMessageQueue5=function(r,s,t,u){"use strict";__p&&__p();var v=this.$FBRTCLocalMessageQueue2(r,s),w=v.keys(),x=w.length;for(var y=0;y<x;y++){var z=this.$FBRTCLocalMessageQueue6(v,w[y]);if(z&&t)t(z)}this.$FBRTCLocalMessageQueue1.log("Dequeued "+x+" ("+r+") with "+u+" left)");if(u>0){u-=o;setTimeout(function(){this.$FBRTCLocalMessageQueue5(r,s,t,u)}.bind(this),o)}};q.prototype.$FBRTCLocalMessageQueue3=function(r,s,t){"use strict";var u={__t:Date.now(),__d:t};r.set(s,u)};q.prototype.$FBRTCLocalMessageQueue4=function(r,s){"use strict";var t=r.get(s);if(t&&this.$FBRTCLocalMessageQueue7(t))return t.__d;else if(t)r.remove(s);return null};q.prototype.$FBRTCLocalMessageQueue6=function(r,s){"use strict";var t=this.$FBRTCLocalMessageQueue4(r,s);if(t!==null){r.remove(s);return t}return null};q.prototype.$FBRTCLocalMessageQueue7=function(r){"use strict";return Date.now()-r.__t<m};q.prototype.$FBRTCLocalMessageQueue2=function(r,s){"use strict";return new(c("CacheStorage"))(h,""+i+r+"_"+s+"_")};f.exports=q}),null);
__d("FBRTCMessageListener",["invariant","Arbiter","BonfireFeatureGating","ChannelConstants","FBRTCCallControlActions","FBRTCConstants","FBRTCLocalMessageQueue","FBRTCSupport","RTCConfig","guid","mixInEventEmitter"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("FBRTCConstants").ChildWindowMessageType,j=45*1e3,k=[],l=null,m=null,n=null,o=null,p=null,q=false,r=null,s=null,t=void 0,u={init:function v(w,x){__p&&__p();if(q)return;q=true;c("Arbiter").subscribe(c("ChannelConstants").getArbiterType("webrtc"),function(z,A){this._onMessage(A.obj)}.bind(this));c("Arbiter").subscribe(c("ChannelConstants").getArbiterType("webrtc_offer"),function(z,A){this._onMessage(A.obj)}.bind(this));c("Arbiter").subscribe(c("ChannelConstants").getArbiterType("webrtc_offerack"),function(z,A){this._onMessage(A.obj)}.bind(this));c("Arbiter").subscribe(c("ChannelConstants").getArbiterType("rtc_multi_json"),function(z,A){this._onMultiwayMessage(A.obj)}.bind(this));if(c("BonfireFeatureGating").canReceiveBonfireRingInterop())c("Arbiter").subscribe(c("ChannelConstants").getArbiterType("parties_notifications"),function(z,A){this._onBonfireMessage(A.obj)}.bind(this));this._localMessageQueue=new(c("FBRTCLocalMessageQueue"))();if(c("RTCConfig").PassMessagesBetweenWindowsGK){if(c("FBRTCSupport").isWebrtcSupported()&&window.addEventListener){var y=w?this._handleWindowMessageToChild.bind(this):this._handleWindowMessageToParent.bind(this);window.addEventListener("message",y,false)}if(w)this._connectToParentWindow(x)}},setParentWindowNonce:function v(w){o=w},generateNewNonce:function v(){p=c("guid")();return p},setMultiwayMessageHandler:function v(w,x){!r||h(0);r=x?w.bind(x):w},_onMultiwayMessage:function v(w){this.emit("multiwayMessageReceived",w);if(r)r(w)},setBonfireMessageHandler:function v(w,x){!s||h(0);s=x?w.bind(x):w},_onBonfireMessage:function v(w){this.emit("bonfireMessageReceived",w);if(s)s(w)},setMessageHandler:function v(w,x){!l||h(0);l=x?w.bind(x):w;while(k.length)l(k.shift())},removeMessageHandler:function v(){l=null},setParentWindowStartCallHandler:function v(w){t=w;return function(){return t=null}},_onMessage:function v(w){if(w.from)w.from=w.from.toString();this.emit("messageReceived",w);if(l)l(w);else k.push(w);this._passMessageToChildWindow(w)},_connectToParentWindow:function v(w){if(window.opener&&window.opener.postMessage){var x={type:i.CHILD_WINDOW_READY,nonce:o,childNonce:this.generateNewNonce(),peerID:w};window.opener.postMessage(x,window.location.origin)}},_verifyWindowMessage:function v(event){return event.origin===window.location.origin&&event.data&&p&&event.data.nonce===p},_handleWindowMessageToParent:function v(event){if(!this._verifyWindowMessage(event))return;if(event.data.type===i.CHILD_WINDOW_READY){this.setParentWindowNonce(event.data.childNonce);this._setChildWindow(event.source);this._replayQueuedMessagesToChild(event.data.peerID,m)}},_handleWindowMessageToChild:function v(event){if(!this._verifyWindowMessage(event))return;if(event.data.type===i.CHILD_WINDOW_MESSAGE)this._onMessage(event.data.message);if(event.data.type===i.CHILD_WINDOW_START_CALL)if(t)t();else c("FBRTCCallControlActions").parentWindowStartCall()},_replayQueuedMessagesToChild:function v(w,x){this._localMessageQueue.drainQueue(w,function(y){var z={type:i.CHILD_WINDOW_MESSAGE,nonce:o,message:y};x.postMessage(z,window.location.origin)})},_setChildWindow:function v(w){m=w;clearTimeout(n);n=setTimeout(function(){m=null},j);this._startCallInChildWindow();this.generateNewNonce()},_passMessageToChildWindow:function v(w){if(m){var x={type:i.CHILD_WINDOW_MESSAGE,nonce:o,message:w};m.postMessage(x,window.location.origin)}},_startCallInChildWindow:function v(){if(m){var w={type:i.CHILD_WINDOW_START_CALL,nonce:o};m.postMessage(w,window.location.origin)}}};c("mixInEventEmitter")(u,{messageReceived:true,multiwayMessageReceived:true,bonfireMessageReceived:true});f.exports=u}),null);
__d("FBRTCMessageHandler",["Bootloader","FBRTCMessageListener","FBRTCSupport"],(function a(b,c,d,e,f,g){__p&&__p();var h=null,i=false,j=null,k=null,l={init:function p(){__p&&__p();if(!i&&c("FBRTCSupport").isReceiveWebrtcSupported()){i=true;c("FBRTCMessageListener").init(false);c("FBRTCMessageListener").once("messageReceived",function(q){m()});c("FBRTCMessageListener").once("multiwayMessageReceived",function(q){n(q)});c("FBRTCMessageListener").once("bonfireMessageReceived",function(q){o(q)})}}};function m(){if(!h)c("Bootloader").loadModules(["FBRTCIncomingCallController","FBRTCIncomingCallDialog","FBRTCMissedVideoCallHandler","FBRTCUnsupportedBrowserMessage"],function(p,q,r,s){h=new p(q,s,new r());c("FBRTCMessageListener").setMessageHandler(h.onMessageReceived,h)},"FBRTCMessageHandler")}function n(p){if(!j)c("Bootloader").loadModules(["FBRTCGroupCallIncomingController","FBRTCGroupCallIncomingDialog"],function(q,r){j=new q(r,true);c("FBRTCMessageListener").setMultiwayMessageHandler(j.onMessageReceived,j);j.onMessageReceived(p)},"FBRTCMessageHandler")}function o(p){if(!k)c("Bootloader").loadModules(["FBRTCGroupCallIncomingController","FBRTCGroupCallIncomingDialog"],function(q,r){k=new q(r);c("FBRTCMessageListener").setBonfireMessageHandler(k.onBonfireMessageReceived,k);k.onBonfireMessageReceived(p)},"FBRTCMessageHandler")}f.exports=l}),null);
__d("FantaTabsSlimApp",["BootloadOnRender.react","ChatPerfInstrumentation","FantaTabMainPlaceholder.react","FantaTabsAppBase","JSResource","LazyComponent.react","React","ReactDOM","WorkplaceChatHelper","emptyFunction","ifRequired","setImmediate"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=void 0;h=babelHelpers.inherits(k,c("FantaTabsAppBase"));i=h&&h.prototype;function k(){__p&&__p();var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=i.constructor).call.apply(l,[this].concat(o)),this.$FantaTabsSlimApp1=false,this.$FantaTabsSlimApp3=function(q,r){if(this.$FantaTabsSlimApp1)c("ifRequired")("FantaMessageActions",function(s){c("setImmediate")(function(){s.receivedNewMessage(q,r)})});else this.$FantaTabsSlimApp2(function(){c("ifRequired")("FantaMessageActions",function(s){c("setImmediate")(function(){s.receivedNewMessage(q,r)})})})}.bind(this),m}k.prototype.getPumpedUp=function(l){if(this.$FantaTabsSlimApp1)l();else this.$FantaTabsSlimApp2(l)};k.prototype.silentPumpUp=function(){if(!this.$FantaTabsSlimApp1)this.$FantaTabsSlimApp2(c("emptyFunction"),true)};k.prototype.getViewComponent=function(l){var m=l?c("React").createElement("div",null):c("React").createElement(c("FantaTabMainPlaceholder.react"),null);return c("React").createElement(c("BootloadOnRender.react"),{component:c("React").createElement(c("LazyComponent.react"),{loadDataOnMount:false}),loader:c("JSResource")("FantaMercuryTabsWithMain.react").__setRef("FantaTabsSlimApp"),placeholder:m})};k.prototype.initializeFantaData=function(l){__p&&__p();e(["FantaCookieUtil","MercuryThreadInformer","PresenceState"],function(m,n,o){__p&&__p();if(!c("WorkplaceChatHelper").suppressChatIfActiveOnDesktop()){o.registerStateLoader(function(p){__p&&__p();var q,r=this;if(this.$FantaTabsSlimApp1)c("ifRequired")("FantaTabActions",function(s){c("ifRequired")("FantaAppStore",function(t){s.loadFromData(m.convertCookieData(p,t.getState().tabGroup,l))})});else(function(){var s=m.convertCookieData(p,null,l);if(s&&s.tabs.length>0)r.$FantaTabsSlimApp2(function(){c("ifRequired")("FantaTabActions",function(t){t.loadFromData(s)})})})()}.bind(this));o.doSync()}n.get().subscribe("threads-updated",function(p,q){c("ifRequired")("FantaGetMessageActions",function(r){Object.keys(q).forEach(function(s){c("setImmediate")(function(){r.refreshThread(s)})})})});c("ChatPerfInstrumentation").logInitData()}.bind(this))};k.prototype.$FantaTabsSlimApp2=function(l,m){__p&&__p();c("ifRequired")("FantaAppStore",function(n){l()},function(){__p&&__p();e(["FantaAppStore","FantaCookieUtil","FantaMessageActions","FantaTabActions","FantaTabViewportManager","PresenceState"],function(n,o,p,q,r,s){__p&&__p();s.registerStateStorer(function(t){var u=n.getState().tabGroup;if(!j||j&&!j.equals(u)){j=u;return o.createCookieData(u,t)}else return t});c("ReactDOM").render(this.getViewComponent(m),this.tabsElem);r.init(this.tabsElem);this.$FantaTabsSlimApp1=true;l()}.bind(this))}.bind(this))};k.prototype.initializeFantaUI=function(){e(["FantaMercuryThreadEventsBootloaded","FantaMessageActions","FantaTabActions","FantaTabViewportManager","FBRTCMessageHandler","MercuryBrowserAlerts"],function(l,m,n,o,p,q){p.init();q.init();l.onMessagesReceived(this.$FantaTabsSlimApp3);c("ChatPerfInstrumentation").logInitUI();c("ChatPerfInstrumentation").logDisplayDone()}.bind(this))};f.exports=new k()}),null);
__d("MNCommerceDialogStateStore",["FluxStore","MessengerDispatcher","MNCommerceActionTypes"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("FluxStore"));i=h&&h.prototype;function j(){i.constructor.call(this,c("MessengerDispatcher"));this.__moduleID=f.id;this.$MNCommerceDialogStateStore1=null;this.$MNCommerceDialogStateStore2=null}j.prototype.__onDispatch=function(k){__p&&__p();var l=k.type;switch(l){case c("MNCommerceActionTypes").DIALOG.SHOW:this.$MNCommerceDialogStateStore1=k.dialogContainer;this.$MNCommerceDialogStateStore2=k.state;this.__emitChange();break;case c("MNCommerceActionTypes").DIALOG.HIDE:this.$MNCommerceDialogStateStore1=null;this.$MNCommerceDialogStateStore2=null;this.__emitChange();break}};j.prototype.getDialogContainer=function(){return this.$MNCommerceDialogStateStore1};j.prototype.getState=function(){return this.$MNCommerceDialogStateStore2};f.exports=new j()}),null);
__d("MNCommerceDialogContainerMount",["MNCommerceDialogContainer.react","React","ReactDOM"],(function a(b,c,d,e,f,g){"use strict";var h={mount:function i(j){c("ReactDOM").render(c("React").createElement(c("MNCommerceDialogContainer.react"),null),j)}};f.exports=h}),null);
__d("MercuryAudienceRestrictedTypeaheadDataSource",["CurrentUser","DataSource","MercuryParticipantTypes","MercuryTypeaheadConstants","OrderedFriendsList","ShortProfiles"],(function a(b,c,d,e,f,g){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("DataSource"));i=h&&h.prototype;function j(k){"use strict";__p&&__p();k=k||{};k.kanaNormalization=true;k.maxResults=c("MercuryTypeaheadConstants").COMPOSER_CHATTAB_MAX;k.minQueryLength=2;i.constructor.call(this,k);this.$MercuryAudienceRestrictedTypeaheadDataSource1=false;this.$MercuryAudienceRestrictedTypeaheadDataSource2=false;this.$MercuryAudienceRestrictedTypeaheadDataSource3={};this.$MercuryAudienceRestrictedTypeaheadDataSource4=true;this.queryCache={};this.localCache={};this.queryIDs={}}j.prototype.dirty=function(){"use strict";return this};j.prototype.buildData=function(k){"use strict";return i.buildData.call(this,k)};j.prototype.query=function(k,l,m,n){"use strict";var o=l||k.length===1;return i.query.call(this,k,o,m,n)};j.prototype.getQueryData=function(k,l){"use strict";return babelHelpers["extends"]({},i.getQueryData.call(this,k,l))};j.prototype.setEntry=function(k,l){"use strict";this.$MercuryAudienceRestrictedTypeaheadDataSource3[k]=l};j.prototype.getEntry=function(k){"use strict";return this.$MercuryAudienceRestrictedTypeaheadDataSource3[k]||null};j.prototype.getCachedShortProfileIDs=function(){"use strict";var k=c("ShortProfiles").getCachedProfileIDs(),l=k.filter(function(m){var n=c("ShortProfiles").getNow(m);return m==c("CurrentUser").getID()||n&&(n.type===c("MercuryParticipantTypes").FRIEND||n.type===c("MercuryParticipantTypes").FB4C)});return l};j.prototype.isBootstrapped=function(){"use strict";return this.$MercuryAudienceRestrictedTypeaheadDataSource1};j.prototype.isBootstrapping=function(){"use strict";return this.$MercuryAudienceRestrictedTypeaheadDataSource2};j.prototype.processEntries=function(k,l){"use strict";k=k&&k.map(function(m){if(m.index==null&&(m.render_type===c("MercuryParticipantTypes").FRIEND||m.render_type===c("MercuryParticipantTypes").FB4C))m.index=c("OrderedFriendsList").getActiveRank(m.uid);return m});return i.processEntries.call(this,k)};j.prototype.mergeUids=function(k,l,m,n){"use strict";var o=l.sort(function(p,q){var r=this.getEntry(p),s=this.getEntry(q);return r&&r.index&&s&&s.index?r.index-s.index:0}.bind(this));return i.mergeUids.call(this,k,o,m,n)};j.prototype.setQueryData=function(k,l){"use strict";return i.setQueryData.call(this,k)};j.prototype.respond=function(k,l,m){"use strict";return i.respond.call(this,k,l,m)};j.prototype.setShowThreads=function(k){"use strict";this.$MercuryAudienceRestrictedTypeaheadDataSource4=k};f.exports=j}),null);
__d("MercuryTriodeSourceUtil",["MessengerEnvironment","MercurySourceType"],(function a(b,c,d,e,f,g){"use strict";var h={getMercuryTriodeSource:function i(){return c("MessengerEnvironment").messengerdotcom?c("MercurySourceType").MESSENGER_WEB:c("MercurySourceType").TITAN_WEB}};f.exports=h}),null);
__d("P2PDialogContainerMount",["P2PDialogContainer.react","React","ReactDOM"],(function a(b,c,d,e,f,g){"use strict";var h={mount:function i(j){c("ReactDOM").render(c("React").createElement(c("P2PDialogContainer.react"),null),j)}};f.exports=h}),null);
__d("PagesPlatformDialogContainerMount",["PagesPlatformDialogContainer.react","React","ReactDOM"],(function a(b,c,d,e,f,g){"use strict";var h={mount:function i(j){c("ReactDOM").render(c("React").createElement(c("PagesPlatformDialogContainer.react"),null),j)}};f.exports=h}),null);
__d("LiveMessageReceiver",["Arbiter","ChannelConstants","emptyFunction","shield"],(function a(b,c,d,e,f,g){__p&&__p();function h(i){this.eventName=i;this.subs=null;this.handler=c("emptyFunction");this.shutdownHandler=null;this.registered=false;this.appId=1}Object.assign(h,{getAppMessageType:function i(j,k){return"live_message/"+j+":"+k},route:function i(j){var k=function k(l){var m=h.getAppMessageType(j.app_id,j.event_name);c("Arbiter").inform(m,l,c("Arbiter").BEHAVIOR_PERSISTENT)};k(j.response)}});Object.assign(h.prototype,{setAppId:function i(j){this.appId=j;return this},setHandler:function i(j){this.handler=j;this._dirty();return this},setRestartHandler:c("emptyFunction"),setShutdownHandler:function i(j){this.shutdownHandler=c("shield")(j);this._dirty();return this},_dirty:function i(){if(this.registered){this.unregister();this.register()}},register:function i(){var j=function(k,l){return this.handler(l)}.bind(this),k=h.getAppMessageType(this.appId,this.eventName);this.subs={};this.subs.main=c("Arbiter").subscribe(k,j);if(this.shutdownHandler)this.subs.shut=c("Arbiter").subscribe(c("ChannelConstants").ON_SHUTDOWN,this.shutdownHandler);this.registered=true;return this},unregister:function i(){if(!this.subs)return this;for(var j in this.subs)if(this.subs[j])this.subs[j].unsubscribe();this.subs=null;this.registered=false;return this}});f.exports=h}),null);
__d("initLiveMessageReceiver",["Arbiter","ChannelConstants","LiveMessageReceiver"],(function a(b,c,d,e,f,g){c("Arbiter").subscribe(c("ChannelConstants").getArbiterType("app_msg"),function(h,i){c("LiveMessageReceiver").route(i.obj)})}),null);